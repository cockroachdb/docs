## v23.1.4

Release Date: June 20, 2023

{% include releases/release-downloads-docker-image.md release=include.release %}

<h3 id="v23-1-4-security-updates">Security updates</h3>

- Introduced the [`sql.auth.createrole_allows_grant_role_membership.enabled`](../v23.1/cluster-settings.html#setting-sql-auth-createrole-allows-grant-role-membership-enabled) cluster setting, which defaults to false. If it is set to true, then users who have the `CREATEROLE` role option can grant and revoke role membership in any non-admin role. A future major version of CockroachDB will remove this cluster setting and make this the default behavior. [#104445][#104445]

<h3 id="v23-1-4-{{-site.data.products.enterprise-}}-edition-changes">{{ site.data.products.enterprise }} edition changes</h3>

- Fixed an initialization race condition in changefeed schema that could result in null pointer exceptions. [#104934][#104934]

<h3 id="v23-1-4-sql-language-changes">SQL language changes</h3>

- Users with `MODIFYSQLCLUSTERSETTING` will no longer be able to view non-`sql.defaults` [cluster settings](../v23.1/cluster-settings.html). [#104542][#104542]

<h3 id="v23-1-4-operational-changes">Operational changes</h3>

- The [`debug.zip`](../v23.1/cockroach-debug-zip.html) archive now contains the files formerly located at `nodes/*/ranges/*.json` in one file per node, `nodes/*/ranges.json`. [#104248][#104248]
- The `http-defaults` and `http-servers` sections of the [log config](../v23.1/configure-logs.html) will now accept a `headers` field containing a map of key value string pairs which will comprise custom HTTP headers appended to every request. Additionally, a `compression` value can now be set to `gzip` or `none` to select a compression method for the HTTP request body. By default, `gzip` is selected. Previous functionality did not compress by default. [#104814][#104814]

<h3 id="v23-1-4-command-line-changes">Command-line changes</h3>

- There is a new log config option for the [`buffering` field](../v23.1/configure-logs.html#log-buffering-for-network-sinks) to [allow buffer output to be formatted as JSON arrays](../v23.1/configure-logs.html#file-logging-format). This is useful for APIs that require JSON array format, such as the Datadog logs API. [#104790][#104790]

<h3 id="v23-1-4-db-console-changes">DB Console changes</h3>

- The tenant dropdown is now hidden for users logged in to fewer than 2 tenants. If the singular tenant is not the system tenant, the dropdown remains visible. [#104819][#104819]
- Added warning to DB Console overview page when all nodes are running on the new version, but the cluster upgrade is not finalized. [#104874][#104874]

<h3 id="v23-1-4-bug-fixes">Bug fixes</h3>

- Fixed a bug where a transaction retry during the backfill of the [**Jobs** table](../v23.1/ui-jobs-page.html#jobs-table) could result in job rows being missed. [#104757][#104757]
- Fixed an issue requiring admin or root user privileges to use `SHOW SYSTEM GRANTS`. [#104732][#104732]
- The column selector on the [**Jobs** page](../v23.1/ui-jobs-page.html) is no longer getting cut. [#104738][#104738]
- Fixed a bug where invalid splits could crash (and prevent restarts) of nodes that hold a replica for the right-hand side. [#104850][#104850]
- Fixed the `debug recover make-plan` command to ignore partial range metadata when it can't be fully read from broken cluster and instead rely solely on replica info from storage to produce the recovery plan. [#104774][#104774]
- Updated the histogram window merge calculation to more accurately interpolate quantile values. This change will result in smoother, more accurate **Metrics** charts in the DB Console. [#104815][#104815]
- Avoids double-counting disk read/write bytes in disk metrics if Cockroach observes volumes that are likely to be duplicated in reported disk counters, such as RAID logical vs physical volumes. [#104806][#104806]
- Fixed a bug in upstream etcd-io/raft which could result in pulling unlimited amount of log into memory, and lead to out-of-memory situations. With the fix, the log scan has a limited memory footprint. [#104968][#104968]

<div class="release-note-contributors" markdown="1">

<h3 id="v23-1-4-contributors">Contributors</h3>

This release includes 53 merged PRs by 30 authors.

</div>

[#104248]: https://github.com/cockroachdb/cockroach/pull/104248
[#104445]: https://github.com/cockroachdb/cockroach/pull/104445
[#104542]: https://github.com/cockroachdb/cockroach/pull/104542
[#104732]: https://github.com/cockroachdb/cockroach/pull/104732
[#104738]: https://github.com/cockroachdb/cockroach/pull/104738
[#104757]: https://github.com/cockroachdb/cockroach/pull/104757
[#104774]: https://github.com/cockroachdb/cockroach/pull/104774
[#104790]: https://github.com/cockroachdb/cockroach/pull/104790
[#104806]: https://github.com/cockroachdb/cockroach/pull/104806
[#104814]: https://github.com/cockroachdb/cockroach/pull/104814
[#104815]: https://github.com/cockroachdb/cockroach/pull/104815
[#104819]: https://github.com/cockroachdb/cockroach/pull/104819
[#104850]: https://github.com/cockroachdb/cockroach/pull/104850
[#104874]: https://github.com/cockroachdb/cockroach/pull/104874
[#104934]: https://github.com/cockroachdb/cockroach/pull/104934
[#104968]: https://github.com/cockroachdb/cockroach/pull/104968
