## v24.1.0-alpha.3

Release Date: March 18, 2024

{% include releases/release-downloads-docker-image.md release=include.release %}

<h3 id="v24-1-0-alpha-3-{{-site.data.products.enterprise-}}-edition-changes">{{ site.data.products.enterprise }} edition changes</h3>

- `cockroach gen encryption-key` now accepts a `--version=2` parameter. Version 2 keys activate a new encryption implementation with improved performance. This is expected to become the default in CockroachDB 24.2. [#119913][#119913]

<h3 id="v24-1-0-alpha-3-sql-language-changes">SQL language changes</h3>

- Mutation statements such as UPDATE and DELETE as well as locking statements such as SELECT FOR UPDATE are not allowed in read-only transactions or AS OF SYSTEM TIME transactions. Fix an oversight where we were allowing mutation statements and locking statements in implicit single-statement transactions using AS OF SYSTEM TIME. [#120097][#120097]
- Added support for `RETURN` statements with no expression for routines with OUT-parameters and routines with a `VOID` return type. [#120043][#120043]
- Columns can be changed to an identity column by running one of: - `ALTER TABLE t ALTER COLUMN c ADD GENERATED ALWAYS AS IDENTITY [( <opt_sequence_option_list> )]` - `ALTER TABLE t ALTER COLUMN c ADD GENERATED BY DEFAULT AS IDENTITY[( <opt_sequence_option_list> )]`  Identity columns can have their identity type altered by running one of: - `ALTER TABLE t ALTER COLUMN c SET GENERATED ALWAYS` - `ALTER TABLE t ALTER COLUMN c SET GENERATED BY DEFAULT` [#115889][#115889]
- Added support for the PL/pgSQL NULL statement. [#119037][#119037]
- Crdb_internal.leases is now behind the VIEWCLUSTERMETADATA privilege. [#120014][#120014]
- PL/pgSQL blocks can now be nested in a block that has an exception handler. [#120045][#120045]

<h3 id="v24-1-0-alpha-3-db-console-changes">DB Console changes</h3>

- Resolves an issue where clusters with multiple stores per node may list inaccurate region/node information in the databases table. [#119260][#119260]

<h3 id="v24-1-0-alpha-3-bug-fixes">Bug fixes</h3>

- Fixed a bug that occurred when using ALTER TABLE to drop and re-add a CHECK constraint with the same name. [#120008][#120008]
- Fix a bug in which it was possible to `SET transaction_read_only = false` during an AS OF SYSTEM TIME transaction. [#120097][#120097]
- Users will no longer see VIEW type tables from being shown in the db-console databases pages. Previously these would be listed with no info, only displaying errors. [#119890][#119890]
- Fixes intermittent page crash on the Schema Insights view. [#120137][#120137]
- Fixes rows written value on insights page. [#120145][#120145]
- A slow memory leak that can accumulate when opening many new connections has been fixed. The bug is present in 22.2.9+ and 23.1+ versions. [#119799][#119799]

<h3 id="v24-1-0-alpha-3-miscellaneous">Miscellaneous</h3>

<h4 id="v24-1-0-alpha-3-changes-without-release-note-annotation">Changes without release note annotation</h4>

- [#119752][#119752] [29df8ab1b][29df8ab1b] sqlstats: dont block flush due to sql activity job (Xin Hao Zhang <xzhang@cockroachlabs.com>)
- [#119996][#119996] [857d82c54][857d82c54] roachtest: escape url in debug zip (Darryl Wong <darryl.wong@cockroachlabs.com>)

<h3 id="v24-1-0-alpha-3-doc-updates">Doc updates</h3>

{% comment %}Docs team: Please add these manually.{% endcomment %}

<div class="release-note-contributors" markdown="1">

<h3 id="v24-1-0-alpha-3-contributors">Contributors</h3>

This release includes 90 merged PRs by 35 authors.
We would like to thank the following contributors from the CockroachDB community:

- Andrew Delph
- Darryl Wong (first-time contributor, CockroachDB team member)
- David Hartunian (first-time contributor, CockroachDB team member)
- Jasmine Sun
- Lauren Barker (first-time contributor, CockroachDB team member)

</div>

[#115889]: https://github.com/cockroachdb/cockroach/pull/115889
[#119037]: https://github.com/cockroachdb/cockroach/pull/119037
[#119260]: https://github.com/cockroachdb/cockroach/pull/119260
[#119752]: https://github.com/cockroachdb/cockroach/pull/119752
[#119799]: https://github.com/cockroachdb/cockroach/pull/119799
[#119890]: https://github.com/cockroachdb/cockroach/pull/119890
[#119913]: https://github.com/cockroachdb/cockroach/pull/119913
[#119996]: https://github.com/cockroachdb/cockroach/pull/119996
[#120008]: https://github.com/cockroachdb/cockroach/pull/120008
[#120014]: https://github.com/cockroachdb/cockroach/pull/120014
[#120043]: https://github.com/cockroachdb/cockroach/pull/120043
[#120045]: https://github.com/cockroachdb/cockroach/pull/120045
[#120097]: https://github.com/cockroachdb/cockroach/pull/120097
[#120137]: https://github.com/cockroachdb/cockroach/pull/120137
[#120145]: https://github.com/cockroachdb/cockroach/pull/120145
[29df8ab1b]: https://github.com/cockroachdb/cockroach/commit/29df8ab1b
[857d82c54]: https://github.com/cockroachdb/cockroach/commit/857d82c54
