## v24.1.0-alpha.3

Release Date: March 18, 2024

{% include releases/new-release-downloads-docker-image.md release=include.release %}

<h3 id="v24-1-0-alpha-3-{{-site.data.products.enterprise-}}-edition-changes">{{ site.data.products.enterprise }} edition changes</h3>

- [`cockroach gen encryption-key`](../v24.1/encryption.html) now accepts a `--version=2` parameter. Version 2 keys activate a new encryption implementation with improved performance. This is expected to become the default in CockroachDB v24.2. [#119913][#119913]

<h3 id="v24-1-0-alpha-3-sql-language-changes">SQL language changes</h3>

- Mutation statements such as [`UPDATE`](../v24.1/update.html) and [`DELETE`](../v24.1/delete.html) as well as locking statements such as [`SELECT FOR UPDATE`](../v24.1/select-for-update.html) are not allowed in read-only transactions or [`AS OF SYSTEM TIME`](../v24.1/as-of-system-time.html) transactions. This fixes an oversight where CockroachDB was allowing mutation statements and locking statements in implicit single-statement transactions using `AS OF SYSTEM TIME`. [#120097][#120097]
- Added support for `RETURN` statements with no expression for routines with `OUT` parameters and routines with a `VOID` return type. [#120043][#120043]
- [`ALTER COLUMN`](../v24.1/alter-table.html#alter-column) can now change columns to an identity column by using the syntax in one of the following:

    {% include_cached copy-clipboard.html %}
    ~~~ sql
    ALTER TABLE t ALTER COLUMN c ADD GENERATED ALWAYS AS IDENTITY [( <opt_sequence_option_list> )]
    ALTER TABLE t ALTER COLUMN c ADD GENERATED BY DEFAULT AS IDENTITY[( <opt_sequence_option_list> )]
    ~~~

    Identity columns can have their identity type altered by using the syntax in one of the following statements:

    {% include_cached copy-clipboard.html %}
    ~~~ sql
    ALTER TABLE t ALTER COLUMN c SET GENERATED ALWAYS
    ALTER TABLE t ALTER COLUMN c SET GENERATED BY DEFAULT
    ~~~

    [#115889][#115889]

- Added support for the [PL/pgSQL](../v24.1/plpgsql.html) `NULL` statement. [#119037][#119037]
- [`crdb_internal.leases`](../v24.1/crdb-internal.html) is now behind the [`VIEWCLUSTERMETADATA` privilege](../v24.1/security-reference/authorization.html#supported-privileges). [#120014][#120014]
- [PL/pgSQL](../v24.1/plpgsql.html) blocks can now be nested in a block that has an exception handler. [#120045][#120045]

<h3 id="v24-1-0-alpha-3-db-console-changes">DB Console changes</h3>

- Resolved an issue where clusters with multiple stores per node may list inaccurate region/node information in the [**Databases**](../v24.1/ui-databases-page.html) page. [#119260][#119260]
- `VIEW` type tables will no longer display in the DB Console [**Databases**](../v24.1/ui-databases-page.html) pages. Previously these would be listed with no information, only displaying errors. [#119890][#119890]
- Fixed an intermittent page crash in the [**Schema Insights**](../v24.1/ui-insights-page.html#schema-insights-tab) tab. [#120137][#120137]
- Fixed a bug where the **Rows written** value was incorrectly showing the **Rows read** value on the [**Insights**](../v24.1/ui-insights-page.html) page. [#120145][#120145]


<h3 id="v24-1-0-alpha-3-bug-fixes">Bug fixes</h3>

- Fixed a bug that occurred when using [`ALTER TABLE`](../v24.1/alter-table.html) to drop and re-add a [`CHECK` constraint](../v24.1/check.html) with the same name. [#120008][#120008]
- Fixed a bug in which it was possible to [`SET transaction_read_only = false`](../v24.1/show-vars.html#supported-variables) during an [`AS OF SYSTEM TIME`](../v24.1/as-of-system-time.html) transaction. [#120097][#120097]
- Fixed a bug that caused a slow memory leak that could accumulate when opening many new connections. The bug was present in v22.2.9+ and v23.1+ versions. [#119799][#119799]

<h3 id="v24-1-0-alpha-3-contributors">Contributors</h3>

This release includes 90 merged PRs by 35 authors.
We would like to thank the following contributors from the CockroachDB community:

- Andrew Delph

</div>

[#115889]: https://github.com/cockroachdb/cockroach/pull/115889
[#119037]: https://github.com/cockroachdb/cockroach/pull/119037
[#119260]: https://github.com/cockroachdb/cockroach/pull/119260
[#119752]: https://github.com/cockroachdb/cockroach/pull/119752
[#119799]: https://github.com/cockroachdb/cockroach/pull/119799
[#119890]: https://github.com/cockroachdb/cockroach/pull/119890
[#119913]: https://github.com/cockroachdb/cockroach/pull/119913
[#119996]: https://github.com/cockroachdb/cockroach/pull/119996
[#120008]: https://github.com/cockroachdb/cockroach/pull/120008
[#120014]: https://github.com/cockroachdb/cockroach/pull/120014
[#120043]: https://github.com/cockroachdb/cockroach/pull/120043
[#120045]: https://github.com/cockroachdb/cockroach/pull/120045
[#120097]: https://github.com/cockroachdb/cockroach/pull/120097
[#120137]: https://github.com/cockroachdb/cockroach/pull/120137
[#120145]: https://github.com/cockroachdb/cockroach/pull/120145
