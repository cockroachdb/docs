## v24.1.0

Release Date: May 20, 2024

With the release of CockroachDB v24.1, we've added new capabilities to help you migrate, build, and operate more efficiently. Refer to our summary of the most significant user-facing changes under [Feature Highlights](#v24-1-0-feature-highlights).

{% include releases/new-release-downloads-docker-image.md release=include.release advisory_key="a103220"%}

<h3 id="v24-1-0-feature-highlights">Feature highlights</h3>

This section summarizes the most significant user-facing changes in v24.1.0 and other features recently made available to CockroachDB users across versions. For a complete list of features and changes in v24.1, including bug fixes and performance improvements, refer to the [release notes]({% link releases/index.md %}#testing-releases) for previous v24.1 testing releases. You can also search the docs for sections labeled [New in v24.1](https://www.cockroachlabs.com/docs/search?query=new+in+v24.1).

- **Feature categories**
    - [Performance](#v24-1-0-performance)
    - [Change data capture](#v24-1-0-change-data-capture)
    - [Recovery](#v24-1-0-recovery)
    - [Security](#v24-1-0-security)
    - [Migrations](#v24-1-0-migrations)
    - [SQL](#v24-1-0-sql)
    - [Operations](#v24-1-0-operations)
    - [Observability](#v24-1-0-observability)
- **Additional information**
    - [Backward-incompatible changes](#v24-1-0-backward-incompatible-changes)
    - [Deprecations](#v24-1-0-deprecations)
    - [Known limitations](#v24-1-0-known-limitations)
    - [Additional resources](#v24-1-0-additional-resources)

{{ site.data.alerts.callout_info }}
In CockroachDB Self-Hosted, all available features are free to use unless their description specifies that an Enterprise license is required. For more information, refer to the [Licensing FAQ](https://www.cockroachlabs.com/docs/stable/licensing-faqs).
{{ site.data.alerts.end }}

<div id="feature-highlights">

<h4 id="v24-1-0-performance">Performance</h4>
<table>
    <thead>
        <tr>
            <th class="center-align" colspan="1" rowspan="2">Feature</th>
            <th class="center-align" colspan="4" rowspan="1">Availability</th>
        </tr>
        <tr>
            <th colspan="1" rowspan="1">Ver.</th>
            <th colspan="1" rowspan="1" style="white-space: nowrap;">Self-Hosted</th>
            <th colspan="1" rowspan="1">Dedicated</th>
            <th colspan="1" rowspan="1">Serverless</th>
        </tr>
    </thead>
    <tbody>
    <tr>
        <td>
            <p class="feature-summary">WAL (Write-Ahead Logging) Failover</p>
            <p class="feature-description">When a CockroachDB node is configured to run with multiple stores, you can mitigate some effects of disk stalls by configuring the node to <a href="https://www.cockroachlabs.com/docs/v24.1/cockroach-start#write-ahead-log-wal-failover">failover the store's write-ahead log (WAL)</a> to another store's data directory.</p>
            <p class="feature-description">This feature is in preview.</p>
        </td>
        <td>24.1</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
        <td class="icon-center">{% include icon-no.html %}</td>
        <td class="icon-center">{% include icon-no.html %}</td>
    </tr>
    <tr>
        <td>
            <p class="feature-summary">Autocommit DDL</p>
            <p class="feature-description">In 24.1 we have added the <code>autocommit_before_ddl</code> <a href="https://www.cockroachlabs.com/docs/v24.1/session-variables#supported-variables">session
variable</a>. When set to true, any schema change statement that is sent
during an explicit transaction will cause the transaction to commit
before executing the schema change.
This setting can be used to improve compatibility with some tools that
do not work well due to our limitations with schema changes in explicit
transactions. It also can be used to use schema changes under <code>READ
COMMITTED</code> more easily, without needing to teach the schema changer about
<code>READ COMMITTED</code>.</p>
        </td>
        <td>24.1</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
    </tr>
    <tr>
        <td>
            <p class="feature-summary">Statistics for virtual computed columns</p>
            <p class="feature-description">CockroachDB now collects statistics for <a href="https://www.cockroachlabs.com/docs/v24.1/computed-columns.html#virtual-computed-columns">virtual computed columns</a>, making it possible to optimize query plans for tables that have these columns. Customers will see better query performance for queries that involve virtual computed columns.</p>
            <p class="feature-description">For more information, you can also view a <a href="https://youtu.be/5D9jUV8Vs_U">video demo</a>.</p>
        </td>
        <td>24.1</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
    </tr>
    <tr>
        <td>
            <p class="feature-summary">Write Amplification Improvements</p>
            <p class="feature-description">A number of <a href="https://www.cockroachlabs.com/docs/v24.1/architecture/storage-layer">Pebble</a> improvements are now on by default, leading to a reduction in <a href="https://www.cockroachlabs.com/docs/v24.1/architecture/storage-layer#inverted-lsms">write amplification</a>. Of particular note, a vast majority of range snapshots previously ingested into L0 are now ingested directly into L6 in the <a href="https://www.cockroachlabs.com/docs/v24.1/architecture/storage-layer#log-structured-merge-trees">LSM</a>, reducing write and read amplification with positive effects to node stability and SQL performance.</p>
        </td>
        <td>24.1</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
    </tr>
    <tr>
        <td>
            <p class="feature-summary">Increased SLA for multi-region Dedicated clusters</p>
            <p class="feature-description">CockroachDB Dedicated multi-region clusters now offer a <a href="https://www.cockroachlabs.com/cloud-terms-and-conditions/cockroachcloud-technical-service-level-agreement/">five-nines (99.999%) availability target</a>.</p>
        </td>
        <td>All<sup>*</sup></td>
        <td class="icon-center">{% include icon-no.html %}</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
        <td class="icon-center">{% include icon-no.html %}</td>
    </tr>
    </tbody>
</table>

<h4 id="v24-1-0-change-data-capture">Change Data Capture</h4>
<table>
    <thead>
        <tr>
            <th class="center-align" colspan="1" rowspan="2">Feature</th>
            <th class="center-align" colspan="4" rowspan="1">Availability</th>
        </tr>
        <tr>
            <th colspan="1" rowspan="1">Ver.</th>
            <th colspan="1" rowspan="1" style="white-space: nowrap;">Self-Hosted</th>
            <th colspan="1" rowspan="1">Dedicated</th>
            <th colspan="1" rowspan="1">Serverless</th>
        </tr>
    </thead>
    <tbody>
    <tr>
        <td>
            <p class="feature-summary">Improved performance for changefeeds at scale</p>
            <p class="feature-description"><a href="https://www.cockroachlabs.com/docs/v24.1/advanced-changefeed-configuration#mux-rangefeeds">Mux rangefeed</a> is a subsystem that improves the performance of <a href="https://www.cockroachlabs.com/docs/v24.1/create-and-configure-changefeeds#enable-rangefeeds">rangefeeds</a> with scale. In v24.1, Mux rangefeeds are enabled by default.</p>
        </td>
        <td>24.1</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
    </tr>
    <tr>
        <td>
            <p class="feature-summary">Emit changefeed messages to an Azure Event Hub</p>
            <p class="feature-description">Changefeeds can emit messages to an <a href="https://www.cockroachlabs.com/docs/v24.1/changefeed-examples#create-a-changefeed-connected-to-an-azure-event-hubs-sink">Azure Event Hub</a>, which is compatible with Apache Kafka. You can use the Kafka changefeed and sink configuration options.</p>
        </td>
        <td>24.1</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
    </tr>
    <tr>
        <td>
            <p class="feature-summary">Google Cloud Pub/Sub sink for changefeeds is now generally available</p>
            <p class="feature-description">The changefeed <a href="https://www.cockroachlabs.com/docs/v24.1/changefeed-sinks#google-cloud-pub-sub">sink for Google Cloud Pub/Sub</a> is GA.</p>
        </td>
        <td>24.1</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
    </tr>
    <tr>
        <td>
            <p class="feature-summary">Filter changefeed messages based on cluster, SQL session, or row-level TTL jobs</p>
            <p class="feature-description">Use the <code>disable_changefeed_replication</code> session variable to prevent changefeeds from emitting messages for any changes during that session. Also in v24.1, you can enable the <code>ignore_disable_changefeed_replication</code> option to ignore the storage parameter or cluster setting that disables changefeed replication. These <a href="https://www.cockroachlabs.com/docs/v24.1/changefeed-messages#filtering-changefeed-messages">settings</a> can be useful to manage multiple changefeed use cases on the same table.</p>
        </td>
        <td>24.1</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
    </tr>
    <tr>
        <td>
            <p class="feature-summary">Set Kafka quotas per changefeed</p>
            <p class="feature-description">For <a href="https://www.cockroachlabs.com/docs/v24.1/changefeed-sinks#kafka-sink-configuration">Kafka sinks</a>, implement a resource usage limit per changefeed by setting a client ID and quota in your Kafka server's configuration.</p>
        </td>
        <td>24.1</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
    </tr>
    </tbody>
</table>

<h4 id="v24-1-0-recovery">Recovery</h4>
<table>
    <thead>
        <tr>
            <th class="center-align" colspan="1" rowspan="2">Feature</th>
            <th class="center-align" colspan="4" rowspan="1">Availability</th>
        </tr>
        <tr>
            <th colspan="1" rowspan="1">Ver.</th>
            <th colspan="1" rowspan="1" style="white-space: nowrap;">Self-Hosted</th>
            <th colspan="1" rowspan="1">Dedicated</th>
            <th colspan="1" rowspan="1">Serverless</th>
        </tr>
    </thead>
    <tbody>
    <tr>
        <td>
            <p class="feature-summary">Physical Cluster Replication is now generally available</p>
            <p class="feature-description"><a href="https://www.cockroachlabs.com/docs/v24.1/physical-cluster-replication-overview">Physical Cluster Replication</a> is an asynchonous replication feature that allows your cluster to recover from full-cluster failure with a low RPO and RTO. In 24.1, it is a GA feature, requiring an Enterprise license, and only available for self-hosted CockroachDB deployments. For more information, refer to the <a href="https://www.cockroachlabs.com/docs/v24.1/physical-cluster-replication-overview">Physical Cluster Replication overview</a> and a <a href="https://www.cockroachlabs.com/blog/232-physical-cluster-replication/">blog post about Physical Cluster Replication</a>.</p>
        </td>
        <td>24.1</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
        <td class="icon-center">{% include icon-no.html %}</td>
        <td class="icon-center">{% include icon-no.html %}</td>
    </tr>
    </tbody>
</table>

<h4 id="v24-1-0-security">Security</h4>
<table>
    <thead>
        <tr>
            <th class="center-align" colspan="1" rowspan="2">Feature</th>
            <th class="center-align" colspan="4" rowspan="1">Availability</th>
        </tr>
        <tr>
            <th colspan="1" rowspan="1">Ver.</th>
            <th colspan="1" rowspan="1" style="white-space: nowrap;">Self-Hosted</th>
            <th colspan="1" rowspan="1">Dedicated</th>
            <th colspan="1" rowspan="1">Serverless</th>
        </tr>
    </thead>
    <tbody>
    <tr>
        <td>
            <p class="feature-summary">Private connectivity in CockroachDB Dedicated with Google Cloud Private Service Connect</p>
            <p class="feature-description"><a href="https://www.cockroachlabs.com/docs/cockroachcloud/connect-to-your-cluster.html#establish-private-connectivity">Private connectivity</a> using Private Service Connect is now available in preview for CockroachDB Dedicated clusters on GCP. For more information, refer to <a href="https://www.cockroachlabs.com/docs/cockroachcloud/connect-to-your-cluster.html#establish-private-connectivity">Establish Private Connectivity</a> and a <a href="https://youtu.be/lcPnFEv0_eE">video about how to set it up</a>.</p>
        </td>
        <td>All<sup>*</sup></td>
        <td class="icon-center">{% include icon-no.html %}</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
        <td class="icon-center">{% include icon-no.html %}</td>
    </tr>
    <tr>
        <td>
            <p class="feature-summary">Support for matching against SUBJECT</p>
            <p class="feature-description">When using certificate based authentication, CockroachDB now supports mapping of SQL user roles to <a href="https://www.cockroachlabs.com/docs/v24.1/certificate-based-authentication-using-the-x509-subject-field">values in the Subject field of the X.509 certificate</a> used for TLS authentication.</p>
            <p class="feature-description">Subject mapping is useful if:
            <ul>
            <li>You run your own Certificate Authority (CA) infrastructure.</li>
            <li>You need to use your existing CA infrastructure to manage SQL user authentication.</li>
            <li>You need to use the same CA for multiple CockroachDB clusters.</li>
            </ul>
            </p>
        </td>
        <td>24.1</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
        <td class="icon-center">{% include icon-no.html %}</td>
    </tr>
    </tbody>
</table>

<h4 id="v24-1-0-migrations">Migrations</h4>
<table>
    <thead>
        <tr>
            <th class="center-align" colspan="1" rowspan="2">Feature</th>
            <th class="center-align" colspan="4" rowspan="1">Availability</th>
        </tr>
        <tr>
            <th colspan="1" rowspan="1">Ver.</th>
            <th colspan="1" rowspan="1" style="white-space: nowrap;">Self-Hosted</th>
            <th colspan="1" rowspan="1">Dedicated</th>
            <th colspan="1" rowspan="1">Serverless</th>
        </tr>
    </thead>
    <tbody>
    <tr>
        <td>
            <p class="feature-summary"></p>
            <p class="feature-description"><a href="https://www.cockroachlabs.com/docs/v24.1/molt-fetch.html">MOLT Fetch</a> is GA. MOLT Fetch automatically imports data from a PostgreSQL, MySQL, or CockroachDB source to a target CockroachDB database. If the fetch process encounters an error, data import can be continued from the point where it was interrupted. MOLT Fetch can be configured to replicate ongoing changes on the source database to CockroachDB following the initial data load.</p>
        </td>
        <td>All<sup>*</sup></td>
        <td class="icon-center">{% include icon-yes.html %}</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
    </tr>
    </tbody>
</table>

<h4 id="v24-1-0-sql">SQL</h4>
<table>
    <thead>
        <tr>
            <th class="center-align" colspan="1" rowspan="2">Feature</th>
            <th class="center-align" colspan="4" rowspan="1">Availability</th>
        </tr>
        <tr>
            <th colspan="1" rowspan="1">Ver.</th>
            <th colspan="1" rowspan="1" style="white-space: nowrap;">Self-Hosted</th>
            <th colspan="1" rowspan="1">Dedicated</th>
            <th colspan="1" rowspan="1">Serverless</th>
        </tr>
    </thead>
    <tbody>
    <tr>
        <td>
            <p class="feature-summary">Stored Procedures and UDF Improvements</p>
            <p class="feature-description">Support for PL/pgSQL, user-defined functions, and stored procedures is now expanded:
                <ul>
                    <li><a href="https://www.cockroachlabs.com/docs/v24.1/create-procedure#create-a-stored-procedure-that-uses-out-and-inout-parameters">OUT and INOUT</a> parameters can be specified.</li>
                    <li>PL/pgSQL <a href="https://www.cockroachlabs.com/docs/v24.1/plpgsql.html#exit-and-continue-statements">EXIT and CONTINUE statements</a> can be used together with conditions.</li>
                    <li>UDFs can <a href="https://www.cockroachlabs.com/docs/v24.1/create-function#create-a-function-that-invokes-a-function">call other UDFs</a>.</li>
                    <li>Stored procedures can <a href="https://www.cockroachlabs.com/docs/v24.1/create-procedure#create-a-stored-procedure-that-calls-a-procedure">invoke other stored procedures</a> using a <a href="https://www.cockroachlabs.com/docs/v24.1/plpgsql.html#call-a-procedure">PL/pgSQL CALL statement</a>.</li>
                    <li><a href="https://www.cockroachlabs.com/docs/v24.1/plpgsql.html#control-transactions">Transaction control within PL/pgSQL blocks</a> is possible using COMMIT, ROLLBACK, and SET TRANSACTION statements.</li>
                </ul></p>
                        <p class="feature-description">For more information, you can also view a <a href="https://youtu.be/8M_ISTZMAis">video demo</a>.</p>
        </td>
        <td>24.1</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
    </tr>
    <tr>
        <td>
            <p class="feature-summary">Read Committed Isolation in GA</p>
            <p class="feature-description">Read Committed isolation is now GA. Under <code><a href="https://www.cockroachlabs.com/docs/v24.1/read-committed">READ COMMITTED</a></code> isolation, DDL operations can be auto-committed, and <code>RETRY_SERIALIZABLE</code> errors are absent. This offers a simpler migration path for applications and removes the need for client-side retry handling, which is necessary under <code>SERIALIZABLE</code> isolation.</p>
            <p class="feature-description">For more information, you can also view a <a href="https://youtu.be/RX5SYAap57s">video about using Read Committed isolation</a> and the blog post <a href="https://www.cockroachlabs.com/blog/232-read-committed-no-more-anomaly-tables/">Isolation levels without the anomaly table</a>.</p>
        </td>
        <td>24.1</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
    </tr>
    <tr>
        <td>
            <p class="feature-summary">SELECT FOR SHARE updates</p>
            <p class="feature-description">A shared lock that is acquired explicitly using <a href="https://www.cockroachlabs.com/docs/v24.1/select-for-update#for-share-usage"><code>SELECT FOR SHARE</code></a> or implicitly by a read-committed transaction, can now be re-acquired with higher strength by either using a <code>SELECT FOR UPDATE</code> statement or by writing to the key.</p>
        </td>
        <td>24.1</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
    </tr>
    <tr>
        <td>
            <p class="feature-summary">SHOW DEFAULT SESSION VARIABLES FOR ROLE</p>
            <p class="feature-description">Previously, a database administrator could discover which session variables were set for a role only by switching into to that user or querying a system table. The new command <a href="https://www.cockroachlabs.com/docs/v24.1/show-default-session-variables-for-role"><code>SHOW DEFAULT SESSION VARIABLES FOR ROLE</code></a> shows the database administrator the default values for session variables applied to a given user.</p>
        </td>
        <td>24.1</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
    </tr>
    </tbody>
</table>

<h4 id="v24-1-0-operations">Operations</h4>
<table>
    <thead>
        <tr>
            <th class="center-align" colspan="1" rowspan="2">Feature</th>
            <th class="center-align" colspan="4" rowspan="1">Availability</th>
        </tr>
        <tr>
            <th colspan="1" rowspan="1">Ver.</th>
            <th colspan="1" rowspan="1" style="white-space: nowrap;">Self-Hosted</th>
            <th colspan="1" rowspan="1">Dedicated</th>
            <th colspan="1" rowspan="1">Serverless</th>
        </tr>
    </thead>
    <tbody>
    <tr>
        <td>
            <p class="feature-summary">New Regions for CockroachDB Dedicated</p>
            <p class="feature-description">Cockroach Cloud is now available in additional Azure regions. This expansion enhances our global reach and offers more options for deploying resilient, distributed databases with low latency and high availability.</p>
            <p class="feature-description">With these <a href="https://www.cockroachlabs.com/docs/releases/cloud#2024-04-18-general-updates">new regions</a>, you can now select a geographical location that best fits your needs, reducing data latency and ensuring compliance with regional data residency regulations. Deploying in a region close to your service or customers means improved performance and a better user experience.</p>
        </td>
        <td>All<sup>*</sup></td>
        <td class="icon-center">{% include icon-no.html %}</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
        <td class="icon-center">{% include icon-no.html %}</td>
    </tr>
    <tr>
        <td>
            <p class="feature-summary">Organize Cloud clusters using Folders</p>
            <p class="feature-description"><a href="https://www.cockroachlabs.com/docs/cockroachcloud/folders">Folders</a> help users organize and manage access for Clusters by projects, teams or business units. This feature is now in public preview and available to all Cloud organizations. For additional details, refer to the <a href="https://www.cockroachlabs.com/docs/releases/cloud#may-12-2024">release note.</a></p>
        </td>
        <td>All<sup>*</sup></td>
        <td class="icon-center">{% include icon-no.html %}</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
    </tr>
    <tr>
        <td>
            <p class="feature-summary">CockroachDB Cloud Terraform provider IAM enhancements</p>
            <p class="feature-description">The <a href="https://registry.terraform.io/providers/cockroachdb/cockroach/latest">CockroachDB Cloud Terraform provider</a> has new resources for User Role Grant and Service Accounts, and a new data source for Folders. These new features improve customers’ ability to manage secure access to data, API, and infrastructure on CockroachDB Cloud.</p>
        </td>
        <td>All<sup>*</sup></td>
        <td class="icon-center">{% include icon-no.html %}</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
    </tr>
    </tbody>
</table>

<h4 id="v24-1-0-observability">Observability</h4>
<table>
    <thead>
        <tr>
            <th class="center-align" colspan="1" rowspan="2">Feature</th>
            <th class="center-align" colspan="4" rowspan="1">Availability</th>
        </tr>
        <tr>
            <th colspan="1" rowspan="1">Ver.</th>
            <th colspan="1" rowspan="1" style="white-space: nowrap;">Self-Hosted</th>
            <th colspan="1" rowspan="1">Dedicated</th>
            <th colspan="1" rowspan="1">Serverless</th>
        </tr>
    </thead>
    <tbody>
    <tr>
        <td>
            <p class="feature-summary">CockroachDB Dedicated supports a Prometheus-compatibile metric scrape endpoint.</p>
            <p class="feature-description">The <a href="https://www.cockroachlabs.com/docs/cockroachcloud/export-metrics.html?filters=prometheus-metrics-export">Prometheus-compatibile metric scrape endpoint</a> for CockroachDB Dedicated is generally available.</p>
        </td>
        <td>All<sup>*</sup></td>
        <td class="icon-center">{% include icon-no.html %}</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
        <td class="icon-center">{% include icon-no.html %}</td>
    </tr>
    <tr>
        <td>
            <p class="feature-summary">Export CockroachDB Dedicated metrics to Azure Monitor</p>
            <p class="feature-description">CockroachDB Dedicated supports <a href="https://www.cockroachlabs.com/docs/cockroachcloud/export-metrics?filters=azure-monitor-metrics-export">exporting metrics to Azure Monitor</a> in limited access. Contact your Cockroach Labs account team for access.</p>
        </td>
        <td>All<sup>*</sup></td>
        <td class="icon-center">{% include icon-no.html %}</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
        <td class="icon-center">{% include icon-no.html %}</td>
    </tr>
    <tr>
        <td>
            <p class="feature-summary">Export CockroachDB Dedicated logs to Azure Monitor</p>
            <p class="feature-description">CockroachDB Dedicated supports <a href="https://www.cockroachlabs.com/docs/cockroachcloud/export-logs?filters=azure-monitor-log-export">exporting logs to Azure Monitor</a> in limited access. Contact your Cockroach Labs account team for access.</p>
        </td>
        <td>All<sup>*</sup></td>
        <td class="icon-center">{% include icon-no.html %}</td>
        <td class="icon-center">{% include icon-yes.html %}</td>
        <td class="icon-center">{% include icon-no.html %}</td>
    </tr>
    </tbody>
</table>

<table>
    <thead>
        <tr>
            <th id="feature-detail-key" colspan="2">Feature detail key</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>*</td>
            <td>Features marked “All*” were recently made available in the CockroachDB Cloud platform. They are available for all supported versions of CockroachDB, under the deployment methods specified in their row under Availability.</td>
        </tr>
        <tr>
            <td>**</td>
            <td>Features marked “All**” were recently made available via migration tools maintained outside of the CockroachDB binary. They are available to use with all supported versions of CockroachDB, under the deployment methods specified in their row under Availability.</td>
        </tr>
        <tr>
            <td>{% include icon-yes.html %}</td>
            <td>Feature is available for this deployment method of CockroachDB as specified in the icon’s column: CockroachDB Self-Hosted, CockroachDB Dedicated, or CockroachDB Serverless.</td>
        </tr>
        <tr>
            <td>{% include icon-no.html %}</td>
            <td>Feature is not available for this deployment method of CockroachDB as specified in the icon’s column: CockroachDB Self-Hosted, CockroachDB Dedicated, or CockroachDB Serverless.</td>
        </tr>
    </tbody>
</table>

</div>

<h4 id="v24-1-0-backward-incompatible-changes">Backward-incompatible changes</h4>

Before [upgrading to CockroachDB v24.1]({% link v24.1/upgrade-cockroach-version.md %}), be sure to review the following backward-incompatible changes, as well as [key cluster setting changes](#v24-1-0-cluster-settings), and adjust your deployment as necessary.

- [`AS OF SYSTEM TIME`]({% link v24.1/as-of-system-time.md %}) queries can no longer use a timestamp followed by a question mark to signify a future-time value. This was an undocumented syntax. [#116830](https://github.com/cockroachdb/cockroach/pull/116830)
- The [`READ COMMITTED`]({% link v24.1/read-committed.md %}) isolation level now requires the cluster to have a valid [enterprise license](https://cockroachlabs.com/docs/v24.1/licensing-faqs#obtain-a-license). Otherwise, transactions which are configured to run as `READ COMMITTED` will be upgraded to [`SERIALIZABLE`]({% link v24.1/demo-serializable.md %}), as described in the next note. [#120154](https://github.com/cockroachdb/cockroach/pull/120154)
- <a id="read-committed-transaction-upgrade"></a>The `sql.txn.read_committed_isolation.enabled` [cluster setting]({% link v24.1/cluster-settings.md %}) is now `true` by default. As a result for enterprise users, [`READ COMMITTED`]({% link v24.1/read-committed.md %}) transactions are **not** automatically upgraded to [`SERIALIZABLE`]({% link v24.1/demo-serializable.md %}), and will run as `READ COMMITTED` by default. On v23.2, refer to the [Upgrades of SQL Transaction Isolation Level]({% link v24.1/ui-sql-dashboard.md %}#upgrades-of-sql-transaction-isolation-level) graph in the DB Console to check whether any transaction is being upgraded from a weaker isolation level to `SERIALIZABLE`, and could therefore run differently on v24.1. [#118479](https://github.com/cockroachdb/cockroach/pull/118479)

<h4 id="v24-1-0-cluster-settings">Key Cluster Setting Changes</h4>

The following changes should be reviewed prior to upgrading. Default cluster settings will be used unless you have manually set a value for a setting. This can be confirmed by checking the `system.settings` table (`select * from system.settings`) to view the non-default settings.

- `sql.txn.read_committed_isolation.enabled` is now `true` by default. When set to `true`, transactions use the `READ COMMITTED` isolation level if specified by `BEGIN`/`SET` commands.
  - If the cluster setting is `false`, as was the default in v23.2, such `READ COMMITTED` transactions will instead run as `SERIALIZABLE`.
  - To check whether any transactions are being upgraded to `SERIALIZABLE`, see the [**Upgrades of SQL Transaction Isolation Level**]({% link v24.1/ui-sql-dashboard.md %}#upgrades-of-sql-transaction-isolation-level) graph in the DB Console."
- The `changefeed.balance_range_distribution.enabled` [cluster setting]({% link v24.1/cluster-settings.md %}) is now deprecated. Instead, use the new cluster setting `changefeed.default_range_distribution_strategy`. `changefeed.default_range_distribution_strategy='balanced_simple'` has the same effect as setting `changefeed.balance_range_distribution.enabled=true`. It does not require `initial_scan='only'`, which was required by the old setting. [#115166][#115166]
- Added the [cluster setting]({% link v24.1/cluster-settings.md %}) `security.client_cert.subject_required.enabled` which enforces a mandatory requirement for the client certificate's role subject to be set. The subject can be defined through either the subject role option or by specifying the `root-cert-distinguished-name` and `node-cert-distinguished-name` properties. This setting applies to both RPC access and login via authCert. [#122368][#122368]
- The [cluster setting]({% link v24.1/cluster-settings.md %}) `sql.contention.record_serialization_conflicts.enabled` is now `on` by default. As a result, any [`40001` error]({% link v24.1/transaction-retry-error-reference.md %}) that contains conflicting transaction information will be recorded by the contention registry, improving the ability to troubleshoot. For more information, refer to the [Insights page]({% link v24.1/ui-insights-page.md %}) documentation. [#116664][#116664]
- The new [cluster setting]({% link v24.1/cluster-settings.md %}) `storage.sstable.compression_algorithm` configures the compression algorithm used when compressing sstable blocks. Supported values are: "snappy" and "zstd" [snappy = `1`, zstd = `2`]. Changing the default of snappy to zstd can result in substantial performance improvement, however, the effects this change may be highly dependent on the workload and data, so experimentation is recommended before enabling zstd in production environments.
- The new setting `storage.wal_failover.unhealthy_op_threshold` allows you to set the latency threshold at which a WAL (Write-Ahead Logging) write is considered unhealthy. When exceeded, the node will attempt to write WAL entries to a secondary store's volume. For more information, refer to <v24.1/cockroach-start.md#write-ahead-log-wal-failover> [#120509][#120509]
- The new `server.max_open_transactions_per_gateway` [cluster setting]({% link v24.1/cluster-settings.md %}), when set to a non-negative value, allows only admin users to execute a query if the number of open transactions on the current gateway node is already at the configured limit. [#118781][#118781]
- The new `server.redact_sensitive_settings.enabled` [cluster setting]({% link v24.1/cluster-settings.md %}) (`false` by default), when set to `true`, redacts the values of the following settings in the output of `SHOW` commands or other introspection interfaces. In the future, newly-added sensitive cluster settings will be redacted as well. Users with the `MODIFYCLUSTERSETTING` [privilege](https://www.cockroachlabs.com/docs/v24.1/security-reference/authorization#managing-privileges) can always view the unredacted settings. [#117729][#117729]
- The new boolean changefeed option [`ignore_disable_changefeed_replication`](../v24.1/create-changefeed.html#ignore-disable-changefeed-replication), when set to `true`, prevents the changefeed from filtering events even if CDC filtering is configured via the `disable_changefeed_replication` [session variable](../v24.1/session-variables.html), `sql.ttl.changefeed_replication.disabled` [cluster setting](../v24.1/cluster-settings.html), or the `ttl_disable_changefeed_replication` [table storage parameter](../v24.1/alter-table.html#table-storage-parameters). [#120255][#120255]
- The provisioned-rate field, if specified,
should no longer accept a disk-name or an optional bandwidth field. To
use the disk bandwidth constraint the store-spec must contain
`provisioned-rate=bandwidth=<bandwidth-bytes/s>`, otherwise the cluster
setting `kvadmission.store.provisioned_bandwidth` will be used. When set to a non-zero value, this is used as the provisioned bandwidth (in bytes/s), for each store. It can be overridden on a per-store basis using the --store flag. Note that setting the provisioned bandwidth to a positive value may enable disk bandwidth based admission control, since `admission.disk_bandwidth_tokens.elastic.enabled` defaults to `true`.
- Removed in v24.1:
  - `sql.show_ranges_deprecated_behavior.enabled`
  - `sql.trace.session_eventlog.enabled`
  - `changefeed.balance_range_distribution.enabled`

<h4 id="v24-1-0-deprecations">Deprecations</h4>

- `changefeed.balance_range_distribution.enable` is now deprecated. Instead, use the new [cluster setting]({% link v24.1/cluster-settings.md %}) `changefeed.default_range_distribution_strategy`. `changefeed.default_range_distribution_strategy='balanced_simple'` has the same effect as setting `changefeed.balance_range_distribution.enable=true`. It does not require `initial_scan='only'`, which was required by the old setting. [#115166][#115166]
- The `cockroach connect` command has been removed. This command was [deprecated]({% link releases/v23.2.md %}#v23-2-0-deprecations) in CockroachDB v23.2. [#113893][#113893]

<h4 id="v24-1-0-known-limitations">Known limitations</h4>

For information about new and unresolved limitations in CockroachDB v24.1, with suggested workarounds where applicable, refer to [Known Limitations]({% link v24.1/known-limitations.md %}).

<h4 id="v24-1-0-additional-resources">Additional resources</h4>

Resource             | Topic                                      | Description
---------------------+--------------------------------------------+-------------
Cockroach University | [Introduction to Distributed SQL and CockroachDB](https://university.cockroachlabs.com/courses/course-v1:crl+intro-to-distributed-sql-and-cockroachdb+self-paced/about) | This course introduces the core concepts behind distributed SQL databases and describes how CockroachDB fits into this landscape. You will learn what differentiates CockroachDB from both legacy SQL and NoSQL databases and how CockroachDB ensures consistent transactions without sacrificing scale and resiliency. You'll learn about CockroachDB's seamless horizontal scalability, distributed transactions with strict ACID guarantees, and high availability and resilience.
Cockroach University | [Practical First Steps with CockroachDB](https://university.cockroachlabs.com/courses/course-v1:crl+practical-first-steps-with-crdb+self-paced/about) | This course will give you the tools you need to get started with CockroachDB. During the course, you will learn how to spin up a cluster, use the Admin UI to monitor cluster activity, and use SQL shell to solve a set of hands-on exercises.
Cockroach University | [Enterprise Application Development with CockroachDB](https://university.cockroachlabs.com/courses/course-v1:crl+client-side-txn-handling+self-paced/about) | This course is the first in a series designed to equip you with best practices for mastering application-level (client-side) transaction management in CockroachDB. We'll dive deep on common differences between CockroachDB and legacy SQL databases and help you sidestep challenges you might encounter when migrating to CockroachDB from Oracle, PostgreSQL, and MySQL.
Cockroach University | [Building a Highly Resilient Multi-region Database using CockroachDB](https://university.cockroachlabs.com/courses/course-v1:crl+intro-to-resilience-in-multi-region+self-paced/about) | This course is part of a series introducing solutions to running low-latency, highly resilient applications for data-intensive workloads on CockroachDB. In this course we focus on surviving large-scale infrastructure failures like losing an entire cloud region without losing data during recovery. We’ll show you how to use CockroachDB survival goals in a multi-region cluster to implement a highly resilient database that survives node or network failures across multiple regions with zero data loss.
Docs                 | [Migration Overview]({% link v24.1/migration-overview.md %}) | This page summarizes the steps of migrating a database to CockroachDB, which include testing and updating your schema to work with CockroachDB, moving your data into CockroachDB, and testing and updating your application.
Docs                 | [Architecture Overview](https://www.cockroachlabs.com/docs/v24.1/architecture/overview) | This page provides a starting point for understanding the architecture and design choices that enable CockroachDB's scalability and consistency capabilities.
Docs                 | [SQL Feature Support]({% link v24.1/sql-feature-support.md %}) | The page summarizes the standard SQL features CockroachDB supports as well as common extensions to the standard.
Docs                 | [Change Data Capture Overview]({% link v24.1/change-data-capture-overview.md %}) | This page summarizes CockroachDB's data streaming capabilities. Change data capture (CDC) provides efficient, distributed, row-level changefeeds into a configurable sink for downstream processing such as reporting, caching, or full-text indexing.
Docs                 | [Backup Architecture]({% link v24.1/backup-architecture.md %}) | This page describes the backup job workflow with a high-level overview, diagrams, and more details on each phase of the job.

[#115166]: https://github.com/cockroachdb/cockroach/pull/115166
[#113893]: https://github.com/cockroachdb/cockroach/pull/113893
[#115166]: https://github.com/cockroachdb/cockroach/pull/115166
[#122368]: https://github.com/cockroachdb/cockroach/pull/122368
[#116664]: https://github.com/cockroachdb/cockroach/pull/116664
[#120509]: https://github.com/cockroachdb/cockroach/pull/120509
[#118781]: https://github.com/cockroachdb/cockroach/pull/118781
[#117729]: https://github.com/cockroachdb/cockroach/pull/117729
[#120255]: https://github.com/cockroachdb/cockroach/pull/120255
