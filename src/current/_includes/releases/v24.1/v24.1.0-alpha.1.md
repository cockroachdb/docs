## v24.1.0-alpha.1

Release Date: March 7, 2024

{% include releases/new-release-downloads-docker-image.md release=include.release %}

<h3 id="v24-1-0-alpha-1-backward-incompatible-changes">Backward-incompatible changes</h3>

- [`AS OF SYSTEM TIME`]({% link v23.2/as-of-system-time.md %}) queries can no longer use a timestamp followed by a question mark to signify a future-time value. This was an undocumented syntax. [#116830][#116830]

<h3 id="v24-1-0-alpha-1-{{-site.data.products.enterprise-}}-edition-changes">{{ site.data.products.enterprise }} edition changes</h3>

- [`ALTER CHANGEFEED`]({% link v23.2/alter-changefeed.md %}) no longer removes a [CDC query]({% link v23.2/cdc-queries.md %}) when modifying changefeed properties. [#116498][#116498]
- `changefeed.balance_range_distribution.enable` is now deprecated. Instead, use the new [cluster setting]({% link v23.2/cluster-settings.md %}) `changefeed.default_range_distribution_strategy`. `changefeed.default_range_distribution_strategy='balanced_simple'` has the same effect as setting `changefeed.balance_range_distribution.enable=true`. It does not require `initial_scan='only'`, which was required by the old setting. [#115166][#115166]
- CDC queries now correctly handle the [`changefeed_creation_timestamp`]({% link v23.2/cdc-queries.md %}#cdc-query-function-support) function. [#117520][#117520]
- The new syntax `ALTER VIRTUAL CLUSTER virtual-cluster START REPLICATION OF virtual-cluster ON physical-cluster` can now be used to reconfigure virtual clusters previously serving as sources for [physical cluster replication]({% link v23.2/physical-cluster-replication-overview.md %}) to become standbys to a promoted standby. This reverses the direction of replication while maximizing data reuse. [#117656][#117656]
- [`BACKUP`]({% link v23.2/backup.md %})s now load range information that is used to avoid a spike in metadata lookups when backups begin. [#116520][#116520]
- Clusters created to run [physical cluster replication]({% link v23.2/physical-cluster-replication-overview.md %}) no longer automatically disable the [`spanconfig.range_coalescing.system.enabled`]({% link v23.2/cluster-settings.md %}#setting-spanconfig-storage-coalesce-adjacent-enabled) and [`spanconfig.range_coalescing.application.enabled`]({% link v23.2/cluster-settings.md %}#setting-spanconfig-tenant-coalesce-adjacent-enabled) cluster settings. Users who started using physical cluster replication on v23.1 or v23.2 may wish to manually reset these settings. [#119221][#119221]
- Physical cluster replication is now always enabled, and the `physical_replication.enabled` cluster setting has been removed. [#119149][#119149]

<h3 id="v24-1-0-alpha-1-sql-language-changes">SQL language changes</h3>

- [`ALTER BACKUP SCHEDULE ... EXECUTE IMMEDIATELY`]({% link v23.2/alter-backup-schedule.md %}) can now be used to set the next scheduled execution of the backup schedule to the current time. [#112118][#112118]
- Fixed the [**SQL Activity**]({% link v23.2/ui-sql-dashboard.md %}) update job to avoid conflicts on update, reduced the amount of data cached to just what the overview page requires, and fixed the correctess of the top queries. [#112350][#112350]
- Previously, user-defined composite types were not populated in two `pg_catalog` tables: `pg_class` (whose row entries pertain to the type) and `pg_attribute` (whose row entries pertain to the "columns" of the type). This PostgreSQL-incompatible behavior is now fixed by populating the tables with user-defined composite types. In addition, the `typrelid` column in the `pg_type` table has the proper `oid` for composite types. [#111179][#111179]
- The newly added [built-in function]({% link v23.2/functions-and-operators.md %}#array-functions) `jsonb_array_to_string_array` no longer removes `NULL` objects. It now includes them in the resulting array. [#112975][#112975]
- Changed the display for RU estimates shown in [`EXPLAIN ANALYZE`]({% link v23.2/explain-analyze.md %}) from integer to float. This will prevent small estimates from being rounded to zero, which makes the estimate less confusing for cheap queries. [#111986][#111986]
- The `information_schema._pg_char_octet_length` [built-in function]({% link v23.2/functions-and-operators.md %}) is now supported, which improves compatibility with PostgreSQL. [#111401][#111401]
- The `pg_encoding_max_length` [built-in function]({% link v23.2/functions-and-operators.md %}) is now supported, which improves compatibility with PostgreSQL. [#111401][#111401]
- The `information_schema._pg_datetime_precision` [built-in function]({% link v23.2/functions-and-operators.md %}) is now supported, which improves compatibility with PostgreSQL. [#111401][#111401]
- The `information_schema._pg_interval_type` [built-in function]({% link v23.2/functions-and-operators.md %}) is now supported, which improves compatibility with PostgreSQL. [#111401][#111401]
- `information_schema.user_defined_types` is now populated with information about [user-defined types]({% link v23.2/create-type.md %}), and `information_schema.attributes` is now populated with information about the attributes of [composite data types]({% link v23.2/create-type.md %}#create-a-composite-data-type). [#111401][#111401]
- The [cost-based optimizer]({% link v23.2/cost-based-optimizer.md %}) will no longer generate a constrained scan that only uses filters from a [check]({% link v23.2/check.md %}) constraint. This prevents cases where a constrained scan actually scans the entire table because the constraints aren't selective. [#114332][#114332]
- Reads rolled back by savepoints are now refreshable, matching the PostgreSQL behavior and avoiding potential serializability violations. [#111424][#111424]
- Implemented the postgis `ST_TileEnvelope` [built-in function]({% link v23.2/functions-and-operators.md %}). [#112971][#112971]
- Added support for a third argument in the `array_position` [built-in function]({% link v23.2/functions-and-operators.md %}). If provided, it gives the index from which to begin searching in the array. [#112161][#112161]
- Added the `bit_count` [built-in function]({% link v23.2/functions-and-operators.md %}) for [`BIT`]({% link v23.2/bit.md %}) and [`BYTES`]({% link v23.2/bytes.md %}) types. [#115273][#115273]
- Added a `pg_backend_pid` column to `crdb_internal.node_sessions` and `crdb_internal.cluster_sessions`. This value corresponds to the numerical ID returned from `pg_backend_pid`. [#116673][#116673]
- Column type changes now require an explicit cast when automatic casting is not possible. This aligns with PostgreSQL's behavior. Previously, certain type conversions, such as [`BOOL`]({% link v23.2/bool.md %}) to [`INT`]({% link v23.2/int.md %}), were allowed without an explicit cast. [#115442][#115442]
- Added a new [session setting]({% link v23.2/session-variables.md %}), `optimizer_merge_joins_enabled` that, when true, instructs the [cost-based optimizer]({% link v23.2/cost-based-optimizer.md %}) to explore query plans with merge joins. The setting defaults to `true`. [#116410][#116410]
- CockroachDB now supports parsing queries like [`SELECT FROM t`]({% link v23.2/selection-queries.md %}) that only produce the row count and do not output any columns. [#116835][#116835]
- Added the `metaphone` [built-in function]({% link v23.2/functions-and-operators.md %}), which converts a string to its Metaphone code. [#110950][#110950]
- The new `EXPIRATION WINDOW` option for [`ALTER VIRTUAL CLUSTER`]({% link v23.2/alter-virtual-cluster.md %}) allows the user to override the default producer job expiration window of 24 hours. For example, `ALTER VIRTUAL CLUSTER appTenant SET REPLICATION EXPIRATION WINDOW ='100ms'`. The producer job expiration window determines how long the producer job stays alive without a heartbeat from the consumer job. [#117776][#117776]
- The [`SKIP LOCKED`]({% link v23.2/select-for-update.md %}#wait-policies) clause is now allowed with `SELECT ... FOR SHARE`. [#117560][#117560]
- Added configurable [cluster settings]({% link v23.2/cluster-settings.md %}) for total TCP keep alive probes (`server.sql_tcp_keep_alive.count`) and TCP probe intervals (`server.sql_tcp_keep_alive.interval`) for SQL connections. Removed the `COCKROACH_SQL_TCP_KEEP_ALIVE` environment variable subsuming it. [#115833][#115833]
- Removed the `sql.trace.session_eventlog.enabled` cluster setting and the associated event log tracing. The information in these traces is still available in the [`DEV` log channel]({% link v23.2/logging-overview.md %}#logging-channels) by enabling `--vmodule=conn_executor=2` with [`cockroach start`]({% link v23.2/cockroach-start.md %}). [#117928][#117928]
- The `array_agg` [aggregate function]({% link v23.2/functions-and-operators.md %}#aggregate-functions) can now support arrays as the input. Note that CockroachDB does not yet fully support nested arrays, and `array_agg` does not support nested arrays as inputs. [#117838][#117838]
- An execution statistic that measures "client time" is now included in `plan.txt` files of [statement diagnostics bundles]({% link v23.2/cockroach-statement-diag.md %}). Client time tracks how long the query execution was blocked on the client receiving the PGWire protocol messages. Note that when obtained via [`EXPLAIN ANALYZE (DEBUG)`]({% link v23.2/explain-analyze.md %}#debug-option), client time does not make sense because in this variant the output rows are discarded and not communicated to the client. [#117591][#117591]
- Added the `trace_id` column to the response of the [`SHOW SESSIONS`]({% link v23.2/show-sessions.md %}) command. [#118002][#118002]
- Added support for the `ENCODING` option of `COPY`, as long as the encoding of `'utf8'` is specified. [#118010][#118010]
- Added the `SHOW VARIABLES FOR ROLE` command, which allows the database administrator to easily view the default values for [session variables]({% link v23.2/session-variables.md %}) applied to a given user. [#117875][#117875]
- The `sql.txn.read_committed_isolation.enabled` [cluster setting]({% link v23.2/cluster-settings.md %}) is now `true` by default. This means that any syntax and settings that configure the [`READ COMMITTED`]({% link v23.2/read-committed.md %}) isolation level will now cause the transaction to use that isolation level, rather than automatically upgrading the transaction to `SERIALIZABLE`. [#118479][#118479]
- Added a new [cluster setting]({% link v23.2/cluster-settings.md %}), `sql.stats.virtual_computed_columns.enabled`, which when set enables collection of table statistics on [`VIRTUAL` computed columns]({% link v23.2/computed-columns.md %}). [#118241][#118241]
- Added the `autocommit_before_ddl` [session variable]({% link v23.2/session-variables.md %}). When set to `true`, any schema change statement that is sent during an explicit transaction will cause the transaction to commit before executing the schema change. [#118440][#118440]
- [`CREATE SEQUENCE`]({% link v23.2/create-sequence.md %}) is now enabled by default in the declarative schema changer. [#117793][#117793]
- [PL/pgSQL]({% link v23.2/plpgsql.md %}) now supports nested blocks, with the following limitations: variable shadowing is disallowed, and exception handlers cannot be used in a routine with nested blocks. [#117710][#117710]
- The [cluster setting]({% link v23.2/cluster-settings.md %}) `sql.index_recommendation.drop_unused_duration` is now public. [#118676][#118676]
- It is now possible to hint to the [cost-based optimizer]({% link v23.2/cost-based-optimizer.md %}) that it should plan a straight join by using the syntax `... INNER STRAIGHT JOIN ...`. If the hint is provided, the optimizer will now fix the join order as given in the query, even if it estimates that a different plan using join reordering would have a lower cost. [#116013][#116013]
- Add column `goroutine_id` to the response of the `SHOW SESSIONS` command. [#118644][#118644]
- Introduced a new [session setting]({% link v23.2/session-variables.md %}), `close_cursors_at_commit`, which causes a cursor to remain open even after its calling transaction commits. Note that transaction rollback still closes any cursor created in that transaction. [#117910][#117910]
- Added the `server.max_open_transactions_per_gateway` [cluster setting]({% link v23.2/cluster-settings.md %}). When set to a non-negative value, non-`admin` users cannot execute a query if the number of transactions open on the current gateway node is already at the configured limit. [#118781][#118781]
- Added the `setseed` [built-in function]({% link v23.2/functions-and-operators.md %}). It sets the seed for the random generator used by the `random` built-in function. [#119042][#119042]
- `OUT` and `INOUT` parameter classes are now supported in [user-defined functions]({% link v23.2/user-defined-functions.md %}). [#118610][#118610]
- Out-of-process SQL servers will now start exporting a new `sql.aggregated_livebytes` [metric]({% link v23.2/metrics.md %}). This metric gets updated once every 60 seconds by default, and its update interval can be configured via the `tenant_global_metrics_exporter_interval` [cluster setting]({% link v23.2/cluster-settings.md %}). [#119140][#119140]
- Added support for index hints with [`INSERT`]({% link v23.2/insert.md %}) and [`UPSERT`]({% link v23.2/upsert.md %}) statements. This allows `INSERT ... ON CONFLICT` and `UPSERT` queries to use index hints in the same way they are already supported for [`UPDATE`]({% link v23.2/update.md %}) and [`DELETE`]({% link v23.2/delete.md %}) statements. [#119104][#119104]
- Added a new [`ttl_disable_changefeed_replication`]({% link v24.1/row-level-ttl.md %}#filter-changefeeds-for-tables-using-row-level-ttl) table storage parameter that can be used to disable changefeed replication for [row-level TTL]({% link v23.2/row-level-ttl.md %}) on a per-table basis. [#119611][#119611]

<h3 id="v24-1-0-alpha-1-operational-changes">Operational changes</h3>

- The internal versions that are reported during [cluster upgrades]({% link v23.2/upgrade-cockroach-version.md %}) have been renamed for clarity. For example, `23.2-8` is now named `23.2-upgrading-to-24.1-step-008`. [#115223][#115223]
- Introduced a new cluster setting, `server.jwt_authentication.jwks_auto_fetch.enabled`, enabling automatic fetching of [JSON Web Key Sets (JWKS)]({% link v23.2/sso-sql.md %}) from an issuer's remote endpoint. This prevents an administrator's need to update the JWKS specified in `server.jwt_authentication.jwks` - whether manually or by custom script - when the identity provider's keys rotate. That direct specification of JWKS remains the default, as the new cluster setting defaults to `false`. [#117054][#117054]
- Updated the error message logged in the case of stalled disks to use the appropriate term "disk stall", matching the term used in metrics and dashboards. This was previously "file write stall". [#114746][#114746]
- Introduced the `changefeed.emitted_batch_sizes` histogram metric that measures the batch sizes used when emitting data to [sinks]({% link v23.2/changefeed-sinks.md %}). This metric supports [metrics labels]({% link v23.2/monitor-and-debug-changefeeds.md %}#using-changefeed-metrics-labels). [#115537][#115537]
- Introduced metrics `log_fluent_sink_conn_attempts`, `log_fluent_sink_write_attempts`, and `log_fluent_sink_write_errors` to enable more precise tracking of connection and write operations when [logging to Fluentd-compatible network collectors]({% link v23.2/configure-logs.md %}#output-to-fluentd-compatible-network-collectors). [#116699][#116699]
- The [cluster setting]({% link v23.2/cluster-settings.md %}) `sql.contention.record_serialization_conflicts.enabled` is now `on` by default. This means any [`40001` errors]({% link v23.2/transaction-retry-error-reference.md %}) that are returned containing conflicting transaction information will be recorded by the contention registry. [#116664][#116664]
- Removed the `kv.rangefeed.scheduler.enabled` [cluster setting]({% link v23.2/cluster-settings.md %}) because the [rangefeed]({% link v23.2/create-and-configure-changefeeds.md %}#enable-rangefeeds) scheduler is now unconditionally enabled. [#114410][#114410]
- Removed the `kv.rangefeed.catchup_scan_concurrency` [cluster setting]({% link v23.2/cluster-settings.md %}). Catchup scans are throttled via [`kv.rangefeed.concurrent_catchup_iterators`]({% link v23.2/advanced-changefeed-configuration.md %}) on a per-node basis. [#114408][#114408]
- Removed the [`changefeed.mux_rangefeed.enabled`]({% link v23.2/advanced-changefeed-configuration.md %}#mux-rangefeeds) cluster setting because the functionality is enabled by default. [#114408][#114408]
- The gossip status [Advanced Debug page]({% link v23.2/ui-debug-pages.md %}) now includes information about the server's high water timestamps for every other node it knows about in the gossip cluster. [#117011][#117011]
- Removed the `cockroach_rangefeed_rpc_initial_window_size` environment variable. The rangefeed connection now uses the same window size as other RPC connections. [#117545][#117545]
- [Events]({% link v23.2/eventlog.md %}#miscellaneous-sql-events) for [cluster setting]({% link v23.2/cluster-settings.md %}) changes are now emitted to the `OPS` channel rather than the `DEV` channel. [#117923][#117923]
- The new environment variable `cockroach_rpc_use_default_connection_class` enables operators to switch back to the prior default behavior of sending most network/RPC workloads, except system traffic, through a single RPC/TCP connection, in case the environment does not tolerate multiple TCP connections. v24.1 defaults to using multiple connections, each dedicated to a particular types of traffic, specifically for [Raft]({% link v23.2/architecture/replication-layer.md %}#raft) or [rangefeed]({% link v23.2/change-data-capture-overview.md %}) data. For more information, see additional release notes that reference this variable name. [#117810][#117810]
- In unredacted [debug zips]({% link v23.2/cockroach-debug-zip.md %}), the `crdb_internal.transaction_contention_events` table file has two new columns:
    - `waiting_stmt_query`: the query of the waiting statement.
    - `blocking_txn_queries_unordered`: the unordered list of the blocking transaction's queries. [#118478][#118478]
- Transaction replay protection state is now passed between the outgoing and incoming [leaseholder]({% link v23.2/architecture/replication-layer.md %}#leases) for a range during a [lease transfer]({% link v23.2/architecture/replication-layer.md %}#epoch-based-leases-table-data). This avoids cases where lease transfers can cause transactions to throw `TransactionAbortedError(ABORT_REASON_NEW_LEASE_PREVENTS_TXN)` errors. [#118300][#118300]
- CockroachDB will now automatically generate [CPU profiles]({% link v23.2/automatic-cpu-profiler.md %}) if there is an increase in CPU utilization. This can help inform investigations into possible issues. [#118850][#118850]
- Expanded the [`--include-range-info`]({% link v23.2/cockroach-debug-zip.md %}) flag to include problem ranges. This flag still defaults to `true`. [#119205][#119205]

<h3 id="v24-1-0-alpha-1-command-line-changes">Command-line changes</h3>

- [Debug zips]({% link v23.2/cockroach-debug-zip.md %}) no longer include redundant `hex_` columns for system table `BYTES` columns. [#112033][#112033]
- Added the `--follower-read-percent` flag, which determines the percent (0-100) of read operations that are follower reads, to the [`cockroach workload kv run`]({% link v23.2/cockroach-workload.md %}) command. [#113094][#113094]
- The workload `schemachange` now writes a `.otlp.ndjson.gz` archive containing OTLP trace bundles for debugging purposes. [#114770][#114770]
- [`cockroach debug tsdump`]({% link v23.2/cockroach-debug-tsdump.md %}) creates a `tsdump.yaml` file. The `tsdump` raw format automatically creates the YAML file in the default location `/tmp/tsdump.yaml`. Added a new flag `--yaml` that allows users to specify the path to create `tsdump.yaml` instead of using the default location. For example, `cockroach debug tsdump --host <host>:<port> \ --format raw --yaml=/some_path/tsdump.yaml > /some_path/tsdump.gob`. [#114046][#114046]
- Removed the `cockroach connect` command functionality. This was [deprecated]({% link releases/v23.2.md %}#v23-2-0-deprecations) in CockroachDB v23.2. [#113893][#113893]
- Changed the SQL shell help URL to point to [`cockroach-sql`]({% link v23.2/cockroach-sql-binary.md %}). [#118960][#118960]
- Added a new `encode-uri` utility to make generating connection strings for use with [Physical Cluster Replication]({% link v23.2/physical-cluster-replication-overview.md %}) easier. [#119528][#119528]

<h3 id="v24-1-0-alpha-1-db-console-changes">DB Console changes</h3>

- Store initialization now logs progress every 10 seconds showing the current and total number of [replicas]({% link v23.2/architecture/replication-layer.md %}) initialized. [#115760][#115760]
- Introduced a new **Lease Preferences** graph on the [Replication dashboard]({% link v23.2/ui-replication-dashboard.md %}). The **Lease Preferences** graph will indicate when the current [leaseholder]({% link v23.2/architecture/replication-layer.md %}#leases) is not the first lease preference and where the current leaseholder satisfies no applied lease preference. [#116709][#116709]
- Updated the [Statement Details page]({% link v23.2/ui-statements-page.md %}) to always show the entire selected period, instead of just the period that had data. [#118680][#118680]
- Error messages displayed upon failure to load DB Console views now include information about the HTTP response status code, if one is present. [#118782][#118782]
- The **Full Table/Index Scans** chart in the [SQL Metrics dashboard]({% link v23.2/ui-sql-dashboard.md %}) now shows the non-negative derivative of the number of full scans tracked. [#118787][#118787]
- The [Overload dashboard]({% link v23.2/ui-overload-dashboard.md %}) now includes two additional graphs:
    - **Elastic CPU Utilization**: displays the CPU utilization by elastic work, compared to the limit set for elastic work.
    - **Elastic CPU Exhausted Duration Per Second**: displays the duration of CPU exhaustion by elastic work, in microseconds. [#118763][#118763]
- The `txn.restarts.writetooold` metric in the **Transaction Restarts** graph under the [SQL Dashboard]({% link v23.2/ui-sql-dashboard.md %}) now includes all restarts previously categorized as `txn.restarts.writetoooldmulti`. The former is a now a superset of the latter. The `txn.restarts.writetoooldmulti` metric will be removed in a future release. [#119411][#119411]

<h3 id="v24-1-0-alpha-1-bug-fixes">Bug fixes</h3>

- Fixed a bug that could cause an internal error during distributed execution for an expression like `CASE` that requires its inputs to be the same type with all `NULL` inputs. [#108892][#108892]
- Fixed `NULL` input handling for the geospatial [built-ins]({% link v23.2/functions-and-operators.md %}) `st_pointfromgeohash` and `st_geomfromgeohash`. [#113781][#113781]
- The geospatial `st_makeenvelope` [built-in]({% link v23.2/functions-and-operators.md %}) now correctly supports `xmin` or `ymin` to be greater than `xmax` or `ymax`, respectively. [#113781][#113781]
- Fixed a bug that could cause v23.1 nodes in clusters that had not [finalized the v23.1 version upgrade]({% link v23.2/upgrade-cockroach-version.md %}#step-3-decide-how-the-upgrade-will-be-finalized) to use excessive CPU retrying expected errors related to the incomplete upgrade state. [#113864][#113864]
- [Debug zip]({% link v23.2/cockroach-debug-zip.md %}) now does not fail on corrupted log files. [#113722][#113722]
- Placeholder arguments can now be used in [`SET TRANSACTION`]({% link v23.2/set-transaction.md %}) statements. [#113689][#113689]
- Previously, when the session variable `use_declarative_schema_changer` was set to `off`, [`ALTER PRIMARY KEY`]({% link v23.2/alter-table.md %}#alter-primary-key) would delete any comments associated with the old primary index and old primary key constraint. This is inconsistent with the behavior of `use_declarative_schema_changer=on`, which is the default setting, where those comments would be carried over to the new primary index. Furthermore, the old behavior also caused a bug that could prevent command `SHOW CREATE t` from working. [#114354][#114354]
- Previously, when the session variable was set to `use_declarative_schema_changer=off` and there was an attempt to [`ALTER PRIMARY KEY`]({% link v23.2/alter-table.md %}#alter-primary-key) on a table that has unique secondary indexes on new primary key columns, the unique secondary index would still incorrectly have old primary key columns as its `keySuffixColumn` after the `ALTER PRIMARY KEY`. This was problematic because a subsequent dropping of the old primary key columns would unexpectedly drop those unique secondary indexes as well, even without `CASCADE`. [#114622][#114622]
- [`ALTER BACKUP SCHEDULE`]({% link v23.2/alter-backup-schedule.md %}) can now be used to set `updates_cluster_last_backup_time_metric` without providing an explicit value, matching the behavior of the option when specified during [`CREATE SCHEDULE FOR BACKUP`]({% link v23.2/create-schedule-for-backup.md %}). [#113523][#113523]
- Previously, if a table had [secondary indexes]({% link v23.2/schema-design-indexes.md %}) that stored certain columns (`col`) using the [`STORING`]({% link v23.2/indexes.md %}#storing-columns) clause, followed by an [`ALTER PRIMARY KEY`]({% link v23.2/alter-table.md %}#alter-primary-key) to `col`, an incorrect secondary index would persist. The secondary index would continue to have the `STORING` clause, despite the column being part of the primary key and the fact that CockroachDB does not permit secondary indexes to store any primary key columns. Now, after the `ALTER PRIMARY KEY`, the `STORING` clause is dropped on those secondary indexes. [#115214][#115214]
- Fixed a bug that caused uploads to [object-locked buckets]({% link v23.2/use-cloud-storage.md %}) to fail because of the absence of an `MD5` hash. [#115713][#115713]
- [`ALTER PRIMARY KEY`]({% link v23.2/alter-table.md %}#alter-primary-key) now preserves the name of the original primary index when the session variable is `use_declarative_schema_changer=off`. [#115338][#115338]
- Fixed a bug where the [`unique-without-index-not-valid` constraint]({% link v23.2/unique.md %}) added to a table would cause the `create_statement` from `SHOW CREATE t` to not be executable and error with `unique constraint cannot be NOT VALID`. [#115354][#115354]
- Fixed a bug where an empty [full backup]({% link v23.2/take-full-and-incremental-backups.md %}) followed by non-empty incremental backups taken inside an application tenant might not allow a [restore]({% link v23.2/restore.md %}) due to the use of an incorrect SQL codec. [#116316][#116316]
- Fixed a bug in the [row-level TTL]({% link v23.2/row-level-ttl.md %}) job that would cause it to skip expired rows if the primary key of the table included columns of the collated `STRING` or `DECIMAL` type. [#116988][#116988]
- Incorrectly labeled [PL/pgSQL]({% link v23.2/plpgsql.md %}) blocks now return an expected syntax error. [#117608][#117608]
- [`CREATE EXTERNAL CONNECTION IF NOT EXISTS`]({% link v23.2/create-external-connection.md %}) no longer returns an error if the connection already exists. [#117312][#117312]
- CockroachDB now correctly uses the histograms on columns of collated [`STRING`]({% link v23.2/string.md %}) type. The bug has been present since before v22.1. [#117714][#117714]
- Improved an interaction during range [lease transfers]({% link v23.2/architecture/replication-layer.md %}#epoch-based-leases-table-data) that could cause `RETRY_ASYNC_WRITE_FAILURE` errors to be returned to clients. [#117840][#117840]
- Backfilling tables for [`CREATE TABLE AS`]({% link v23.2/create-table-as.md %}) or [`CREATE MATERIALIZED VIEW`]({% link v23.2/create-view.md %}) could get into a retry loop if data was deleted and those jobs took longer than the GC TTL. [#117877][#117877]
- [Decommissioning replicas]({% link v23.2/node-shutdown.md %}) that are part of a mis-replicated range will no longer get stuck on a rebalance operation that was falsely determined to be unsafe. [#117900][#117900]
- A memory leak within the insights system was found to occur when [`sql.metrics.transaction_details.enabled`]({% link v23.2/cluster-settings.md %}) was disabled, while leaving `sql.metrics.statement_details.enabled` enabled. This patch fixes the memory leak by preventing the collection of further statement and transaction insights when `sql.metrics.transaction_details.enabled` is disabled. [#117709][#117709]
- Fixed a rare panic that could happen during a `pg_dump` import that contains a function that has a subquery in one of its arguments, like `SELECT addgeometrycolumn(...)`. Now, attempting to import a `pg_dump` with such a function results in an expected error. [#118569][#118569]
- [`AUTO CREATE STATS`]({% link v23.2/show-jobs.md %}#show-automatic-jobs) jobs could previously lead to growth in an internal system table resulting in slower job-system related queries. [#118589][#118589]
- Fixed an issue in CockroachDB where, if operating on a Linux system outside of a CPU cgroup, the system would repeatedly log the error `unable to get CPU capacity` at 10-second intervals. [#118657][#118657]
- Fixed a bug where casts of [floats]({% link v23.2/float.md %}) to [integers]({% link v23.2/int.md %}) simply truncated the decimal portion. These casts now match the PostgreSQL behavior of rounding to the nearest integer, and in cases of a value halfway between two integers, rounding to the nearest even number. This aligns with the "round half to even" rule or "bankers' rounding", offering greater overall precision across a group of such cast operations. [#117798][#117798]
- Fixed a bug where statements like `ADD COLUMN j INT, ADD UNIQUE WITHOUT INDEX (j)`, which [add new columns]({% link v23.2/alter-table.md %}#add-column) with unique constraints without creating associated indexes, would fail with an internal error. [#118291][#118291]
- Previously, [altering]({% link v23.2/alter-table.md %}) from a [`REGIONAL BY ROW`]({% link v23.2/regional-tables.md %}#regional-by-row-tables) table to a [`REGIONAL BY TABLE`]({% link v23.2/regional-tables.md %}#regional-tables) table could cause leaseholders to never move to the database's primary region. This is now fixed. [#118001][#118001]
- Users with the [VIEWACTIVITY]({% link v23.2/security-reference/authorization.md %}#supported-privileges) privilege can now request statement bundles using `crdb_internal.request_statement_bundle` or through the DB Console [SQL Activity]({% link v23.2/security-reference/authorization.md %}#supported-privileges) page. [#118760][#118760]
- Fixed an internal error with a message like: `LeafTxn ... incompatible with locking request` that occurs when performing an update under [`READ COMMITTED` isolation]({% link v23.2/read-committed.md %}) which cascades to a table with multiple other foreign keys. [#118722][#118722]
- Fixed a bug where [`ALTER PRIMARY KEY`]({% link v23.2/alter-table.md %}#alter-primary-key) could fail with an error `non-nullable column <x> with no value! Index scanned ..` when validating recreated [secondary indexes]({% link v23.2/schema-design-indexes.md %}). [#118843][#118843]
- Fixed a bug where a sequence name allocated by [`SERIAL`]({% link v23.2/serial.md %}) that conflicted with an existing type name would cause an error. [#118861][#118861]
- Fixed a bug where [`COMMENT ON`]({% link v23.2/comment-on.md %}) statements could fail with an "unexpected value" error if multiple `COMMENT` statements were running concurrently. [#119007][#119007]
- Previously, in certain cases, using virtual tables such as `crdb_internal.system_jobs` could result in the internal error `attempting to append refresh spans after the tracked timestamp has moved forward`. This is now fixed. The bug was introduced in CockroachDB v23.1. [#119176][#119176]
- Fixed a bug where operations on the `crdb_internal.leases` table could cause a node to become unavailable due to a deadlock in the leasing subsystem. [#119305][#119305]
- If an individual [replica]({% link v23.2/architecture/replication-layer.md %})'s circuit breaker had tripped but the range was otherwise functional, for example, because the replica was partially partitioned away from the [leaseholder]({% link v23.2/architecture/replication-layer.md %}#leases), it was possible for a gateway to persistently error when contacting this replica instead of retrying against a functional leaseholder elsewhere. The [gateway]({% link v23.2/architecture/life-of-a-distributed-transaction.md %}#gateway) will now retry such errors against other replicas once. [#118737][#118737]
- Fixed a bug in changefeed [webhook sinks]({% link v23.2/changefeed-sinks.md %}#webhook-sink) where the HTTP request body may not be initialized on retries, resulting in the error `http: ContentLength=... with Body length 0`. [#119326][#119326]
- Fixed a bug where rangefeed resolved timestamps could get stuck, continually emitting the log message `pushing old intents failed: range barrier failed, range split`, typically following a [range merge]({% link v23.2/architecture/distribution-layer.md %}#range-merges). [#119512][#119512]
- Fixed a condition where some files were not closed  when inspecting backup metadata during BACKUP and RESTORE. Epic: none. [#119625][#119625]
- Fixed a bug where some backup metadata files opened during [`RESTORE`]({% link v23.2/restore.md %}) were not closed. [#119625][#119625]
- Fixed a bug that caused internal errors when executing an [`EXPORT`]({% link v23.2/export.md %}) statement where the query involved sorting by columns not explicitly included in the output, due to hidden columns in the input expression. [#119538][#119538]
- Fixed a bug where a warning about the need to refresh data would remain displayed on the Active Executions view of the [Statements]({% link v23.2/ui-statements-page.md %}#active-executions-view) and [Transactions]({% link v23.2/ui-transactions-page.md %}#active-executions-view) pages despite enabling **Auto Refresh**. [#118675][#118675]

<h3 id="v24-1-0-alpha-1-performance-improvements">Performance improvements</h3>

- [Follower reads]({% link v23.2/follower-reads.md %}) for multi-region tables now default to prioritizing replicas in the same [locality]({% link v23.2/table-localities.md %}), when available, with node latency as a tie breaker. Previously, latency was the primary criteria. This can improve the performance and predictability of follower reads. [#112993][#112993]
- During node startup, stores are now loaded in parallel by default, reducing start times for nodes with many stores. [#115285][#115285]
- Improved the efficiency and performance of [encryption at rest]({% link v23.2/security-reference/encryption.md %}#encryption-at-rest). [#115454][#115454]
- Rangefeeds, the infrastructure used for [changefeeds]({% link v23.2/change-data-capture-overview.md %}), now use a more efficient engine that reduces the number of goroutines and the associated Go scheduler pressure and latency. [#114410][#114410]
- Rangefeeds, the infrastructure used for [changefeeds]({% link v23.2/change-data-capture-overview.md %}), now use a more efficient multiplexing protocol. [#114408][#114408]
- The [cost-based optimizer]({% link v23.2/cost-based-optimizer.md %}) now generates constrained scans on indexes containing boolean, computed expressions. [#114798][#114798]
- A separate RPC connection class is now used for most [Raft]({% link v23.2/architecture/replication-layer.md %}#raft) traffic. This improves isolation and reduces interference with foreground SQL traffic, which reduces chances of head-of-line blocking caused by unrelated traffic under high-load conditions. The new `COCKROACH_RAFT_USE_DEFAULT_CONNECTION_CLASS` environment variable can be set to use the default connection class instead (the previous behavior). [#117385][#117385]
- Rangefeed traffic (typically for [changefeeds]({% link v23.2/change-data-capture-overview.md %})) is now separated into its own RPC connection class. This improves isolation and reduces interference with the foreground SQL traffic, which reduces chances of head-of-line blocking caused by unrelated traffic. The new `COCKROACH_RANGEFEED_USE_DEFAULT_CONNECTION_CLASS` environment variable can be set to use the default connection class, the previous default choice for rangefeeds. [#117730][#117730]
- The initial scan traffic for [changefeeds]({% link v23.2/change-data-capture-overview.md %}#stream-row-level-changes-with-changefeeds), which can be significant, now uses a different RPC/TCP connection than the foreground SQL/KV traffic. This reduces interference between workloads, and reduces chances of head-of-line blocking issues. [#117810][#117810]
- [`kafka_sink_config`]({% link v23.2/changefeed-sinks.md %}#kafka-sink-configuration) now supports specifying different client IDs for each changefeed, enabling users to define distinct Kafka quota configurations for each. For example, `CREATE CHANGEFEED FOR ... WITH kafka_sink_config='{"ClientID": "clientID1"}'` [#118643][#118643]
- Added the `changefeed.kafka_throttling_hist_nanos` metric, enhancing visibility into throttling times when CockroachDB operations exceed Kafka's quota limits. [#117693][#117693]
- The [cost-based optimizer]({% link v23.2/cost-based-optimizer.md %}) now generates more efficient query plans for queries with comparisons of [timestamp]({% link v23.2/timestamp.md %}) and [interval]({% link v23.2/interval.md %}) columns, for example, `timestamp_col - '1 day'::INTERVAL > now()`. [#118307][#118307]
- Statements from internal executors (use of SQL queries by the cluster itself) now correctly display when filtering by application name `$ internal` on the Statements page in [SQL Activity]({% link v23.2/ui-overview.md %}#sql-activity). Such statements are hidden when `$ internal` is not specified. [#114498][#114498]

<div class="release-note-contributors" markdown="1">

<h3 id="v24-1-0-alpha-1-contributors">Contributors</h3>

This release includes 1851 merged PRs by 108 authors.
We would like to thank the following contributors from the CockroachDB community:

- Andrew Delph (first-time contributor)
- ChanYe East (first-time contributor)
- Charles (first-time contributor)
- Eric.Yang
- Harshit Vishwakarma (first-time contributor)
- HighPon
- Jasmine Sun (first-time contributor)
- Joshua Hildred (first-time contributor)
- Kevin Mingtarja (first-time contributor)
- Luis Pessoa (first-time contributor)
- Nikolai Vladimirov (first-time contributor)
- chavacava (first-time contributor)
- craig
- cty123
- da-ket (first-time contributor)
- lyang24 (first-time contributor)
- zach.graves (first-time contributor)
- zyf123123 (first-time contributor)

</div>

[#108892]: https://github.com/cockroachdb/cockroach/pull/108892
[#110950]: https://github.com/cockroachdb/cockroach/pull/110950
[#111179]: https://github.com/cockroachdb/cockroach/pull/111179
[#111401]: https://github.com/cockroachdb/cockroach/pull/111401
[#111424]: https://github.com/cockroachdb/cockroach/pull/111424
[#111895]: https://github.com/cockroachdb/cockroach/pull/111895
[#111986]: https://github.com/cockroachdb/cockroach/pull/111986
[#112033]: https://github.com/cockroachdb/cockroach/pull/112033
[#112118]: https://github.com/cockroachdb/cockroach/pull/112118
[#112161]: https://github.com/cockroachdb/cockroach/pull/112161
[#112162]: https://github.com/cockroachdb/cockroach/pull/112162
[#112203]: https://github.com/cockroachdb/cockroach/pull/112203
[#112350]: https://github.com/cockroachdb/cockroach/pull/112350
[#112357]: https://github.com/cockroachdb/cockroach/pull/112357
[#112971]: https://github.com/cockroachdb/cockroach/pull/112971
[#112975]: https://github.com/cockroachdb/cockroach/pull/112975
[#112993]: https://github.com/cockroachdb/cockroach/pull/112993
[#113094]: https://github.com/cockroachdb/cockroach/pull/113094
[#113149]: https://github.com/cockroachdb/cockroach/pull/113149
[#113523]: https://github.com/cockroachdb/cockroach/pull/113523
[#113599]: https://github.com/cockroachdb/cockroach/pull/113599
[#113679]: https://github.com/cockroachdb/cockroach/pull/113679
[#113689]: https://github.com/cockroachdb/cockroach/pull/113689
[#113722]: https://github.com/cockroachdb/cockroach/pull/113722
[#113741]: https://github.com/cockroachdb/cockroach/pull/113741
[#113781]: https://github.com/cockroachdb/cockroach/pull/113781
[#113860]: https://github.com/cockroachdb/cockroach/pull/113860
[#113864]: https://github.com/cockroachdb/cockroach/pull/113864
[#113893]: https://github.com/cockroachdb/cockroach/pull/113893
[#113993]: https://github.com/cockroachdb/cockroach/pull/113993
[#114046]: https://github.com/cockroachdb/cockroach/pull/114046
[#114097]: https://github.com/cockroachdb/cockroach/pull/114097
[#114148]: https://github.com/cockroachdb/cockroach/pull/114148
[#114186]: https://github.com/cockroachdb/cockroach/pull/114186
[#114305]: https://github.com/cockroachdb/cockroach/pull/114305
[#114332]: https://github.com/cockroachdb/cockroach/pull/114332
[#114354]: https://github.com/cockroachdb/cockroach/pull/114354
[#114408]: https://github.com/cockroachdb/cockroach/pull/114408
[#114410]: https://github.com/cockroachdb/cockroach/pull/114410
[#114454]: https://github.com/cockroachdb/cockroach/pull/114454
[#114498]: https://github.com/cockroachdb/cockroach/pull/114498
[#114599]: https://github.com/cockroachdb/cockroach/pull/114599
[#114622]: https://github.com/cockroachdb/cockroach/pull/114622
[#114736]: https://github.com/cockroachdb/cockroach/pull/114736
[#114746]: https://github.com/cockroachdb/cockroach/pull/114746
[#114770]: https://github.com/cockroachdb/cockroach/pull/114770
[#114798]: https://github.com/cockroachdb/cockroach/pull/114798
[#114863]: https://github.com/cockroachdb/cockroach/pull/114863
[#114876]: https://github.com/cockroachdb/cockroach/pull/114876
[#114973]: https://github.com/cockroachdb/cockroach/pull/114973
[#115048]: https://github.com/cockroachdb/cockroach/pull/115048
[#115166]: https://github.com/cockroachdb/cockroach/pull/115166
[#115169]: https://github.com/cockroachdb/cockroach/pull/115169
[#115214]: https://github.com/cockroachdb/cockroach/pull/115214
[#115223]: https://github.com/cockroachdb/cockroach/pull/115223
[#115273]: https://github.com/cockroachdb/cockroach/pull/115273
[#115285]: https://github.com/cockroachdb/cockroach/pull/115285
[#115338]: https://github.com/cockroachdb/cockroach/pull/115338
[#115354]: https://github.com/cockroachdb/cockroach/pull/115354
[#115442]: https://github.com/cockroachdb/cockroach/pull/115442
[#115454]: https://github.com/cockroachdb/cockroach/pull/115454
[#115473]: https://github.com/cockroachdb/cockroach/pull/115473
[#115511]: https://github.com/cockroachdb/cockroach/pull/115511
[#115537]: https://github.com/cockroachdb/cockroach/pull/115537
[#115713]: https://github.com/cockroachdb/cockroach/pull/115713
[#115722]: https://github.com/cockroachdb/cockroach/pull/115722
[#115733]: https://github.com/cockroachdb/cockroach/pull/115733
[#115760]: https://github.com/cockroachdb/cockroach/pull/115760
[#115833]: https://github.com/cockroachdb/cockroach/pull/115833
[#116013]: https://github.com/cockroachdb/cockroach/pull/116013
[#116213]: https://github.com/cockroachdb/cockroach/pull/116213
[#116316]: https://github.com/cockroachdb/cockroach/pull/116316
[#116410]: https://github.com/cockroachdb/cockroach/pull/116410
[#116474]: https://github.com/cockroachdb/cockroach/pull/116474
[#116498]: https://github.com/cockroachdb/cockroach/pull/116498
[#116520]: https://github.com/cockroachdb/cockroach/pull/116520
[#116664]: https://github.com/cockroachdb/cockroach/pull/116664
[#116673]: https://github.com/cockroachdb/cockroach/pull/116673
[#116699]: https://github.com/cockroachdb/cockroach/pull/116699
[#116709]: https://github.com/cockroachdb/cockroach/pull/116709
[#116778]: https://github.com/cockroachdb/cockroach/pull/116778
[#116783]: https://github.com/cockroachdb/cockroach/pull/116783
[#116830]: https://github.com/cockroachdb/cockroach/pull/116830
[#116835]: https://github.com/cockroachdb/cockroach/pull/116835
[#116879]: https://github.com/cockroachdb/cockroach/pull/116879
[#116988]: https://github.com/cockroachdb/cockroach/pull/116988
[#117011]: https://github.com/cockroachdb/cockroach/pull/117011
[#117054]: https://github.com/cockroachdb/cockroach/pull/117054
[#117095]: https://github.com/cockroachdb/cockroach/pull/117095
[#117117]: https://github.com/cockroachdb/cockroach/pull/117117
[#117191]: https://github.com/cockroachdb/cockroach/pull/117191
[#117312]: https://github.com/cockroachdb/cockroach/pull/117312
[#117357]: https://github.com/cockroachdb/cockroach/pull/117357
[#117385]: https://github.com/cockroachdb/cockroach/pull/117385
[#117429]: https://github.com/cockroachdb/cockroach/pull/117429
[#117520]: https://github.com/cockroachdb/cockroach/pull/117520
[#117545]: https://github.com/cockroachdb/cockroach/pull/117545
[#117554]: https://github.com/cockroachdb/cockroach/pull/117554
[#117560]: https://github.com/cockroachdb/cockroach/pull/117560
[#117591]: https://github.com/cockroachdb/cockroach/pull/117591
[#117608]: https://github.com/cockroachdb/cockroach/pull/117608
[#117636]: https://github.com/cockroachdb/cockroach/pull/117636
[#117656]: https://github.com/cockroachdb/cockroach/pull/117656
[#117693]: https://github.com/cockroachdb/cockroach/pull/117693
[#117709]: https://github.com/cockroachdb/cockroach/pull/117709
[#117710]: https://github.com/cockroachdb/cockroach/pull/117710
[#117714]: https://github.com/cockroachdb/cockroach/pull/117714
[#117730]: https://github.com/cockroachdb/cockroach/pull/117730
[#117776]: https://github.com/cockroachdb/cockroach/pull/117776
[#117793]: https://github.com/cockroachdb/cockroach/pull/117793
[#117798]: https://github.com/cockroachdb/cockroach/pull/117798
[#117810]: https://github.com/cockroachdb/cockroach/pull/117810
[#117838]: https://github.com/cockroachdb/cockroach/pull/117838
[#117840]: https://github.com/cockroachdb/cockroach/pull/117840
[#117875]: https://github.com/cockroachdb/cockroach/pull/117875
[#117877]: https://github.com/cockroachdb/cockroach/pull/117877
[#117900]: https://github.com/cockroachdb/cockroach/pull/117900
[#117910]: https://github.com/cockroachdb/cockroach/pull/117910
[#117923]: https://github.com/cockroachdb/cockroach/pull/117923
[#117928]: https://github.com/cockroachdb/cockroach/pull/117928
[#117936]: https://github.com/cockroachdb/cockroach/pull/117936
[#117937]: https://github.com/cockroachdb/cockroach/pull/117937
[#118001]: https://github.com/cockroachdb/cockroach/pull/118001
[#118002]: https://github.com/cockroachdb/cockroach/pull/118002
[#118010]: https://github.com/cockroachdb/cockroach/pull/118010
[#118241]: https://github.com/cockroachdb/cockroach/pull/118241
[#118255]: https://github.com/cockroachdb/cockroach/pull/118255
[#118291]: https://github.com/cockroachdb/cockroach/pull/118291
[#118300]: https://github.com/cockroachdb/cockroach/pull/118300
[#118307]: https://github.com/cockroachdb/cockroach/pull/118307
[#118440]: https://github.com/cockroachdb/cockroach/pull/118440
[#118476]: https://github.com/cockroachdb/cockroach/pull/118476
[#118478]: https://github.com/cockroachdb/cockroach/pull/118478
[#118479]: https://github.com/cockroachdb/cockroach/pull/118479
[#118502]: https://github.com/cockroachdb/cockroach/pull/118502
[#118569]: https://github.com/cockroachdb/cockroach/pull/118569
[#118583]: https://github.com/cockroachdb/cockroach/pull/118583
[#118589]: https://github.com/cockroachdb/cockroach/pull/118589
[#118610]: https://github.com/cockroachdb/cockroach/pull/118610
[#118643]: https://github.com/cockroachdb/cockroach/pull/118643
[#118644]: https://github.com/cockroachdb/cockroach/pull/118644
[#118657]: https://github.com/cockroachdb/cockroach/pull/118657
[#118675]: https://github.com/cockroachdb/cockroach/pull/118675
[#118676]: https://github.com/cockroachdb/cockroach/pull/118676
[#118680]: https://github.com/cockroachdb/cockroach/pull/118680
[#118722]: https://github.com/cockroachdb/cockroach/pull/118722
[#118737]: https://github.com/cockroachdb/cockroach/pull/118737
[#118760]: https://github.com/cockroachdb/cockroach/pull/118760
[#118763]: https://github.com/cockroachdb/cockroach/pull/118763
[#118781]: https://github.com/cockroachdb/cockroach/pull/118781
[#118782]: https://github.com/cockroachdb/cockroach/pull/118782
[#118787]: https://github.com/cockroachdb/cockroach/pull/118787
[#118843]: https://github.com/cockroachdb/cockroach/pull/118843
[#118850]: https://github.com/cockroachdb/cockroach/pull/118850
[#118861]: https://github.com/cockroachdb/cockroach/pull/118861
[#118960]: https://github.com/cockroachdb/cockroach/pull/118960
[#119007]: https://github.com/cockroachdb/cockroach/pull/119007
[#119042]: https://github.com/cockroachdb/cockroach/pull/119042
[#119104]: https://github.com/cockroachdb/cockroach/pull/119104
[#119140]: https://github.com/cockroachdb/cockroach/pull/119140
[#119149]: https://github.com/cockroachdb/cockroach/pull/119149
[#119176]: https://github.com/cockroachdb/cockroach/pull/119176
[#119205]: https://github.com/cockroachdb/cockroach/pull/119205
[#119221]: https://github.com/cockroachdb/cockroach/pull/119221
[#119250]: https://github.com/cockroachdb/cockroach/pull/119250
[#119251]: https://github.com/cockroachdb/cockroach/pull/119251
[#119305]: https://github.com/cockroachdb/cockroach/pull/119305
[#119323]: https://github.com/cockroachdb/cockroach/pull/119323
[#119326]: https://github.com/cockroachdb/cockroach/pull/119326
[#119366]: https://github.com/cockroachdb/cockroach/pull/119366
[#119411]: https://github.com/cockroachdb/cockroach/pull/119411
[#119512]: https://github.com/cockroachdb/cockroach/pull/119512
[#119528]: https://github.com/cockroachdb/cockroach/pull/119528
[#119538]: https://github.com/cockroachdb/cockroach/pull/119538
[#119611]: https://github.com/cockroachdb/cockroach/pull/119611
[#119625]: https://github.com/cockroachdb/cockroach/pull/119625
[05049deba]: https://github.com/cockroachdb/cockroach/commit/05049deba
[0625489bc]: https://github.com/cockroachdb/cockroach/commit/0625489bc
[08a9c1ae7]: https://github.com/cockroachdb/cockroach/commit/08a9c1ae7
[08cccf790]: https://github.com/cockroachdb/cockroach/commit/08cccf790
[0dd1de457]: https://github.com/cockroachdb/cockroach/commit/0dd1de457
[141c20c89]: https://github.com/cockroachdb/cockroach/commit/141c20c89
[14220d671]: https://github.com/cockroachdb/cockroach/commit/14220d671
[1e3eaa26d]: https://github.com/cockroachdb/cockroach/commit/1e3eaa26d
[23228632a]: https://github.com/cockroachdb/cockroach/commit/23228632a
[2545159aa]: https://github.com/cockroachdb/cockroach/commit/2545159aa
[29229633a]: https://github.com/cockroachdb/cockroach/commit/29229633a
[30d4b2ea7]: https://github.com/cockroachdb/cockroach/commit/30d4b2ea7
[3805f6f0a]: https://github.com/cockroachdb/cockroach/commit/3805f6f0a
[3b2d243f4]: https://github.com/cockroachdb/cockroach/commit/3b2d243f4
[409975292]: https://github.com/cockroachdb/cockroach/commit/409975292
[412d6b88b]: https://github.com/cockroachdb/cockroach/commit/412d6b88b
[480882fdb]: https://github.com/cockroachdb/cockroach/commit/480882fdb
[57d260f09]: https://github.com/cockroachdb/cockroach/commit/57d260f09
[691b544bb]: https://github.com/cockroachdb/cockroach/commit/691b544bb
[69725225f]: https://github.com/cockroachdb/cockroach/commit/69725225f
[6bb93f29a]: https://github.com/cockroachdb/cockroach/commit/6bb93f29a
[6c2183e53]: https://github.com/cockroachdb/cockroach/commit/6c2183e53
[874b3fc21]: https://github.com/cockroachdb/cockroach/commit/874b3fc21
[8802beba3]: https://github.com/cockroachdb/cockroach/commit/8802beba3
[88cfe7d55]: https://github.com/cockroachdb/cockroach/commit/88cfe7d55
[900408efc]: https://github.com/cockroachdb/cockroach/commit/900408efc
[9fcc551ae]: https://github.com/cockroachdb/cockroach/commit/9fcc551ae
[b01c287bb]: https://github.com/cockroachdb/cockroach/commit/b01c287bb
[b03471454]: https://github.com/cockroachdb/cockroach/commit/b03471454
[b5799bac6]: https://github.com/cockroachdb/cockroach/commit/b5799bac6
[b9f2d19a7]: https://github.com/cockroachdb/cockroach/commit/b9f2d19a7
[ba13697aa]: https://github.com/cockroachdb/cockroach/commit/ba13697aa
[c6ae316e5]: https://github.com/cockroachdb/cockroach/commit/c6ae316e5
[cad1b02a1]: https://github.com/cockroachdb/cockroach/commit/cad1b02a1
[cf685c9fa]: https://github.com/cockroachdb/cockroach/commit/cf685c9fa
[d457b0cca]: https://github.com/cockroachdb/cockroach/commit/d457b0cca
[dbff3a09a]: https://github.com/cockroachdb/cockroach/commit/dbff3a09a
[ea8aea78c]: https://github.com/cockroachdb/cockroach/commit/ea8aea78c
[ef4605c72]: https://github.com/cockroachdb/cockroach/commit/ef4605c72
[f2b7e9f14]: https://github.com/cockroachdb/cockroach/commit/f2b7e9f14
[f3a28a622]: https://github.com/cockroachdb/cockroach/commit/f3a28a622
[f67decaf2]: https://github.com/cockroachdb/cockroach/commit/f67decaf2
[f9241be8c]: https://github.com/cockroachdb/cockroach/commit/f9241be8c
[fd6d12c72]: https://github.com/cockroachdb/cockroach/commit/fd6d12c72
