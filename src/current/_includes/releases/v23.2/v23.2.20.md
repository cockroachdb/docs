## v23.2.20

Release Date: February 6, 2025

{% include releases/new-release-downloads-docker-image.md release=include.release %}

<h3 id="v23-2-20-security-updates">Security updates</h3>

- The cluster setting server.jwt_authentication.issuers now takes the issuers configuration value apart from the URI. This can be set to one of the following values: 1. Simple string that Go can parse as a valid issuer URL. 2. String that can be parsed as valid JSON array of issuer URLs list. 3. String that can be parsed as valid JSON and deserialized into a map of issuer URLs to corresponding JWKS URIs. In the third case we will be overriding the JWKS URI present in the issuer's well-known endpoint. Example valid values: - 'https://accounts.google.com' - ['example.com/adfs','https://accounts.google.com'] - '{    "issuer_jwks_map": {        "https://accounts.google.com": "https://www.googleapis.com/oauth2/v3/certs",        "example.com/adfs": "https://example.com/adfs/discovery/keys"     }    }' When `issuer_jwks_map` is set, we directly use the JWKS URI to get the key set. In all other cases where JWKSAutoFetchEnabled is set we obtain the JWKS URI first from issuer's well-known endpoint and then use this endpoint. [#138152][#138152]
- The cluster setting server.jwt_authentication.issuers now takes the issuers configuration value apart from the URI. This can be set to one of the following values: 1. Simple string that Go can parse as a valid issuer URL. 2. String that can be parsed as valid JSON array of issuer URLs list. 3. String that can be parsed as valid JSON and deserialized into a map of issuer URLs to corresponding JWKS URIs. In the third case we will be overriding the JWKS URI present in the issuer's well-known endpoint. Example valid values: - 'https://accounts.google.com' - ['example.com/adfs','https://accounts.google.com'] - '{    "issuer_jwks_map": {        "https://accounts.google.com": "https://www.googleapis.com/oauth2/v3/certs",        "example.com/adfs": "https://example.com/adfs/discovery/keys"     }    }' When `issuer_jwks_map` is set, we directly use the JWKS URI to get the key set. In all other cases where JWKSAutoFetchEnabled is set we obtain the JWKS URI first from issuer's well-known endpoint and then use this endpoint. [#138952][#138952]

<h3 id="v23-2-20-sql-language-changes">SQL language changes</h3>

- The `legacy_varchar_typing` session setting has been added, which reverts the changes of #133037 that cause the change in typing behavior described in #137837. Specifically, it makes type-checking and overload resolution ignore the newly added "unpreferred" overloads. This setting defaults to `on`. [#137998][#137998]
- Since v23.2 table statistics histograms have been collected for non-indexed JSON columns. Histograms are no longer collected for these columns if `sql.stats.non_indexed_json_histograms.enabled` is set to false. This reduces memory usage during table statistics collection, for both automatic and manual collection via ANALYZE and CREATE STATISTICS. [#140269][#140269]

<h3 id="v23-2-20-operational-changes">Operational changes</h3>

- The changefeed.max_behind_nanos metric now supports scoping with metric labels. [#139241][#139241]

<h3 id="v23-2-20-bug-fixes">Bug fixes</h3>

- Previously `SHOW CREATE TABLE` was showing incorrect data with regards to inverted indexes.  It now shows the correct data that can be repeatedly entered back into crdb to recreate the same table. [#138167][#138167]
- Fixed a bug where querying the `pg_catalog.pg_constraint` table while the schema changer was dropping a constraint could result in a query error. [#138286][#138286]
- CockroachDB could previously hit a bounded memory leak when collecting table statistics on a table that had both very wide (10KiB or more) and relatively small (under 400B) `BYTES`-like values within the same row. This has been present since before 19.2 version. Additionally, in 24.1.0 a bug was introduced that made this leak also apply to `STRING`-like values. [#139177][#139177]
- Removes duplicate columns in the parquet output from changefeeds using cdc queries. [#140155][#140155]
- Fixed a bug that prevented the create statement for a routine from being shown in a statement bundle. This happened when the routine was created on a schema other than `public`. The bug has existed since v23.1. [#140260][#140260]

<h3 id="v23-2-20-doc-updates">Doc updates</h3>

{% comment %}Docs team: Please add these manually.{% endcomment %}



[#137998]: https://github.com/cockroachdb/cockroach/pull/137998
[#138152]: https://github.com/cockroachdb/cockroach/pull/138152
[#138167]: https://github.com/cockroachdb/cockroach/pull/138167
[#138286]: https://github.com/cockroachdb/cockroach/pull/138286
[#138952]: https://github.com/cockroachdb/cockroach/pull/138952
[#139177]: https://github.com/cockroachdb/cockroach/pull/139177
[#139241]: https://github.com/cockroachdb/cockroach/pull/139241
[#140155]: https://github.com/cockroachdb/cockroach/pull/140155
[#140260]: https://github.com/cockroachdb/cockroach/pull/140260
[#140269]: https://github.com/cockroachdb/cockroach/pull/140269
