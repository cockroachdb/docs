# This shared list serves as a base list for all clusters that use metrics
# export. It was originally taken from [1], and has been modified for CC's use
# case over time.
#
# In this shared list, we have removed all system and storage related metrics,
# with the exception of `sys_uptime`. For CRDB or tenant specific metrics, see
# crdb_metrics.yaml and tenant_metrics.yaml.
#
# NOTE: When adding a new metric to this list, please ensure that it applies to
# both CRDB and tenant clusters, or else they should go into the cluster
# specific list.
#
# Each metric is mapped to its appropriate aggregation function (sum, max, or mean)
# which is used to aggregate metrics by specific labels.
#
# [1]: https://www.cockroachlabs.com/docs/stable/essential-metrics-dedicated
metrics:
  changefeed_backfill_count: sum
  changefeed_backfill_pending_ranges: sum
  changefeed_commit_latency: sum
  changefeed_emitted_bytes: sum
  changefeed_emitted_messages: sum
  changefeed_error_retries: sum
  changefeed_failures: sum
  changefeed_max_behind_nanos: max
  changefeed_message_size_hist: sum
  changefeed_running: sum
  clock_offset_meannanos: mean
  clock_offset_stddevnanos: mean
  distsender_batches: sum
  distsender_batches_partial: sum
  distsender_errors_notleaseholder: sum
  distsender_rpc_sent: sum
  distsender_rpc_sent_local: sum
  distsender_rpc_sent_nextreplicaerror: sum
  jobs_changefeed_currently_paused: sum
  jobs_changefeed_protected_age_sec: max
  jobs_changefeed_resume_retry_error: sum
  jobs_row_level_ttl_currently_paused: sum
  jobs_row_level_ttl_currently_running: sum
  jobs_row_level_ttl_delete_duration: sum
  jobs_row_level_ttl_num_active_spans: sum
  jobs_row_level_ttl_resume_completed: sum
  jobs_row_level_ttl_resume_failed: sum
  jobs_row_level_ttl_rows_deleted: sum
  jobs_row_level_ttl_rows_selected: sum
  jobs_row_level_ttl_select_duration: sum
  jobs_row_level_ttl_span_total_duration: sum
  jobs_row_level_ttl_total_expired_rows: sum
  jobs_scheduled_row_level_ttl_executor_failed: sum
  queue_replicate_replacedecommissioningreplica_error: sum
  range_merges: sum
  rebalancing_cpunanospersecond: sum
  rebalancing_lease_transfers: sum
  rebalancing_queriespersecond: sum
  rebalancing_range_rebalances: sum
  rebalancing_replicas_cpunanospersecond: sum
  rebalancing_replicas_queriespersecond: sum
  requests_slow_distsender: sum
  round_trip_latency: sum
  schedules_BACKUP_failed: sum
  schedules_BACKUP_last_completed_time: max
  schedules_BACKUP_started: sum
  schedules_BACKUP_succeeded: sum
  sql_bytesin: sum
  sql_bytesout: sum
  sql_conn_failures: sum
  sql_conn_latency: sum
  sql_conns: sum
  sql_ddl_count: sum
  sql_delete_count: sum
  sql_distsql_contended_queries_count: sum
  sql_distsql_exec_latency: sum
  sql_distsql_flows_active: sum
  sql_distsql_flows_total: sum
  sql_distsql_queries_active: sum
  sql_distsql_queries_total: sum
  sql_distsql_select_count: sum
  sql_distsql_service_latency: sum
  sql_exec_latency: sum
  sql_failure_count: sum
  sql_full_scan_count: sum
  sql_insert_count: sum
  sql_mem_distsql_current: sum
  sql_mem_distsql_max: max
  sql_mem_internal_session_current: sum
  sql_mem_internal_session_max: max
  sql_mem_internal_txn_current: sum
  sql_mem_internal_txn_max: max
  sql_misc_count: sum
  sql_new_conns: sum
  sql_query_count: sum
  sql_select_count: sum
  sql_service_latency: sum
  sql_statements_active: sum
  sql_txn_abort_count: sum
  sql_txn_begin_count: sum
  sql_txn_commit_count: sum
  sql_txn_latency: sum
  sql_txn_rollback_count: sum
  sql_txns_open: sum
  sql_update_count: sum
  sys_uptime: max
  txn_aborts: sum
  txn_commits: sum
  txn_commits1PC: sum
  txn_durations: sum
  txn_restarts: sum
  txn_restarts_serializable: sum
  txn_restarts_txnaborted: sum
  txn_restarts_txnpush: sum
  txn_restarts_unknown: sum
  txn_restarts_writetooold: sum
  txnwaitqueue_deadlocks_total: sum
