## v25.2.3

Release Date: July 28, 2025

{% include "releases/new-release-downloads-docker-image.md", release: include.release %}

<h3 id="v25-2-3-general-changes">General changes</h3>

- Changefeeds emitting to Kafka sinks that were created in CockroachDB v24.2.1+, or v23.2.10+ and v24.1.4+ with the `changefeed.new_kafka_sink.enabled` cluster setting enabled now include the message key, size, and MVCC timestamp in message too large error logs.
 [#147929][#147929]

<h3 id="v25-2-3-sql-language-changes">SQL language changes</h3>

- Added the metrics `sql.txn.auto_retry.count` and `sql.statements.auto_retry.count`, which count the number of automatic retries of SQL transactions and statements, respectively, within the database. These metrics differ from the related `txn.restarts.*` metrics, which count retryable errors emitted by the KV layer that must be retried. The new `sql.txn.auto_retry.count` and `sql.statements.auto_retry.count` metrics count auto-retry actions taken by the SQL layer in response to some of those retryable errors.
 [#148207][#148207]
- Added a session variable `initial_retry_backoff_for_read_committed` that controls the initial backoff duration when retrying an individual statement in an explicit `READ COMMITTED` transaction. A duration of `0` disables exponential backoff. If a statement in an explicit `READ COMMITTED` transaction is failing with the `40001` error `ERROR: restart transaction: read committed retry limit exceeded; set by max_retries_for_read_committed=...`, then you should set `initial_retry_backoff_for_read_committed` to a duration proportional to the typical execution time of the statement (in addition to also increasing `max_retries_for_read_committed`).
 [#148207][#148207]

<h3 id="v25-2-3-db-console-changes">DB Console changes</h3>

- Updated the "Learn more" link on the **Hot Ranges** page to direct users to a newer, more comprehensive reference guide about hotspots.
 [#148522][#148522]

<h3 id="v25-2-3-bug-fixes">Bug fixes</h3>

- Fixed a data race in the `cloudstorage` sink.
 [#147163][#147163]
- Fixed a bug where searching a vector with a query vector that doesn't match the dimensions of the vector column in the table would cause a node to crash.
 [#147875][#147875]
- Fixed a bug where functions lost their row-level security (RLS) policy backreferences, leading to schema change failures.
 [#147905][#147905]
- Fixed an error in `crdb_internal.table_spans` that could occur when a table's schema had been dropped.
 [#147977][#147977]
- Fixed a bug where adding multiple columns in a single statement with `AddGeometryColumn` would cause runtime errors.
 [#148146][#148146]
- Fixed a bug where `libpq` clients using the async API could hang with large result sets (Python: psycopg; Ruby: ActiveRecord, ruby-pg).
 [#148468][#148468]
- Previously, CockroachDB could hit an internal error when performing a `DELETE`, `UPDATE`, or `UPSERT` where the initial scan of the mutation is locking and is on a table different from the one being mutated. A possible workaround was `SET enable_implicit_select_for_update = false`, but this could increase contention. The bug was introduced in v25.2 and is now fixed.
 [#149301][#149301]
- The `RESET ALL` statement no longer affects the following session variables:
  - `is_superuser`
  - `role`
  - `session_authorization`
  - `transaction_isolation`
  - `transaction_priority`
  - `transaction_status`
  - `transaction_read_only`
  
    This better matches PostgreSQL behavior for `RESET ALL`. In addition, the `DISCARD ALL` statement no longer errors when `default_transaction_use_follower_reads` is enabled.
 [#149388][#149388]
- In v25.1, automatic partial statistics collection was enabled by default (by setting the `sql.stats.automatic_partial_collection.enabled` cluster setting to `true`). Partial statistics collection may encounter certain expected scenarios that were previously reported as failed stats jobs with PostgreSQL error code `55000`. These errors are benign and are no longer reported. Instead, the stats job will be marked as "succeeded," though no new statistics will be created.
 [#149625][#149625]
- Fixed a slow memory leak that was introduced in v25.1.8, v25.2.1, v25.2.2, and v25.3 betas. The leak would accumulate whenever a node executed a part of the distributed plan (the gateway node of the plan was not affected), and could only be mitigated by restarting the node.
 [#149921][#149921]
- Fixed an issue where some SQL metrics were not reported when `server.child_metrics.enabled` was enabled, `server.child_metrics.include_aggregate.enabled` was disabled, and `sql.metrics.application_name.enabled` and `sql.metrics.database_name.enabled` were also disabled. Specifically, metrics with no children now report their aggregate metrics regardless of the `server.child_metrics.include_aggregate.enabled` cluster setting.
 [#150185][#150185]
- Fixed a bug that would allow a race condition in foreign key cascades under `READ COMMITTED` and `REPEATABLE READ` isolation levels.
 [#150338][#150338]
- Fixed a bug where the entire schema would become inaccessible if a table was referenced as an implicit record type by a user-defined function (UDF) while the table was undergoing an `IMPORT`.
 [#150441][#150441]

<h3 id="v25-2-3-miscellaneous">Miscellaneous</h3>

- Restore no longer gets stuck in the reverting state after failed cleanup of dropped temporary system tables.
 [#148485][#148485]


[#148522]: https://github.com/cockroachdb/cockroach/pull/148522
[#147977]: https://github.com/cockroachdb/cockroach/pull/147977
[#148485]: https://github.com/cockroachdb/cockroach/pull/148485
[#148207]: https://github.com/cockroachdb/cockroach/pull/148207
[#147875]: https://github.com/cockroachdb/cockroach/pull/147875
[#147905]: https://github.com/cockroachdb/cockroach/pull/147905
[#149625]: https://github.com/cockroachdb/cockroach/pull/149625
[#150441]: https://github.com/cockroachdb/cockroach/pull/150441
[#147929]: https://github.com/cockroachdb/cockroach/pull/147929
[#147163]: https://github.com/cockroachdb/cockroach/pull/147163
[#150185]: https://github.com/cockroachdb/cockroach/pull/150185
[#148146]: https://github.com/cockroachdb/cockroach/pull/148146
[#148468]: https://github.com/cockroachdb/cockroach/pull/148468
[#149301]: https://github.com/cockroachdb/cockroach/pull/149301
[#149388]: https://github.com/cockroachdb/cockroach/pull/149388
[#149921]: https://github.com/cockroachdb/cockroach/pull/149921
[#150338]: https://github.com/cockroachdb/cockroach/pull/150338
