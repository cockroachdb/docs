---
title: What&#39;s New in v2.1-alpha.20180604
toc: false
summary: Additions and changes in CockroachDB version v2.1-alpha.20180604 since version v2.1-alpha.20180507
---

## June 4, 2018

Get future release notes emailed to you:

<div class="hubspot-install-form install-form-1 clearfix">
    <script>
        hbspt.forms.create({
            css: '',
            cssClass: 'install-form',
            portalId: '1753393',
            formId: '39686297-81d2-45e7-a73f-55a596a8d5ff',
            formInstanceId: 1,
            target: '.install-form-1'
        });
    </script>
</div>

### Downloads

<div id="os-tabs" class="clearfix">
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1-alpha.20180604.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1-alpha.201800604.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1-alpha.20180604.windows-6.2-amd64.zip"><button id="windows" data-eventcategory="windows-binary-release-notes">Windows</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1-alpha.20180604.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

### General Changes

- Introduced cluster settings to configure
  the compactor. [#25397][#25397]
- Existing clusters upgraded to this
  version of CockroachDB will automatically see two new empty databases
  named `defaultdb` and `postgres`. These were added for compatibility
  with PostgreSQL and to ease adoption of CockroachDB. They can be
  manually deleted by an administrator if the client applications are
  determined not to require them. [#24735][#24735]

### SQL Language Changes

- Permit use of collated strings in WHERE
  clauses on indexed columns. [#25169][#25169]
- The `CANCEL QUERY` statement is extended
  with a variant `CANCEL QUERIES` able to cancel multiple queries at
  once. For example, to cancel all queries on node 1 run `CANCEL QUERIES
  SELECT query_id FROM [SHOW CLUSTER QUERIES] WHERE node_id = 1`. [#25157][#25157]
- The `CANCEL SESSION` statement is extended
  with a variant `CANCEL SESSIONS` able to cancel multiple sessions at
  once. For example, to cancel all sessions on node 1 run `CANCEL
  SESSIONS SELECT session_id FROM [SHOW CLUSTER SESSIONS] WHERE node_id =
  1`. [#25157][#25157]
- The `CANCEL/PAUSE/RESUME JOB` statements
  are extended with variants `CANCEL/PAUSE/RESUME JOBS` able to operate
  on multiple jobs at once. For example, to pause all running jobs run
  `PAUSE JOBS SELECT id FROM [SHOW JOBS] WHERE status = 'running'`. [#25157][#25157]
- The Level and Type columns of the EXPLAIN
  (VERBOSE) results are now hidden; if they are needed, they can be
  SELECTed explicitly. [#25172][#25172]
- Add "public" pseudo-role. [#25099][#25099]
- The binary postgres wire format is now supported for
  intervals. [#25242][#25242]
- Stop DROP TABLE from hogging CPU [#24983][#24983]
- `set tracing=<mode>` became less finicky about the
  current session state, so that a client can more easily trace around
  statement that produce errors. [#25262][#25262]
- Added support for the genearte_subscripts builtin
  function. [#25295][#25295]
- The online documentation for `now()`,
  `current_time()`, `current_date()`, `current_timestamp()`,
  `clock_timestamp()`, `statement_timestamp()` and
  `cluster_logical_timestamp()` has been improved and clarified. [#25327][#25327]
- Running `TRUNCATE` without `CASCADE` on a
  table that has interleaved table children will return an error instead
  of proceeding to delete both tables. [#25265][#25265]
- Tuples can now be specified with labels. They can be
  specified using the new grammar `((1,2,3) AS a,b,c)`. [#25283][#25283]
- `SHOW TRACE FOR <QUERY>` now runs <QUERY>
  through distSQL if supported. `SHOW KV TRACE FOR <QUERY>` still runs
  <QUERY> through local SQL. [#24709][#24709]
- The two experimental scalar operators
  `IFERROR()` and `ISERROR()` have been introduced. They may be
  documented for public use in the future. [#25304][#25304]
- The server.time_until_store_dead cluster
  setting can no longer be set to less than 1m15s. Setting it to lower
  values was previously allowed but not safe, since it can cause very bad
  rebalancing behavior. [#25598][#25598]
- Allow CANCEL JOB to be executed on
  long-running schema change jobs, causing them to terminate early and
  roll back.

  See #16018 [#25571][#25571]
- Add the array_to_string builtin function. [#25681][#25681]
- Add support for MySQL's tabbed OUTFILE format to IMPORT. [#25615][#25615]
- New and existing clusters will now contain
  two empty databases called `defaultdb` and `postgres` by default. The
  database `defaultdb` is automatically used for clients that connect
  without a current database set (e.g. without a database component in
  the connection URL). The database `postgres` is provided for
  compatibility with PostgreSQL client frameworks that require it to
  exist when the database server has ben freshly installed. Both new
  databases behave like any other regular database. [#24735][#24735]
- The experimental lookup join feature now
  supports secondary indexes. [#25628][#25628]
- Stored, computed columns can be converted to regular
  columns by running `ALTER TABLE t ALTER COLUMN c DROP STORED`. [#25819][#25819]
- The experimental lookup join feature now
  supports left outer joins. [#25644][#25644]
- TRUNCATE TABLE commands are now logged in the
  event log. [#25868][#25868]
- Correct behavior of GREATEST and LEAST
  builtins when they have a leading NULL argument. [#25882][#25882]
- Improve IMPORT error messages [#26032][#26032]
- Support using mysqldump SQL as an IMPORT data format. [#25783][#25783]

### Command-Line Changes

- The CLI no longer prompts for a password when a
  certificate is provided. [#25252][#25252]
- Changing or removing a replication zone
  config now causes events to be written to the system event log. [#25250][#25250]
- Messages that refer to the invoked command (e.g.,
  "Failed running start") are no longer confused by the presence of flags before
  the first argument (e.g., "cockroach --no-color start"). [#25246][#25246]
- Typos in zone config constraints are now
  validated. At the time that they're set, required attributes and
  localities must match at least one node in the cluster. [#25421][#25421]
- Show --enterprise-encryption flag on start command [#26061][#26061]

### Admin UI Changes

- Running unit tests for the Admin UI now depend
  on the installation of Google Chrome. [#25140][#25140]
- Add RocksDB compactions/flushes to
  storage graphs. [#25428][#25428]

### Bug Fixes

- CockroachDB now properly reports an error when
  using the internal-only functions `final_variance()` and
  `final_stddev()` instead of causing a crash. [#25158][#25158]
- The constraint_schema column in
  information_schema.constraint_column_usage now displays the
  constraint's schema instead of its catalog. [#25190][#25190]
- 'begin; release savepoint' no longer crashes, but
  returns an error. [#25247][#25247]
- Fix a bug where the sessions endpoint on the
  admin UI would return an error when there was an active transaction. [#25249][#25249]
- The CockroachDB-specific, undocumented
  conversion from `interval` to/from numeric types was wrong and has
  been corrected. It may become documented in the future. [#25257][#25257]
- Fix problems with IMPORT sometimes failing
  after node decommissioning. [#25162][#25162]
- Prevent crash with queries that use placeholders
  for tuple types. [#25269][#25269]
- Fix a rare segfault that occurred when reading
  from an invalid memory location returned from C++. [#25347][#25347]
- Fixed a bug with `IS DISTINCT FROM` not
  returning NULL values that pass the condition in some cases. [#25336][#25336]
- Restarting a CockroachDB server on Windows no
  longer fails due to file system locks in the store directory. [#25267][#25267]
- Prevent the consistency checker from
  deadlocking. This would previously manifest itself as a steady number of
  replicas queued for consistency checking on one or more nodes and would
  resolve by restarting the affected nodes. [#25456][#25456]
- Fixed a crash in some cases when using a GROUP
  BY with HAVING. [#25574][#25574]
- Fix a nil pointer dereference when importing
  data containing date values. [#25661][#25661]
- Numeric literal values will no longer silently
  lose information after a certain precision. [#25597][#25597]
- Prevent spurious BudgetExceededErrors for some
  queries that read a lot of JSON data from disk. [#25679][#25679]
- Fixed query errors in some cases involving a
  NULL constant that is cast to a specific type. [#25735][#25735]
- Fix a server crash when trying to plan
  certain UNION ALL queries. [#25747][#25747]
- Fix a crash caused by inserting data into a
  table with computed columns that reference other columns that weren't
  present in the insert statement. [#25682][#25682]
- EXPLAIN (DISTSQL) now properly reports that
  plans containing subqueries cannot be run through the distributed sql
  execution engine. [#25618][#25618]
- CockroachDB no longer crashes if the control
  statements (`CANCEL`/`PAUSE`/`RESUME`) are given values using special
  PostgresSQL types (e.g. `NAME`). [#25844][#25844]
- Fix a panic when using unordered aggregations. [#26042][#26042]
- Fixed an error caused by INET constants in
  some rare cases. [#26086][#26086]
- Fixed an error caused by empty arrays in some
  cases. [#26090][#26090]
- Expired compaction suggestions are now dropped
  not too soon after they expire. Previously, this could be delayed
  indefinitely. [#26039][#26039]

### Performance Improvements

- Reduced CPU overhead of idle
  ranges [#24956][#24956]

### Miscellaneous

#### Missing Category

- Add a stores report page, including encryption status. [#26040][#26040]
- Labeled tuples can now be accessed using their labels (e.g.
  `SELECT (((1,'2',true) AS a, b, c)).a` but it requires an extra level of
  parentheses to do so. [#25810][#25810]
- Removes no-op time selectors and tier labels during cluster node map onboarding flow [#25280][#25280]

#### Sql Fix

- Fix problems with using tables
  created in the same transaction when the tables have FOREIGN
  KEY or INTERLEAVED references to other tables which have also
  been created in the same transaction. [#25786][#25786]

#### Changes without release note annotation

- [#25768][#25768] [54c3e5dd4][54c3e5dd4] k8s: upgrade configs to 2.0.2 (Marc Berhault)
- [#25769][#25769] [034d3887e][034d3887e] rhel: update to 2.0.2 (Marc Berhault)
- [#25539][#25539] [7cb090063][7cb090063] storage: put an Aborted txn inside a TxnAbortedError (Andrei Matei)
- [#25211][#25211] [88db97364][88db97364] prereqs: ignore Go files that start with . or _ (Nikhil Benesch)

### Doc Updates

Docs team: Please add these manually.

### Contributors

This release includes 304 merged PRs by 38 authors. We would like to thank the following contributors from the CockroachDB community, with special thanks to first-time contributors Nishant Gupta, wabada, and yuzefovich.
- Garvit Juniwal
- Gustav Paul
- Karan Vaidya
- Nishant Gupta
- Vijay Karthik
- wabada
- yuzefovich

[#24709]: https://github.com/cockroachdb/cockroach/pull/24709
[#24735]: https://github.com/cockroachdb/cockroach/pull/24735
[#24956]: https://github.com/cockroachdb/cockroach/pull/24956
[#24983]: https://github.com/cockroachdb/cockroach/pull/24983
[#25099]: https://github.com/cockroachdb/cockroach/pull/25099
[#25140]: https://github.com/cockroachdb/cockroach/pull/25140
[#25157]: https://github.com/cockroachdb/cockroach/pull/25157
[#25158]: https://github.com/cockroachdb/cockroach/pull/25158
[#25162]: https://github.com/cockroachdb/cockroach/pull/25162
[#25169]: https://github.com/cockroachdb/cockroach/pull/25169
[#25172]: https://github.com/cockroachdb/cockroach/pull/25172
[#25190]: https://github.com/cockroachdb/cockroach/pull/25190
[#25211]: https://github.com/cockroachdb/cockroach/pull/25211
[#25242]: https://github.com/cockroachdb/cockroach/pull/25242
[#25246]: https://github.com/cockroachdb/cockroach/pull/25246
[#25247]: https://github.com/cockroachdb/cockroach/pull/25247
[#25249]: https://github.com/cockroachdb/cockroach/pull/25249
[#25250]: https://github.com/cockroachdb/cockroach/pull/25250
[#25252]: https://github.com/cockroachdb/cockroach/pull/25252
[#25257]: https://github.com/cockroachdb/cockroach/pull/25257
[#25262]: https://github.com/cockroachdb/cockroach/pull/25262
[#25265]: https://github.com/cockroachdb/cockroach/pull/25265
[#25267]: https://github.com/cockroachdb/cockroach/pull/25267
[#25269]: https://github.com/cockroachdb/cockroach/pull/25269
[#25280]: https://github.com/cockroachdb/cockroach/pull/25280
[#25283]: https://github.com/cockroachdb/cockroach/pull/25283
[#25295]: https://github.com/cockroachdb/cockroach/pull/25295
[#25304]: https://github.com/cockroachdb/cockroach/pull/25304
[#25327]: https://github.com/cockroachdb/cockroach/pull/25327
[#25336]: https://github.com/cockroachdb/cockroach/pull/25336
[#25347]: https://github.com/cockroachdb/cockroach/pull/25347
[#25397]: https://github.com/cockroachdb/cockroach/pull/25397
[#25421]: https://github.com/cockroachdb/cockroach/pull/25421
[#25428]: https://github.com/cockroachdb/cockroach/pull/25428
[#25456]: https://github.com/cockroachdb/cockroach/pull/25456
[#25539]: https://github.com/cockroachdb/cockroach/pull/25539
[#25571]: https://github.com/cockroachdb/cockroach/pull/25571
[#25574]: https://github.com/cockroachdb/cockroach/pull/25574
[#25597]: https://github.com/cockroachdb/cockroach/pull/25597
[#25598]: https://github.com/cockroachdb/cockroach/pull/25598
[#25615]: https://github.com/cockroachdb/cockroach/pull/25615
[#25618]: https://github.com/cockroachdb/cockroach/pull/25618
[#25628]: https://github.com/cockroachdb/cockroach/pull/25628
[#25644]: https://github.com/cockroachdb/cockroach/pull/25644
[#25661]: https://github.com/cockroachdb/cockroach/pull/25661
[#25679]: https://github.com/cockroachdb/cockroach/pull/25679
[#25681]: https://github.com/cockroachdb/cockroach/pull/25681
[#25682]: https://github.com/cockroachdb/cockroach/pull/25682
[#25735]: https://github.com/cockroachdb/cockroach/pull/25735
[#25747]: https://github.com/cockroachdb/cockroach/pull/25747
[#25768]: https://github.com/cockroachdb/cockroach/pull/25768
[#25769]: https://github.com/cockroachdb/cockroach/pull/25769
[#25783]: https://github.com/cockroachdb/cockroach/pull/25783
[#25786]: https://github.com/cockroachdb/cockroach/pull/25786
[#25810]: https://github.com/cockroachdb/cockroach/pull/25810
[#25819]: https://github.com/cockroachdb/cockroach/pull/25819
[#25844]: https://github.com/cockroachdb/cockroach/pull/25844
[#25868]: https://github.com/cockroachdb/cockroach/pull/25868
[#25882]: https://github.com/cockroachdb/cockroach/pull/25882
[#26032]: https://github.com/cockroachdb/cockroach/pull/26032
[#26039]: https://github.com/cockroachdb/cockroach/pull/26039
[#26040]: https://github.com/cockroachdb/cockroach/pull/26040
[#26042]: https://github.com/cockroachdb/cockroach/pull/26042
[#26061]: https://github.com/cockroachdb/cockroach/pull/26061
[#26086]: https://github.com/cockroachdb/cockroach/pull/26086
[#26090]: https://github.com/cockroachdb/cockroach/pull/26090
[034d3887e]: https://github.com/cockroachdb/cockroach/commit/034d3887e
[54c3e5dd4]: https://github.com/cockroachdb/cockroach/commit/54c3e5dd4
[7cb090063]: https://github.com/cockroachdb/cockroach/commit/7cb090063
[88db97364]: https://github.com/cockroachdb/cockroach/commit/88db97364
