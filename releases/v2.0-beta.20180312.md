---
title: What&#39;s New in v2.0-beta.20180312
toc: false
summary: Additions and changes in CockroachDB version v2.0-beta.20180312 since version v2.0-beta.20180305
---

## March 12, 2018

Get future release notes emailed to you:

<div class="hubspot-install-form install-form-1 clearfix">
    <script>
        hbspt.forms.create({
            css: '',
            cssClass: 'install-form',
            portalId: '1753393',
            formId: '39686297-81d2-45e7-a73f-55a596a8d5ff',
            formInstanceId: 1,
            target: '.install-form-1'
        });
    </script>
</div>

### Downloads

<div id="os-tabs" class="clearfix">
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0-beta.20180312.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0-beta.20180312.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0-beta.20180312.windows-6.2-amd64.zip"><button id="windows" data-eventcategory="windows-binary-release-notes">Windows</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.0-beta.20180312.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

### Build Changes

  - Binaries are now built with Go 1.10 by default. [#23311][#23311]

### General Changes

- logging data is now flushed to files
  more frequently, every second, to aid troubleshooting and
  monitoring. Synchronization to disk is performed separately every 30
  seconds. [#23231][#23231]
- disabling diagnostics reporting also disables new version notification checks. [#23007][#23007]
- remove the cluster setting diagnostics.reporting.report_metrics. [#23007][#23007]
- All internal error messages will now be
  logged when logging is set to a high enough verbosity. [#23127][#23127]

### SQL Language Changes

- will fix endless churn experienced from
  large `DELETE FROM` statements, either by allowing them to complete,
  or by exiting with an error message indicating the transaction is too
  large to complete. [#23289][#23289]
- the `pg_catalog` virtual tables, as well as
  the special casts `::regproc` and `::regclass`, can only be queried by
  clients that properly set a current database (`SET database = ...` or
  `USE`). [#23148][#23148]

### Command-Line Changes

- Replication zone configs now allow for
  specifying an ordered list of lease placement preferences. Whenever
  possible, CockroachDB will attempt to put the lease for a range on a
  store that satisfies the first set of constraints. If that's not
  possible, it'll attempt to put the lease on a store that satisfies the
  second set of constraints, and so on. If none of the preferences can be
  met, the lease will be placed as it is today. [#23372][#23372]
- Print a help message if a node spends more
  than 30 seconds waiting for an init command or to join a cluster. [#23181][#23181]

### Admin UI Changes

- Added a new debug page that allows users to create a "custom" graph
displaying any combination of metrics. The currently selected
metrics are stored in the URL, so custom graphs can be shared by copying the
link. [#23227][#23227]
- in cluster viz, link from node component
  to node details page [#23283][#23283]
- Removed the Keys Written per Second per
  Store graph. [#23303][#23303]
- Adds the Lead Transferee field to the range
  debug page. [#23241][#23241]

### Bug Fixes

- The admin UI no longer hangs after a node's
  network configuration has changed. [#23348][#23348]
- support the binary format for JSONB values. [#23215][#23215]
- Add server.shutdown.drain_wait cluster setting
  and wait for that length of time in an unready state before draining to
  not get client requests while draining behind a load balancer. [#23319][#23319]
- Fixed a panic when UPSERT ... RETURNING was
  combined with UNION. [#23317][#23317]
- Avoid disruptions in performance when gracefully
  shutting a node down. [#23300][#23300]
- Hardened the cluster version upgrade mechanism.
  Rapid upgrades through more than two versions could sometimes fail
  recoverably. [#23287][#23287]
- Fixed a deadlock when tables are rapidly
  created or dropped. [#23288][#23288]
- Fix a small memory leak in IMPORT CSV. [#23259][#23259]
- prevent panic in distsql under certain error
  conditions. [#23201][#23201]
- readiness endpoint added (/health?ready=1)
  for better integration with load balancers. [#23247][#23247]
- Fix a zero qps scenario when a node would be
  gracefully drained. [#23246][#23246]
- secondary log files (e.g. the SQL execution
  log) are now periodically flushed to disk, in addition to the flush
  that occurs naturally when single log files are full
  (`--log-file-max-size`) and when the process terminates gracefully. [#23231][#23231]
- log file rotation is now properly active for
  secondary log files (e.g. the SQL execution and audit logs). [#23231][#23231]
- Previously the `node status` command's "ranges"
  column only included ranges whose raft leader was on the node in
  question. It now includes the count of all ranges on the node,
  regardless of where the raft leader is. [#23180][#23180]
- do not crash if COCKROACH_UPDATE_CHECK_URL or COCKROACH_USAGE_REPORT_URL overrides are empty. [#23007][#23007]
- Guard against stale reads caused by the system
  clock moving backwards while the `cockroach` process is not running. [#23122][#23122]
- The handling of cases where a replica
  fails to retrieve the last processed timestamp of a queue has been
  corrected. [#23127][#23127]
- Fixed a bug where liveness status would not always display correctly on the single-node page. [#23193][#23193]
- Fix bug with showing description on jobs page. [#23256][#23256]

### Doc Updates

Docs team: Please add these manually.

### Contributors

This release includes 44 merged PRs by 21 authors.

[#23007]: https://github.com/cockroachdb/cockroach/pull/23007
[#23122]: https://github.com/cockroachdb/cockroach/pull/23122
[#23127]: https://github.com/cockroachdb/cockroach/pull/23127
[#23148]: https://github.com/cockroachdb/cockroach/pull/23148
[#23180]: https://github.com/cockroachdb/cockroach/pull/23180
[#23181]: https://github.com/cockroachdb/cockroach/pull/23181
[#23193]: https://github.com/cockroachdb/cockroach/pull/23193
[#23201]: https://github.com/cockroachdb/cockroach/pull/23201
[#23215]: https://github.com/cockroachdb/cockroach/pull/23215
[#23227]: https://github.com/cockroachdb/cockroach/pull/23227
[#23231]: https://github.com/cockroachdb/cockroach/pull/23231
[#23241]: https://github.com/cockroachdb/cockroach/pull/23241
[#23246]: https://github.com/cockroachdb/cockroach/pull/23246
[#23247]: https://github.com/cockroachdb/cockroach/pull/23247
[#23256]: https://github.com/cockroachdb/cockroach/pull/23256
[#23259]: https://github.com/cockroachdb/cockroach/pull/23259
[#23283]: https://github.com/cockroachdb/cockroach/pull/23283
[#23287]: https://github.com/cockroachdb/cockroach/pull/23287
[#23288]: https://github.com/cockroachdb/cockroach/pull/23288
[#23289]: https://github.com/cockroachdb/cockroach/pull/23289
[#23300]: https://github.com/cockroachdb/cockroach/pull/23300
[#23303]: https://github.com/cockroachdb/cockroach/pull/23303
[#23311]: https://github.com/cockroachdb/cockroach/pull/23311
[#23317]: https://github.com/cockroachdb/cockroach/pull/23317
[#23319]: https://github.com/cockroachdb/cockroach/pull/23319
[#23348]: https://github.com/cockroachdb/cockroach/pull/23348
[#23372]: https://github.com/cockroachdb/cockroach/pull/23372
