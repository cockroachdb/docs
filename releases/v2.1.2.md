---
title: What&#39;s New in v2.1.2
toc: true
summary: Additions and changes in CockroachDB version v2.1.2 since version v2.1.1
---

## December 10, 2018

Get future release notes emailed to you:

<div class="hubspot-install-form install-form-1 clearfix">
    <script>
        hbspt.forms.create({
            css: '',
            cssClass: 'install-form',
            portalId: '1753393',
            formId: '39686297-81d2-45e7-a73f-55a596a8d5ff',
            formInstanceId: 1,
            target: '.install-form-1'
        });
    </script>
</div>

### Downloads

<div id="os-tabs" class="clearfix">
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.2.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.2.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.2.windows-6.2-amd64.zip"><button id="windows" data-eventcategory="windows-binary-release-notes">Windows</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.2.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

### Docker image

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach:v2.1.2
~~~

### Backward-incompatible changes

- The `CHANGEFEED` [`experimental-avro` option](../v2.1/create-changefeed.html#options) has been renamed `experimental_avro`. [#32235][#32235]

### SQL language changes

- The [`IMPORT format (file)`](../v2.2/import.html) syntax is deprecated in favor of `IMPORT format file`. Similarly, `IMPORT TABLE ... FROM format (file)` is deprecated in favor of `IMPORT TABLE ... FROM format file`. [#31301][#31301]
- Fix panic on UPDATE RETURNING * during a schema change. [#32591][#32591]
- Allow bpchar OIDs from client connections. [#32661][#32661]
- Fix crash in UPSERT in the middle of a schema change adding a non-nullable column. [#32730][#32730]
- Fix error when configuring NOT NULL computed columns. [#32730][#32730]
- Fix deadlock when using ALTER TABLE VALIDATE CONSTRAINT in a transaction with a schema change. [#32850][#32850]

### Command-line changes

- `cockroach workload` now includes the kv generator [#32756][#32756]

### Bug fixes

- Avoid a performance degradation related to overly aggressive Raft log truncations that could occur during RESTORE or IMPORT operations. [#32412][#32412]
- Avoid a stall in the processing of Raft snapshots when many snapshots are requested at the same time. [#32414][#32414]
- CHANGEFEEDs now escape kafka topic names when necessary [#32235][#32235]
- CHANGEFEEDs now spend dramatically less time flushing kafka writes [#32235][#32235]
- Experimental_avro CHANGEFEEDs now work with column WIDTHs and PRECISIONs [#32484][#32484]
- Fix a bug where Raft proposals could get stuck if forwarded to a leader who could not itself append a new entry to its log. [#32600][#32600]
- Fixed an issue where calling CREATE STATISTICS on a large table could cause the server to crash due to running out of memory. [#32635][#32635]
- Fix a node data loss bug that occurs when a disk becomes temporarily full. [#32633][#32633]
- CockroachDB previously silently and incorrectly accepted then ignored a WHERE clause after INSERT ON CONFLICT. This is now properly recognized and will produce an error reporting the feature is unimplemented. [#32558][#32558]
- CockroachDB now properly handles foreign key cascading actions `SET DEFAULT` and `SET NULL` in `SHOW CREATE` and `cockroach dump`. [#32630][#32630]
- Fixed a crash that could occur during or after a data import on Windows. [#32666][#32666]
- Lookup joins now properly preserve ordering for outer joins. Prior to this fix, LEFT JOIN queries under specific conditions could produce results which did not respect the ORDER BY clause. [#32678][#32678]
- CockroachDB now again enables admin users, including `root`, to list all user sessions besides their own. [#32709][#32709]
- CockroachDB now properly rejects queries that use an invalid function in UPDATE SET (e.g., an aggregation). [#32506][#32506]
- Dates no longer have a time component in their text encoding over the wire. [#32661][#32661]
- Correct binary decimal encoding for NaN. [#32661][#32661]
- CockroachDB does not longer crash when encountering an internal error related to invalid entries in the output of SHOW SESSIONs. [#32742][#32742]
- Prevent crash when running certain subqueries that get planned in a distributed fashion. [#32670][#32670]
- CHANGEFEEDs emitting into kafka more quickly notice new partitions. [#32757][#32757]
- CockroachDB now properly records statistics for sessions where the value of `application_name` is given by the client during initialization instead of `SET`. [#32755][#32755]
- CockroachDB now properly evaluates CHECK constraints after a row conflict in INSERT ON CONFLICT, when the CHECK constraint depends on a column not assigned by DO UPDATE SET. [#32780][#32780]
- `cockroach workload run` no longer includes data-only generators [#32827][#32827]
- Fix a bug where metadata about contended keys was inadvertently ignored, allowing for a failure in txn cycle detection and transaction deadlocks in rare cases. [#32853][#32853]

### Performance improvements

- Change the default value for the cluster setting kv.transaction.write_pipelining_max_batch_size to 128. This speeds up bulk write operations. [#32621][#32621]

### Doc updates

Docs team: Please add these manually.

### Contributors

This release includes 41 merged PRs by 15 authors.

[#31301]: https://github.com/cockroachdb/cockroach/pull/31301
[#32235]: https://github.com/cockroachdb/cockroach/pull/32235
[#32412]: https://github.com/cockroachdb/cockroach/pull/32412
[#32414]: https://github.com/cockroachdb/cockroach/pull/32414
[#32484]: https://github.com/cockroachdb/cockroach/pull/32484
[#32506]: https://github.com/cockroachdb/cockroach/pull/32506
[#32558]: https://github.com/cockroachdb/cockroach/pull/32558
[#32591]: https://github.com/cockroachdb/cockroach/pull/32591
[#32600]: https://github.com/cockroachdb/cockroach/pull/32600
[#32621]: https://github.com/cockroachdb/cockroach/pull/32621
[#32630]: https://github.com/cockroachdb/cockroach/pull/32630
[#32633]: https://github.com/cockroachdb/cockroach/pull/32633
[#32635]: https://github.com/cockroachdb/cockroach/pull/32635
[#32661]: https://github.com/cockroachdb/cockroach/pull/32661
[#32666]: https://github.com/cockroachdb/cockroach/pull/32666
[#32670]: https://github.com/cockroachdb/cockroach/pull/32670
[#32678]: https://github.com/cockroachdb/cockroach/pull/32678
[#32709]: https://github.com/cockroachdb/cockroach/pull/32709
[#32730]: https://github.com/cockroachdb/cockroach/pull/32730
[#32742]: https://github.com/cockroachdb/cockroach/pull/32742
[#32755]: https://github.com/cockroachdb/cockroach/pull/32755
[#32756]: https://github.com/cockroachdb/cockroach/pull/32756
[#32757]: https://github.com/cockroachdb/cockroach/pull/32757
[#32780]: https://github.com/cockroachdb/cockroach/pull/32780
[#32827]: https://github.com/cockroachdb/cockroach/pull/32827
[#32850]: https://github.com/cockroachdb/cockroach/pull/32850
[#32853]: https://github.com/cockroachdb/cockroach/pull/32853
