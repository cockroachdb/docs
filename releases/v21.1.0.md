---
title: What&#39;s New in v21.1.0
toc: true
summary: Additions and changes in CockroachDB version v21.1.0.
---

## XXX

With the release of CockroachDB v21.1, we've made a variety of productivity, management, and performance improvements. Check out a [summary of the most significant user-facing changes](#feature-summary) and then [upgrade to CockroachDB v21.1](../v21.1/upgrade-cockroach-version.html).

To learn more:

- Read the **v21.1 blog post** (link TBD)
- Join a v21.1 overview and live demo session on XXX:

## Downloads

<div id="os-tabs" class="clearfix">
    <a href="https://binaries.cockroachdb.com/cockroach-v21.1.1.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v21.1.0.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v21.1.0.windows-6.2-amd64.zip"><button id="windows" data-eventcategory="windows-binary-release-notes">Windows</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v21.1.0.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

## Docker image

{% include copy-clipboard.html %}
~~~ shell
$ docker pull cockroachdb/cockroach:v21.1.0
~~~

## CockroachCloud

<a href="https://cockroachlabs.cloud/signup?referralId=docs_crdb_release_notes" rel="noopener" target="_blank">Get a free v20.2 cluster on CockroachCloud</a>

Recent CockroachCloud improvements:

TBD

## Feature summary

This section summarizes the most significant user-facing changes in v20.2.0. For a complete list of features and changes, including bug fixes and performance improvements, see the [release notes](index.html#testing-releases) for previous testing releases. You can also search for [what's new in v21.1 in our docs](../search.html?query=%22New%20in%20v21.1%22&page=2).

{{site.data.alerts.callout_info}}
"Core" features are freely available in the core version and do not require an enterprise license. "Enterprise" features require an [enterprise license](https://www.cockroachlabs.com/get-cockroachdb/). [CockroachCloud clusters](https://cockroachlabs.cloud/) include all enterprise features.
{{site.data.alerts.end}}

- [SQL](#sql)
- [Recovery and I/O](#recovery-and-i-o)
- [Deployment and Operations](#deployment-and-operations)
- [Observability](#observability)
- [Backward-incompatible changes](#backward-incompatible-changes)
- [Deprecations](#deprecations)
- [Known limitations](#known-limitations)
- [Education](#education)

<style>
    table td:first-child {
        min-width: 100px !important;
    }
    table td:nth-child(2) {
        min-width: 200px !important;
    }
</style>

### SQL

Version | Feature | Description
--------|---------|------------

### Recovery and I/O

Version | Feature | Description
--------|---------|------------

### Deployment and Operations

Version | Feature | Description
--------|---------|------------

### Observability

Version | Feature | Description
--------|---------|------------

### Backward-incompatible changes

Before [upgrading to CockroachDB v21.1](../v20.1/upgrade-cockroach-version.html), be sure to review the following backward-incompatible changes and adjust your deployment as necessary.

- Rows containing empty arrays in [`ARRAY`](../v21.1/array.html) columns are now contained in [inverted indexes](../v21.1/inverted-indexes.html). This change is backward-incompatible because prior versions of CockroachDB will not be able to recognize and decode keys for empty arrays. Note that rows containing `NULL` values in an indexed column will still not be included in inverted indexes.
- Concatenation between a non-null argument and a null argument is now typed as string concatenation, whereas it was previously typed as array concatenation. This means that the result of `NULL || 1` will now be `NULL` instead of `{1}`. To preserve the old behavior, the null argument can be casted to an explicit type.
- The payload fields for certain event types in `system.eventlog` have been changed and/or renamed. Note that the payloads in `system.eventlog` were an undocumented, reserved feature so no guarantee was made about cross-version compatibility to this point. The list of changes includes (but is not limited to):
  - `TargetID` has been renamed to `NodeID` for `node_join`.
  - `TargetID` has been renamed to `TargetNodeID` for `node_decommissioning` / `node_decommissioned` / `node_recommissioned`.
  - `NewDatabaseName` has been renamed to `NewDatabaseParent` for `convert_to_schema`.
  - `grant_privilege` and `revoke_privilege` have been removed; they are replaced by `change_database_privilege`, `change_schema_privilege`, `change_type_privilege`, and `change_table_privilege`. Each event only reports a change for one user/role, so the `Grantees` field was renamed to `Grantee`.
  - Each `drop_role` event now pertains to a single [user/role](../v21.1/authorization.html#sql-users).
- The connection and authentication logging enabled by the [cluster settings](../v21.1/cluster-settings.html) `server.auth_log.sql_connections.enabled` and `server.auth_log.sql_sessions.enabled` was previously using a text format which was hard to parse and integrate with external monitoring tools. This has been changed to use the standard notable event mechanism, with standardized payloads. The output format is now structured; see the generated [reference documentation](https://github.com/cockroachdb/cockroach/blob/master/docs/generated/eventlog.md) for details about the supported event types and payloads.
- The logging format for [SQL audit](../v21.1/sql-audit-logging.html), [execution](../v21.1/query-behavior-troubleshooting.html#cluster-wide-execution-logs), and [query](../v21.1/query-behavior-troubleshooting.html#slow-query-logs) logs has changed from a crude space-delimited format to JSON. To opt out of this new behavior and restore the pre-v21.1 logging format, you can set the [cluster setting](../v21.1/cluster-settings.html) `sql.log.unstructured_entries.enabled` to `true`.
- The [`cockroach debug ballast`](../v21.1/cockroach-debug-ballast.html) command now refuses to overwrite the target ballast file if it already exists. This change is intended to prevent mistaken uses of the `ballast` command by operators. Scripts that integrate `cockroach debug ballast` can consider adding a `rm` command.
- Removed the `kv.atomic_replication_changes.enabled` [cluster setting](../v21.1/cluster-settings.html). All replication changes on a range now use joint-consensus.

### Deprecations

- The CLI flags `--log-dir`, `--log-file-max-size`, `--log-file-verbosity`, `--log-group-max-size` are deprecated. Logging configuration can now be specified via the `--log` parameter. See the documentation for details.  
- The client-side command `\show` for the [SQL shell](cockroach-sql.html#commands) is deprecated in favor of the new command `\p`. This prints the contents of the query buffer entered so far.

### Known limitations

For information about new and unresolved limitations in CockroachDB v21.1, with suggested workarounds where applicable, see [Known Limitations](../v21.1/known-limitations.html).

### Education

Area | Topic | Description
-----|-------|------------
