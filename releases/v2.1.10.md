---
title: What&#39;s New in v2.1.10
toc: true
summary: Additions and changes in CockroachDB version v2.1.10 since version v2.1.9
---

## December 16, 2019

Get future release notes emailed to you:

<div class="hubspot-install-form install-form-1 clearfix">
    <script>
        hbspt.forms.create({
            css: '',
            cssClass: 'install-form',
            portalId: '1753393',
            formId: '39686297-81d2-45e7-a73f-55a596a8d5ff',
            formInstanceId: 1,
            target: '.install-form-1'
        });
    </script>
</div>

### Downloads

<div id="os-tabs" class="clearfix">
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.10.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.10.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-v2.1.10.src.tgz"><button id="source" data-eventcategory="source-release-notes">Source</button></a>
</div>

### Docker image

{% include copy-clipboard.html %}
~~~shell
$ docker pull cockroachdb/cockroach:v2.1.10
~~~

### Security updates

- In previous releases, CockroachDB was allowing non-authenticated
  access to privileged HTTP endpoints like `/_admin/v1/events`. This was
  a security vulnerability, because these endpoints operate using the
  permissions of the `root` user and can thus access (and sometimes
  modify) any and all data in the cluster. This security vulnerability
  has been patched by disallowing non-authenticated access to these
  endpoints.

  A possible fallout from this change is that users might have
  built monitoring automation using these HTTP endpoints previously. Any
  such automation must be modified to work using an HTTP session
  token. This situation, as well as further instructions and
  workarounds, is discussed
  [here](https://github.com/cockroachdb/cockroach/issues/43870).

- Some screens of the web UI were previously displayed using the
  permissions of the `root` user, regardless of which user was logged
  into the UI, for example the job details page. This was a security
  vulnerability because it was enabling insufficiently privileged
  users to access privileged information. This vulnerability
  has been patched by using the credentials of the logged-in user
  to access the various UI pages. This results in empty UI screens
  if the user is insufficiently privileged.

  A possible fallout from this change is that users without a valid
  enterprise license are now unable to access certain UI screens:
  these would require an account with the `admin` role but granting
  this role requires a valid license. This situation, as well as
  further instructions and workarounds, is discussed
  [here](https://github.com/cockroachdb/cockroach/issues/43870). The
  main envisioned solution is [to enable the `root` to access the web
  UI](https://github.com/cockroachdb/cockroach/issues/43847) in a
  future version of CockroachDB.

The list of HTTP endpoints affected by the first change above includes:

| HTTP Endpoint                                          | Description                       | Sensitive information revealed                     | Special (see below) |
|--------------------------------------------------------|-----------------------------------|----------------------------------------------------|---------------------|
| `/_admin/v1/data_distribution`                         | Database-table-node mapping       | Database and table names                           |                     |
| `/_admin/v1/databases/{database}/tables/{table}/stats` | Table stats histograms            | Stored table data  via PK values                   |                     |
| `/_admin/v1/drain`                                     | API to shut down a node           | Can cause DoS on cluster                           |                     |
| `/_admin/v1/enqueue_range`                             | Force range rebalancing           | Can cause DoS on cluster                           |                     |
| `/_admin/v1/events`                                    | Event log                         | Usernames, stored object names, privilege mappings |                     |
| `/_admin/v1/nontablestats`                             | Non-table statistics              | Stored table data via PK values                    |                     |
| `/_admin/v1/rangelog`                                  | Range log                         | Stored table data via PK values                    |                     |
| `/_admin/v1/settings`                                  | Cluster settings                  | Organization name                                  |                     |
| `/_status/allocator/node/{node_id}`                    | Rebalance simulator               | Can cause DoS on cluster                           | yes                 |
| `/_status/allocator/range/{range_id}`                  | Rebalance simulatoor              | Can cause DoS on cluster                           | yes                 |
| `/_status/certificates/{node_id}`                      | Node and user certificates        | Credentials                                        |                     |
| `/_status/details/{node_id}`                           | Node details                      | Internal IP addresses                              |                     |
| `/_status/enginestats/{node_id}`                       | Storage statistics                | Operational details                                |                     |
| `/_status/files/{node_id}`                             | Retrieve heap and goroutine dumps | Operational details                                | yes                 |
| `/_status/gossip/{node_id}`                            | Gossip details                    | Internal IP addresses                              | yes                 |
| `/_status/hotranges`                                   | Ranges with active requests       | Stored table data via PK values                    |                     |
| `/_status/local_sessions`                              | SQL sessions                      | Cleartext SQL queries                              | yes                 |
| `/_status/logfiles/{node_id}`                          | List of log files                 | Operational details                                | yes                 |
| `/_status/logfiles/{node_id}/{file}`                   | Server logs + entries             | Many: names, application data, credentials, etc.   | yes                 |
| `/_status/logs/{node_id}`                              | Log entries                       | Many: names, application data, credentials, etc.   | yes                 |
| `/_status/profile/{node_id}`                           | Profiling data                    | Operational details                                |                     |
| `/_status/raft`                                        | Raft details                      | Stored table data via PK values                    |                     |
| `/_status/range/{range_id}`                            | Range details                     | Stored table data via PK values                    |                     |
| `/_status/ranges/{node_id}`                            | Range details                     | Stored table data via PK values                    |                     |
| `/_status/sessions`                                    | SQL sessions                      | Cleartext SQL queries                              | yes                 |
| `/_status/span`                                        | Statistics per key span           | Whether certain table rows exist                   |                     |
| `/_status/stacks/{node_id}`                            | Stack traces                      | Application data, stored table data                |                     |
| `/_status/stores/{node_id}`                            | Store details                     | Operational details                                |                     |

Note: "special" endpoints are subject to the cluster setting
`server.remote_debugging.mode`. Unless the setting was customized,
clients are only able to connect from the same machine as the node.

### Admin UI changes

- Certain web UI pages (like the list of databases or tables) now restrict their content to match the privileges of the logged-in user. [#42910][#42910]
- The event log now presents all cluster settings changes, unredacted, when an admin user uses the page. [#42910][#42910]
- Customization of the UI by users is now only properly saved if the user has write privilege to `system.ui` (i.e., is an admin user). Also, all authenticated users share the same customizations. This is a known limitation and should be lifted in a future version. [#42910][#42910]
- Access to table statistics are temporarily blocked from access by non-admin users until further notice, for security reasons. [#42910][#42910]
- Certain debug pages have been blocked from non-admin users for security reasons. [#42910][#42910]

### Bug fixes

- Fixed a rare data corruption bug in RocksDB caused by newer Linux kernel's handling of i_generation on certain file systems. [#41394][#41394]
- Fixed a bug causing the `cluster_logical_timestamp()` function to sometimes return incorrect results. [#41442][#41442]
- Fixed a bug causing rapid network disconnections to lead to cluster unavailability because goroutines waited for a connection which would never be initialized to send its first heartbeat. [#42166][#42166]
- Fixed a case where we incorrectly determine that a query (or part of a query) which contains an `IS NULL` constraint on a unique index column returns at most one row, possibly ignoring a `LIMIT 1` clause. [#42793][#42793]
- [`ALTER INDEX IF EXISTS`](../v2.1/alter-index.html) no longer fails when using an unqualified index name that does not match any existing index. Now it is a no-op. [#42841][#42841]
- The `CommandQueue` no longer holds on to buffers if they become too large. This prevents unbounded growth of memory that may never be reclaimed. [#42961][#42961]
- The `CommandQueue` now clears references to objects in its buffers to allow those objects to be reclaimed by the garbage collector. [#42961][#42961]
- Fixed a bug causing disk stalls to allow a node to continue heartbeating its liveness record and prevent other nodes from taking over its leases, despite being completely unresponsive. [#41734][#41734]

### Contributors

This release includes 8 merged PRs by 9 authors.

[#42910]: https://github.com/cockroachdb/cockroach/pull/42910
[#41734]: https://github.com/cockroachdb/cockroach/pull/41734
[#41394]: https://github.com/cockroachdb/cockroach/pull/41394
[#41442]: https://github.com/cockroachdb/cockroach/pull/41442
[#42166]: https://github.com/cockroachdb/cockroach/pull/42166
[#42793]: https://github.com/cockroachdb/cockroach/pull/42793
[#42841]: https://github.com/cockroachdb/cockroach/pull/42841
[#42961]: https://github.com/cockroachdb/cockroach/pull/42961
