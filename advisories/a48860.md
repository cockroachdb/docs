---
title: Technical Advisory 48860
summary: Data corruption/loss issue with snapshots and delete range
toc: true
---

Publication date: May 18, 2020.

## Description

Range deletions (as caused by certain [table drops](../stable/drop-table.html), [table truncates](../stable/truncate.html), and certain rebalancing operations during [node decommissioning](../stable/remove-nodes.html) or failover), when occurring concurrently with replica [garbage collection](../stable/architecture/storage-layer.html#garbage-collection), can yield permanent data corruption or loss in rare cases.

## Statement

A defect in RocksDB allowed it to violate its guarantees for snapshots, causing corruption under specific and extremely rare circumstances. This corruption is irrecoverable using regular node failover and must be addressed by restoring a backup when it occurs.

This bug has been fixed in versions v19.1.9, v19.2.7, and v20.1.0. All users are encouraged to [upgrade](../stable/upgrade-cockroach-version.html).

The public issue is tracked as [#48860](https://github.com/cockroachdb/cockroach/issues/48860).

## Mitigation

There is no mitigation possible without an upgrade. Cockroach Labs recommends that customers upgrade to the maintenance release CockroachDB v19.1.9 or v19.2.7, or upgrade to v20.1.

Because CockroachDB v2.1 will reach [End of Life](../releases/release-support-policy.html) on July 1, 2020, no new maintenance release for v2.1 will be issued containing a fix for this bug. Affected deployments running v2.1 are invited to upgrade to at least v19.1.9.

## Impact

All CockroachDB v2.x and v19.x releases up to and including v19.1.8 and v19.2.6 are affected. When encountered, the bug causes data corruption or loss.

Questions about any technical alert can be directed to our [support team](https://support.cockroachlabs.com/).
