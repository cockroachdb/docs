---
title: What's New in beta-20161013
toc: false
summary: Additions and changes in CockroachDB version beta-20161013.
---

## Oct 13, 2016

### Binaries

<div id="os-tabs" class="clearfix">
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20161006.darwin-10.9-amd64.tgz"><button id="mac" data-eventcategory="mac-binary-release-notes">Mac</button></a>
    <a href="https://binaries.cockroachdb.com/cockroach-beta-20161006.linux-amd64.tgz"><button id="linux" data-eventcategory="linux-binary-release-notes">Linux</button></a>
</div>

### Backwards-Incompatible Changes

- [`TIMESTAMP`](timestamp.html) values are now stored with microsecond precision instead of nanoseconds. All nanosecond-related functions have been removed. An existing table `t` with nanosecond timestamps in column `s` can round them to microseconds with `UPDATE t SET s = s + '0s'`. However, note that this could potentially cause uniqueness problems if the timestamp is a primary key. [#8864](https://github.com/cockroachdb/cockroach/pull/8864)
- [`TIMESTAMP`](timestamp.html) values (without `TIME ZONE`) are now parsed in UTC, not in the session time zone. [#9444](https://github.com/cockroachdb/cockroach/pull/9444)
- The deprecated `--http-addr` flag has been removed. When [starting a node](start-a-node.html), use the `--http-host` flag instead to specify the address to listen on for Admin UI HTTP requests. [#9725](https://github.com/cockroachdb/cockroach/pull/9725)

### SQL Language Changes

- Tables can now be interleaved into other tables. [#7985](https://github.com/cockroachdb/cockroach/pull/7985)
- The [`CREATE TABLE`](create-table.html) statement now supports the `AS` clause to create a table based on the results of a `SELECT` statement. [#8802](https://github.com/cockroachdb/cockroach/pull/8802), [#9278](https://github.com/cockroachdb/cockroach/pull/9278)
- The [`ALTER TABLE ... SPLIT AT`](alter-table.html) command can now be used to force a range split at a specified key. [#8938](https://github.com/cockroachdb/cockroach/pull/8938)
- Added new `information_schema` metatables as well as initial support for the `pg_catalog` database. This work is part of our ongoing effort to provided standard database introspection required by popular ORMs. [#8433](https://github.com/cockroachdb/cockroach/pull/8433), [#8498](https://github.com/cockroachdb/cockroach/pull/8498), [#9565](https://github.com/cockroachdb/cockroach/pull/9565), [#9114](https://github.com/cockroachdb/cockroach/pull/9114), [#9104](https://github.com/cockroachdb/cockroach/pull/9104)
- [`CHECK`](constraints.html#check) constraints can now be added with the [`ALTER TABLE ADD CHECK`](alter-table.html) and `ALTER TABLE VALIDATE` statements. [#9127](https://github.com/cockroachdb/cockroach/pull/9127) [#9152](https://github.com/cockroachdb/cockroach/pull/9152)
- The [`ALTER TABLE DROP CONSTRAINT`](alter-table.html) statement can now drop [`CHECK`](constraints.html#check) and [`FOREIGN KEY`](constraints.html#foreign-key) constraints. [#8747](https://github.com/cockroachdb/cockroach/pull/8747)
- The [`SHOW CONSTRAINTS`](show-constraints.html) statement now requires the user to have privileges for the requested table. [#8658](https://github.com/cockroachdb/cockroach/pull/8658)
- The [`EXPLAIN`](explain.html) statement now works correctly for `VALUES` statements containing subqueries. [#8970](https://github.com/cockroachdb/cockroach/pull/8970)
- The [`TRUNCATE`](truncate.html) statement now implements the `CASCADE` modifier. [#9240](https://github.com/cockroachdb/cockroach/pull/9240)
- [`TIMESTAMP`](timestamp.html) values that include a time zone can now omit the minutes field of the time zone offset, for compatibility with PostgreSQL. [#8666](https://github.com/cockroachdb/cockroach/pull/8666)
- [`INTERVAL`](interval.html) values can now be input in a colon-delimited format (H:M or H:M_S), for compatibility with PostgreSQL. [#8603](https://github.com/cockroachdb/cockroach/pull/8603)
- The `INT8` type is now supported as an alias for [`INTEGER`](int.html). [#8858](https://github.com/cockroachdb/cockroach/pull/8858)
- [`INTERVAL`](interval.html), [`TIMESTAMP`](timestamp.html), [`TIMESTAMPTZ`](timestamp.html), and [`DATE`](date.html) values can now be casted to/from more types. [#9731](https://github.com/cockroachdb/cockroach/pull/9731)
- The window functions `row_number()`, `rank()`, `dense_rank()`, `percent_rank()`, `cume_dist()`, `ntile()`, `lead()`, `lag()`, `first_value()`, `last_value()`, `nth_value()` are now supported. [#8928](https://github.com/cockroachdb/cockroach/pull/8928), [#9321](https://github.com/cockroachdb/cockroach/pull/9321), [#9335](https://github.com/cockroachdb/cockroach/pull/9335)
- The `EXP()` [function](functions-and-operators.html) returns an error if its argument is greater than 1024 instead of performing excessively expensive computation. [#8822](https://github.com/cockroachdb/cockroach/pull/8822)
- The `ROUND()` [function](functions-and-operators.html) now breaks ties by rounding to the nearest even value (also known as bankers' rounding). It is now faster, and returns an error when given an excessively large number of digits. [#8822](https://github.com/cockroachdb/cockroach/pull/8822)
- THE `CONCAT_AGG` [aggregate function](functions-and-operators.html#aggregate-functions) is now supported. [#9690](https://github.com/cockroachdb/cockroach/pull/9690)
- New [date/time functions](functions-and-operators.html#date-and-time-functions), `EXTRACT_DURATION`, `STRPTIME` and `STRFTIME`, are now supported. [#9734](https://github.com/cockroachdb/cockroach/pull/9734), [#9762](https://github.com/cockroachdb/cockroach/pull/9762)

### Protocol Changes

- The `COPY` protocol is now supported on the server side with the `COPY FROM` statement. The [`cockroach sql`](use-the-built-in-sql-client.html) command-line tool does not yet recognize this command but it can be used with other client interfaces. [#8756](https://github.com/cockroachdb/cockroach/pull/8756)
- [`DECIMAL`](decimal.html) values are now encoded correctly for drivers that use the binary format. [#8319](https://github.com/cockroachdb/cockroach/pull/8319)
- [`TIMESTAMP`](timestamp.html), [`TIMESTAMPTZ`](timestamp.html) and [`DATE`](date.html) values can now use the binary protocol format for clients that support it. [#8590](https://github.com/cockroachdb/cockroach/pull/8590), [#8762](https://github.com/cockroachdb/cockroach/pull/8762)
- [`NULL` values](null-handling.html) are now sent with the correct type OID, which is required by some PostgreSQL drivers. [#9331](https://github.com/cockroachdb/cockroach/pull/9331)
- The [`CREATE TABLE`](create-table.html) and [`CREATE DATABASE`](create-database.html) statements now return the standard PostgreSQL error code when the table or database already exists. [#9235](https://github.com/cockroachdb/cockroach/pull/9235)

### Command-line Interface Changes

- The [`cockroach start`](start-a-node.html#standard-output) command now prints additional fields to `stdout`: `clusterID`, `nodeID`, and `status`, which indicates whether the node started a new cluster, joined an existing cluster for the first time, or rejoined an existing cluster. [#9066](https://github.com/cockroachdb/cockroach/pull/9066)
- The [`cockroach start`](start-a-node.html) command now terminates with a non-zero exit status if it was interrupted with **Ctrl+C** or a signal. #9051
- The [`cockroach start`](start-a-node.html) command now supports the `--locality`, which can be used to specify a node's location. This metadata will be used in the future to drive rebalancing decisions. [#8676](https://github.com/cockroachdb/cockroach/pull/8676)
- The [`cockroach zone set`](configure-replication-zones.html) command now supports the `--disable-replication` flag, which sets the desired replication factor to 1. [#9253](https://github.com/cockroachdb/cockroach/pull/9253)
- The `cockroach gen example-data` command can now be used to generate SQL for example databases. [#9231](https://github.com/cockroachdb/cockroach/pull/9231), [#9475](https://github.com/cockroachdb/cockroach/pull/9475)
- The [`cockroach sql`](use-the-built-in-sql-client.html) shell now presents a new prompt when **Ctrl+C** is pressed after the user starts entering a statement. [#9704](https://github.com/cockroachdb/cockroach/pull/9704)
- The [`cockroach sql`](use-the-built-in-sql-client.html) shell now supports retrieving a previous statement from the shell history with **Ctrl+R**. The search is case-insensitive and matches on any consecutive characters in a statement. [#9704](https://github.com/cockroachdb/cockroach/pull/9704)
- The [`cockroach sql`](use-the-built-in-sql-client.html) shell now reports unterminated final statements as errors instead of ignoring them. [#8838](https://github.com/cockroachdb/cockroach/pull/8838)
- The [`cockroach sql`](use-the-built-in-sql-client.html) shell now reports when the connection to the server is lost and a new connection is opened. [#9613](https://github.com/cockroachdb/cockroach/pull/9613)
- The [`cockroach sql`](use-the-built-in-sql-client.html) shell now ignores lines that contain only whitespace (e.g., comments). [#9243](https://github.com/cockroachdb/cockroach/pull/9243)
- The [`cockroach sql`](use-the-built-in-sql-client.html) shell now prints expressions in [`EXPLAIN`](explain.html) and the shell history such as `E::T` or `E:::T` in the same format entered instead of using the longer `CAST` or `TYPE_ANNOTATE` syntax. [#9739](https://github.com/cockroachdb/cockroach/pull/9739)
- The [`cockroach sql`](use-the-built-in-sql-client.html) shell now stops processing statements at the first error encountered when reading from a file (non-interactively). This behavior is customizable with the new `\unset errexit` command. [#9610](https://github.com/cockroachdb/cockroach/pull/9610)
- The [`cockroach sql`](use-the-built-in-sql-client.html) shell now checks if a statement or query is syntactically valid on the client side before it is sent to the server. This ensures that a typo or mistake during user entry does not inconveniently abort an ongoing transaction previously started interactively. This behavior is customizable with the new `\unset check_syntax` command. [#9610](https://github.com/cockroachdb/cockroach/pull/9610)
- The [`cockroach sql`](use-the-built-in-sql-client.html) shell now works better with multi-line statements. In particular, users will find it easier to recall and edit previously entered multi-line statements. This behavior is customizable with a new command `\unset normalize_history`. [#9610](https://github.com/cockroachdb/cockroach/pull/9610)
- The [`cockroach sql`](use-the-built-in-sql-client.html) shell now works correctly under `kubectl` and other environments that hide the size of the terminal. [#9097](https://github.com/cockroachdb/cockroach/pull/9097)

### UI Changes

- The time scale selector in the UI now works more reliably. [#8573](https://github.com/cockroachdb/cockroach/pull/8573)
- Additional database and table-level details are now available. [#9621](https://github.com/cockroachdb/cockroach/pull/9621)
- Displaying graphs for a longer timescales is now much faster. [#8805](https://github.com/cockroachdb/cockroach/pull/8805)
- The default graph time scale is now chosen based on the age of the cluster. [#9340](https://github.com/cockroachdb/cockroach/pull/9340)
- Node logs are now accessible in the UI. [#8572](https://github.com/cockroachdb/cockroach/pull/8572)
- The UI can now be built with live reload support. [#8679](https://github.com/cockroachdb/cockroach/pull/8679)

### Bug Fixes

- Fixed some panics in handling invalid SQL statements. [#9049](https://github.com/cockroachdb/cockroach/pull/9049), [#9050](https://github.com/cockroachdb/cockroach/pull/9050)
- Fixed a bug that sometimes caused transactions to restart twice in a row. [#8596](https://github.com/cockroachdb/cockroach/pull/8596)
- [`STRING`](string.html) literals containing non-UTF-8 data are now rejected. [#9094](https://github.com/cockroachdb/cockroach/pull/9094)
- The [`UPSERT`](upsert.html) statement now works correctly during online schema changes.[#9481](https://github.com/cockroachdb/cockroach/pull/9481)
- Aggregate and window functions in `GROUP BY` ordinal expressions are now rejected without crashing. [#9629](https://github.com/cockroachdb/cockroach/pull/9629)
- The unsupported `ALTER TABLE ... ALTER COLUMN ... SET TYPE ...` statement now reports an error to the client instead of crashing the server. [#8747](https://github.com/cockroachdb/cockroach/pull/8747)
- Slightly improved support for 32-bit systems. Note that 32-bit architectures remain officially unsupported. [#9491](https://github.com/cockroachdb/cockroach/pull/9491)
- The admin UI now propagates timeouts to the server to avoid dangling requests. [#8546](https://github.com/cockroachdb/cockroach/pull/8546)

### Performance Improvements

- Tuned RocksDB settings to reduce write stalls. [#9663](https://github.com/cockroachdb/cockroach/issues/9663)
- Minor performance optimization to avoid reading an internal metadata key that will be immediately overwritten. [#9263](https://github.com/cockroachdb/cockroach/pull/9263)
- Improved concurrency to prevent certain slow operations from dramatically impacting overall performance. [#9622](https://github.com/cockroachdb/cockroach/pull/9622)
- [`DROP INDEX`](drop-index.html) and [`DROP TABLE`](drop-table.html) are now performed in chunks instead of one big transaction. [#8870](https://github.com/cockroachdb/cockroach/pull/8870), [#8885](https://github.com/cockroachdb/cockroach/pull/8885)
- The SQL query processor now tracks its memory usage. Soon it will return errors for queries that use too much memory. [#8691](https://github.com/cockroachdb/cockroach/pull/8691)
- [Aggregate functions](functions-and-operators.html#aggregate-functions) like `SUM()` are now faster. [#8680](https://github.com/cockroachdb/cockroach/pull/8680)
- For [production deployments](recommended-production-settings.html), at least 10000 file descriptors are now recommended per store, with a minimum of 2000 required. [#9679](https://github.com/cockroachdb/cockroach/pull/9679)

### Contributors

This release includes XX merged PRs by XX authors. We would like to
thank the following contributors from the CockroachDB community:
- Daniel Theophanes
- Yan Long
- songhao

### Stay Up-to-Date

Get future release notes emailed to you:
<div class="hubspot-install-form install-form-1 clearfix">
    <script>
        hbspt.forms.create({ 
            css: '',
            cssClass: 'install-form',
            portalId: '1753393',
            formId: '39686297-81d2-45e7-a73f-55a596a8d5ff',
            formInstanceId: 1,
            target: '.install-form-1'
        });
    </script>
</div>
