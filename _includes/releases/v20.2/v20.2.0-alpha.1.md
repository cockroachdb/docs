## v20.2.0-alpha.1

Release Date: June 17, 2020

{{site.data.alerts.callout_danger}}
{% include /v20.2/alerts/warning-a58932.md %}
{{site.data.alerts.end}}

{% include releases/release-downloads-docker-image.md release=include.release %}

<h3 id="v20-2-0-alpha-1-backward-incompatible-changes">Backward-incompatible changes</h3>

- The textual error and warning messages displayed by [`cockroach quit`](../v20.2/cockroach-quit.html) under various circumstances have been updated. Meanwhile, the message "`ok`" remains as an indicator that the operation has likely succeeded. [#45149][#45149]
- [`cockroach quit`](../v20.2/cockroach-quit.html) now prints out progress details on its standard error stream, even when `--logtostderr` is not specified. Previously, nothing was printed on standard error. Scripts that wish to ignore this output can redirect the stderr stream. [#45149][#45149]
- The copy of system and `crdb_internal` tables extracted by [`cockroach debug zip`](../v20.2/cockroach-debug-zip.html) is now written using the TSV format (inside the zip file), instead of an ASCII-art table as previously. [#48096][#48096]
- CockroachDB v20.1 introduced a new rule for the `--join` flag to [`cockroach start`](../v20.2/cockroach-start.html), causing it to prefer SRV records, if present in DNS, to look up the peer nodes to join. This feature is experimental, and has been found to cause disruption in certain deployments. To reduce this disruption and the resulting UX surprise, the feature is now gated behind a new command-line flag `--experimental-dns-srv` which must now be explicitly passed to [`cockroach start`](../v20.2/cockroach-start.html) to enable it. [#49077][#49077]
- Prior to this patch, the phase of server shutdown responsible for range lease transfers to other nodes would give up after 10000 attempts of transferring replica leases away, regardless of the value of `server.shutdown.lease_transfer_wait`. The limit of 10000 attempts has been removed, so that now only the maximum duration `server.shutdown.lease_transfer_wait` applies. [#45149][#45149]

<h3 id="v20-2-0-alpha-1-general-changes">General changes</h3>

- Transactions reading a lot of data behave better when exceeding the memory limit set by `kv.transaction.max_refresh_spans_bytes`. Such transactions now attempt to resolve the conflicts they run into instead of being forced to always retry. Increasing `kv.transaction.max_refresh_spans_bytes` should no longer be necessary for most workloads. [#46275][#46275]
- Schema changes started in 19.2 will now be automatically migrated in the background in 20.1 after upgrade finalization so that they can run to completion. [#46504][#46504]
- Prior to this patch, the phase of server shutdown responsible for range lease transfers to other nodes had a hard timeout of 5 seconds. This patch makes this timeout configurable via the new [cluster setting](../v20.2/cluster-settings.html) `server.shutdown.lease_transfer_wait`. [#45149][#45149]
- [Statement diagnostics zip bundles](../v20.2/ui-statements-page.html) now contain a representation of the statement trace that can be imported into [Jaeger](https://www.jaegertracing.io) for visualization. [#47303][#47303]
- The `system.replication_constraint_stats` report now treats conjunctions of [replication constraints](../v20.2/configure-replication-zones.html) as a single unit of reporting, whereas before there was a report entry for each constraint in the conjunction. For example, given a zone with a replication constraint like `{"+region=us,+az=az1":1}` (meaning, one replica in a node with locality `region=us,az=az1`), now there will be a report entry for `"+region=us,+az=az1"` where before there was a separate entry for `"+region=us"` and another one for `"+az=az1"`. [#47389][#47389]
- The Kubernetes manifests now generate node certificates with additional addresses `'cockroachdb-public.<namespace>'` and `'cockroachdb-public.<namespace>.svc'`. [#47610][#47610]
- Changed the default engine type for new storage directories from RocksDB to Pebble. Existing stores will continue to use the previously specified storage engine, and an explicit specification (via `--storage-engine=...`) will override the default. [#48145][#48145]
- Removed the publication of [musl libc](https://www.musl-libc.org) CockroachDB builds. [#49685][#49685]
- Improved error reporting when trying to access non-existent Google Cloud storage blobs. [#49089][#49089]
- Improved reliability by handling interrupted downloads from Google Cloud external storage more gracefully. [#48229][#48229]
- Treat errors due to draining nodes as retryable when starting CDC. [#49743][#49743]

<h3 id="v20-2-0-alpha-1-enterprise-edition-changes">Enterprise edition changes</h3>

- [`BACKUP`](../v20.2/backup.html) and [`RESTORE`](../v20.2/restore.html) now collect some anonymous telemetry on throughput and feature usage. [#46716][#46716]
- [`SHOW BACKUP`](../v20.2/show-backup.html) now shows whether a [`BACKUP`](../v20.2/backup.html) is a full cluster backup or not. [#45860][#45860]
- The privileges assigned to a given table/database are now visible through [`SHOW BACKUP`](../v20.2/show-backup.html). `SHOW BACKUP` will list which users and roles had which privileges on each table/database in the backup if the `WITH privileges` option is specified. [#45862][#45862]
- The new appended [incremental backup](../v20.2/backup.html#incremental-backups) syntax does not allow converting a full cluster backup to a specific table or database backup. [#46864][#46864]
- [`BACKUP`](../v20.2/backup.html) and [`RESTORE`](../v20.2/restore.html) to HTTP storage locations now require explicitly specifying incremental storage locations (i.e., cannot use the new automatically appended incremental syntax). [#46887][#46887]
- Fixed a bug where the job ID of a lagging changefeed would be omitted and instead it would be reported as sinkless. [#48493][#48493]
- Changefeeds now retry after encountering transient errors contacting the Confluent Schema Registry. [#48759][#48759]

<h3 id="v20-2-0-alpha-1-sql-language-changes">SQL language changes</h3>

<h4 id="v20-2-0-alpha-1-geospatial-sql-updates">Geospatial SQL updates</h4>

- Introduced the ability to parse, store, and display PostGIS style `GEOGRAPHY` and `GEOMETRY` types. [#47171][#47171]
- When doing name resolution via search path, the `pg_extension` schema (containing tables such as `geometry_columns`, `geography_columns` and `spatial_ref_sys`) will now have an attempted resolution before the `public` schema. This mimics PostGIS behavior where the aforementioned tables are in the public schema, and so by default are discoverable tables with a new CLI session. [#49611][#49611]
- Added support for the `AddGeometryColumn` function, which adds a new `GEOMETRY` column to an existing table and returns metadata about the column created. This improves compatibility with PostGIS. [#49456][#49456]
- Added support for `ST_Covers`, `ST_CoveredBy`, `ST_Contains`, `ST_Crosses`, `ST_Equals`, `ST_Intersects`, `ST_Overlaps`, `ST_Touches` and `ST_Within` for `GEOMETRY` geospatial types. [#47584][#47584]
- Added the following geospatial functions: `ST_GeomFromText`, `ST_GeometryFromText`, `ST_GeogFromText`, `ST_GeographyFromText`, `ST_GeomFromWKB`, `ST_GeomFromEWKB`, `ST_GeomFromEWKT`, `ST_GeomFromGeoJSON`, `ST_GeogFromWKB`, `ST_GeogFromEWKB`, `ST_GeogFromEWKT`, `ST_GeogFromGeoJSON`, `ST_AsText`, `ST_AsBinary`, `ST_AsEWKB`, `ST_AsEWKT`, `ST_AsKML`, `ST_AsGeoJSON`. [#48015][#48015]
- Added geospatial functions `ST_Area`, `ST_Length`, `ST_Distance`, and `ST_Perimeter`, which operate on `GEOMETRY` data types. [#48074][#48074]
- Added built-ins allowing parsing text and WKB for all supported shapes, e.g., `ST_PointFromWKB` and `ST_PointFromText`, which return _NULL_ if the WKT/EWKT/WKB do not match the shape provided. [#48441][#48441]
- Implemented the `GEOMETRY` based built-ins `ST_Relate` and `ST_ContainsProperly`. [#48552][#48552]
- Introduced the following functions that work on `GEOGRAPHY` types: `ST_Covers`, `ST_CoveredBy`, `ST_Intersects`, `ST_Distance`, `ST_DWithin`, `ST_Perimeter`, `ST_Area`, and `ST_Length`. [#48529][#48529]
- Implemented the `GEOMETRY` based built-in `ST_SRID`. [#49169][#49169]
- Implemented the `ST_Point` and `ST_MakePoint` functions. [#49194][#49194]
- Implemented the `ST_SetSRID` function on `GEOMETRY` and `GEOGRAPHY` types. [#49222][#49222]
- Implemented the `ST_MaxDistance` and `ST_DFullyWithin` functions for geometries. [#49094][#49094]
- Implemented the `ST_WKBToSQL` and `ST_WKTToSQL` geospatial functions. [#49237][#49237]
- Implemented the `GEOMETRY` based built-in `ST_AsBinary` with encoding. [#49481][#49481]
- Implemented the following geospatial built-ins: `ST_X` (resolves #49069), `ST_Y` (resolves #49070), `ST_NDims` (resolves #48992), `ST_NumPoints` (resolves #49001), `ST_NPoints` (resolves #48995), `ST_StartPoint` (resolves #49047), `ST_EndPoint` (resolves #48924), `ST_NumInteriorRings` (resolves #48999), `ST_NumInteriorRing` (resolves #48998), `ST_InteriorRingN` (resolves #48949), `ST_ExteriorRing` (resolves #48930), `ST_NumGeometries` (resolves #48997), `ST_GeometryN` (resolves #48945). [#49341][#49341]
- Implemented the `ST_Centroid` built-in function which works for `GEOMETRY` and [`STRING`](../v20.2/string.html) arguments. [#49613][#49613]
- Implemented the `GEOMETRY` built-in `ST_AsHexEWKB` with encoding. [#49644][#49644]
- Implemented the following built-ins available on `GEOMETRY` types: `ST_Area2D` (resolves #48869), `ST_NRings` (resolves #48996), `ST_PointN` (resolves #49008), and `ST_GeometryType` (resolves #48946). [#49649][#49649]
- Implemented the `GEOMETRY` based built-in `ST_Summary`. [#49738][#49738]
- Implemented `ST_Buffer` for `GEOMETRY` and [`STRING`](../v20.2/string.html) variants. [#49722][#49722]
- Implemented the following built-in functions: `ST_LineInterpolatePoint`, `ST_LineInterpolatePoints`. [#49742][#49742]
- Implemented `DWithin` for `GEOMETRY` types. [#49085][#49085]
- Populated the `pg_extension.geometry_columns` and `pg_extension.geography_columns` virtual table with metadata for tables which store have columns relevant to `GEOMETRY` or `GEOGRAPHY` data types. [#49424][#49424]

<h4 id="v20-2-0-alpha-1-general-sql-updates">General SQL updates</h4>

- Updated the type checking code to prefer aggregate overloads with string inputs if there are multiple possible candidates due to arguments of unknown type. [#46649][#46649]
- Added syntax for `DECLARE` and `CLOSE`. `CLOSE ALL` is a no-op, as there are no cursors to close. `CLOSE <cursor>` and `DECLARE` raise unimplemented errors. [#45662][#45662]
- Modified the `substring()` function to allow it support bit and byte arrays. [#46710][#46710]
- Added support for `CREATE INDEX CONCURRENTLY` and `DROP INDEX CONCURRENTLY` syntax. These statements are no-ops, as all indexes are created concurrently. [#46695][#46695]
- Previously, we implemented the timezone built-in as `timezone(<time type>, <timezone>)`. However, this is the opposite from the Postgres implementation (which allowed `timezone(<timezone>, <time type>`). In 20.1, we supported both permutations to aid with this migration, but with this change we will only support the timezone first. You can also use `AT TIME ZONE`, which is compatible with the `timezone` function in all versions. [#46748][#46748]
- The [`IMPORT`](../v20.2/backup.html) statement now records some additional anonymous telemetry about its performance and reliability. [#46731][#46731]
- Removed the output showing the number of rows reported as affected by the [`CREATE`/`ALTER`/`DROP ROLE`](../v20.2/authorization.html) statements. The number doesn't make sense to include. Since the rows affected include some rows in system tables such as `system.role_options` rows, this number can be misleading (e.g., `CREATE ROLE` returning `3`). This behavior matches Postgres, where no number is returned for these commands. [#46795][#46795]
- Added a hint to use [`ALTER ROLE`](../v20.2/alter-role.html) when trying to "grant" a role option directly to a user (using the `GRANT ROLE` syntax). [#46795][#46795]
- Added a new unimplemented error that is signalled when attempting to [`ADD CONSTRAINT`](../v20.2/add-constraint.html) with the `EXCLUDE USING` syntax. [#46787][#46787]
- Added support for using `CREATE INDEX .... INCLUDE (col1, col2, ...)`, which is an alias that PostgreSQL uses that is analogous to our `STORING (col1, col2, ...)` syntax. [#46785][#46785]
- Added support for parsing the `REINDEX` syntax, which results in an unimplemented error that explains that `REINDEX`ing is not required in CockroachDB. [#46850][#46850]
- The [vectorized execution](../v20.2/vectorized-execution.html) engine will only run queries with streaming operators. Issue `SET vectorize=on` to enable the vectorized execution engine for buffering operators. [#46845][#46845]
- Added support for compressing output files using gzip. [#46932][#46932]
- If setting an invalid [cluster setting](../v20.2/cluster-settings.html), the invalid values are now returned. [#46932][#46932]
- CockroachDB will now be more verbose about full scans when executing [`EXPLAIN`](../v20.2/explain.html). Previously, we would output `SPANS | ALL`, now it will be `SPANS | FULL SCAN` or (if there is a limit) `SPANS | LIMITED SCAN`. [#46708][#46708]
- The `bit_and()` [aggregate function](../v20.2/functions-and-operators.html#aggregate-functions) now supports [`BIT`](../v20.2/bit.html) and `VARBIT` data types. [#46954][#46954]
- The `bit_or()` [aggregate function](../v20.2/functions-and-operators.html#aggregate-functions) now supports [`BIT`](../v20.2/bit.html) and `VARBIT` data types. [#47023][#47023]
- The error messages for duplicate columns in `NATURAL` and `USING` joins now match the error messages used by Postgres. [#47099][#47099]
- Modified the `strpos()` function to allow it to support [`BIT`](../v20.2/bit.html) and [`BYTES`](../v20.2/bytes.html) arrays. [#46875][#46875]
- Improved theÂ error message for [`ALTER COLUMN ... SET DATA TYPE ...`](../v20.2/alter-column.html) for data type conversions that involve overwriting existing values. [#47155][#47155]
- Modified [`SHOW TABLES`](../v20.2/show-tables.html) to return schema and table type. Furthermore, sequences will now appear in `SHOW TABLES`. Any user who relies on `SHOW TABLES` to return one column can use `SELECT table_name FROM [SHOW TABLES]` to get compatible behavior between previous versions of CockroachDB. [#46756][#46756]
- Made small UX improvements to [hash sharded index](../v20.2/hash-sharded-indexes.html) creation. [#47017][#47017]
- Added `CREATE TABLE LIKE` specifiers. [#47017][#47017]
- Added support for the `CREATE OR REPLACE VIEW` command. [#47051][#47051]
- We previously allowed mixed type 20.1/19.2 upgrades to add precision types. However, the 19.2 nodes would disrespect the precision component and we documented that. To make this cleaner, we instead only allow precision to be specified in time-related types when the version upgrade is complete. [#47425][#47425]
- Histogram collection with `CREATE STATISTICS` is no longer supported on columns with type [`ARRAY`](../v20.2/array.html). Only row count, distinct count, and _NULL_ count are collected for array-type columns. [#47281][#47281]
- A new `default_transaction_priority` [session variable](../v20.2/show-vars.html) is now supported, which configures the priority that SQL transactions use by default. The accepted options for the setting are `LOW`, `NORMAL`, and `HIGH`. [#47641][#47641]
- Removed two public [cluster settings](../v20.2/cluster-settings.html) `sql.distsql.temp_storage.joins` and `sql.distsql.temp_storage.sorts` that can disable usage of temporary on disk storage of intermediate results of query execution. [#47357][#47357]
- Added support for collection of multi-column statistics. By default, statistics are now collected on all prefixes of each index, in addition to 100 other individual columns. This feature can be disabled by setting the [cluster setting](../v20.2/cluster-settings.html) `sql.stats.multi_column_collection.enabled` to false. [#47729][#47729]
- Added square root and cube root unary operators `|/` and `||/`. [#47680][#47680]
- We previously supported any [`TIMESTAMP(TZ)`](../v20.2/timestamp.html) representable in Go. However, this is incompatible with the Postgres protocol format, as well as resulting in sorting errors when using values such as `(-9223372036854775808)::TIMESTAMP`. We have changed our bounds for timestamps to be the same as Postgres - between `4714-11-24 00:00:00+00 BC` and `294276-12-31 23:59:59.999999` inclusive. Users who have previously stored these values will be able to access them, but the `WHERE` clause must use `< '4714-11-24 00:00:00+00 BC'` or `> 294276-12-31 23:59:59.999999`. [#47077][#47077]
- Users now have the ability to control the level of `NOTICE` outputs with the [session variable](../v20.2/show-vars.html) `client_min_messages`. [#46650][#46650]
- [`ROLLBACK TO SAVEPOINT`](../v20.2/rollback-transaction.html) is no longer permitted after miscellaneous internal errors. [#47724][#47724]
- [Common table expressions](../v20.2/common-table-expressions.html) (CTEs) were extended to support the `MATERIALIZED`/`NOT MATERIALIZED` syntax added in PostgreSQL 12. [#47341][#47341]
- The `pg_collation`, `pg_proc`, and `pg_type` tables in `pg_catalog` no longer require privileges on any database in order for the data to be visible. [#47996][#47996]
- Added two new [session variables](../v20.2/show-vars.html) and corresponding [cluster settings](../v20.2/cluster-settings.html) to control whether the optimizer uses histograms and multi-column statistics for cardinality estimation. The [session variables](../v20.2/show-vars.html) are `optimizer_use_histograms` and `optimizer_use_multicol_stats`, with corresponding [cluster settings](../v20.2/cluster-settings.html) `sql.defaults.optimizer_use_histograms.enabled` and `sql.defaults.optimizer_use_multicol_stats.enabled`. Both settings are enabled by default. [#48105][#48105]
- Reduced virtual table memory use. [#48066][#48066]
- Added virtual schema and populated the `pg_catalog.pg_aggregate` table. [#48126][#48126]
- The default [vectorized execution](../v20.2/vectorized-execution.html) mode is now "on", which means that all queries that can use vectorized execution will do so. To revert to previous behavior `SET CLUSTER SETTING sql.defaults.vectorize='201auto'`. [#48059][#48059]
- Added support for the `ALTER TABLE ... ADD COLUMN ... REFERENCES ...` syntax for tables that are empty. [#47082][#47082]
- Caused [primary key changes](../v20.2/alter-primary-key.html) to not create a copy of the old primary key if the primary key change only changes the bucket count of a [hash sharded index](../v20.2/hash-sharded-indexes.html). [#45894][#45894]
- Populated the `pg_proc` table's `provolatile` field based on the internal built-in volatility definition. This value used to always be _NULL_. [#48491][#48491]
- The `RowDescription` message of the pgwire protocol now contains the table OID and column ID for each column in the result set. These values correspond to `pg_attribute.attrelid` and `pg_attribute.attnum`. If a result column does not refer to a simple table or view, these values will be zero, as they were before. [#48417][#48417]
- Added support for indexing and ordering of arrays of indexable and orderable inner types. [#48045][#48045]
- Correctly report type length for the [`CHAR`](../v20.2/string.html) data type. [#48602][#48602]
- Changed the statistics collection logic to only include a row in the _NULL_ count for a column statistic if all columns in the statistic are _NULL_. Previously, the row was included if any of the columns were _NULL_. This change makes it easier to use multi-column statistics for accurate cardinality estimation in the optimizer. [#48528][#48528]
- Fixed an issue with optimizing subqueries involving set operations that could prevent queries from executing. [#48658][#48658]
- The `pg_database` table in `pg_catalog` no longer require privileges on any database in order for the data to be visible. [#48744][#48744]
- Improved the optimizer's ability to inline constant values in filter conditions. [#48629][#48629]
- Improved compatibility of the `pg_typeof` built-in function. [#48614][#48614]
- Introduced the `pg_extension` virtual schema, which contains tables which are on the public schema when using Postgres style extensions. [#48754][#48754]
- Renamed the `experimental_serial_normalization` [session variable](../v20.2/show-vars.html) to `serial_normalization` since the setting is no longer experimental. [#48796][#48796]
- The `RowDescription` message of the pgwire protocol now contains the type modifier for each column in the result set. This corresponds to `pg_attribute.atttypmod`. If it is not available, the value is `-1`, as it was before. [#48762][#48762]
- Added support for the `percentile_disc` and `percentile_cont` ordered-set aggregation functions. [#47668][#47668]
- Added support for Postgres `ENUM` types to be used in queries and stored in tables. [#48556][#48556]
- Added the Postgres supported `ENUM` built-ins `enum_first`, `enum_last`, and `enum_range`. [#49086][#49086]
- The catalog table `pg_type` is now populated with rows for user defined types (like `ENUM`s). [#48693][#48693]
- Populated the catalog table `pg_catalog.pg_enum`. [#49213][#49213]
- 24:00 time now displays correctly in the CLI, returning `0001-01-02 00:00:00`. Furthermore, backups correctly emit and read in 24:00 time properly. [#49330][#49330]
- Vectorized execution engine now supports (although not "natively" - meaning we do not have optimized representations for the newly-supported types) [all data types that CockroachDB supports](../v20.2/data-types.html). [#48422][#48422]
- Vectorized execution engine now supports set operation joins (queries with `INTERSECT ALL` and `EXCEPT ALL`). [#49159][#49159]
- Added the Postgres syntax `GENERATED ALWAYS` alias for computed column construction. [#49525][#49525]
- Correctly populated the `rolcanlogin` value for roles in `pg_roles` and `pg_catalog`. [#49389][#49389]
- Added support for the `max`/`min` aggregation functions on collated strings. [#49530][#49530]
- Added support for referencing static data types under the `pg_catalog` qualification like `pg_catalog.int`. [#49307][#49307]
- Added support for the `max`/`min` aggregation functions on `ENUM` types. [#49558][#49558]
- Added experimental support for the `ALTER COLUMN TYPE` online schema change for changing a column type's data. [#46933][#46933]
- Previously, using _NULL_ (or tuples containing _NULL_s) as the left-hand-side of an `IN` operator would not typecheck unless the _NULL_s were explicitly casted. Now, the casting is not required. [#49723][#49723]
- The optimizer can now fold two grouping operators together when they are aggregating over functions like `sum`. [#49627][#49627]
- The optimizer can now eliminate an unnecessary join that is the input to a `GroupBy` operator. [#49683][#49683]
- Added the `crdb_internal.create_type_statements` virtual table. It holds create statements for user defined types. [#49771][#49771]
- The [vectorized execution](../v20.2/vectorized-execution.html) engine now supports the "Concat" ("||") operator. [#49758][#49758]

<h3 id="v20-2-0-alpha-1-command-line-changes">Command-line changes</h3>

- The [`cockroach demo`](../v20.2/cockroach-demo.html) command now displays a connection URL to the demo cluster, and in a multi-node cluster it displays connection strings for all of the nodes in the cluster. [#46913][#46913]
- It is now possible to pre-configure the secure mode of [`cockroach demo`](../v20.2/cockroach-demo.html) using the environment variable `COCKROACH_INSECURE` like other client commands. [#46922][#46922]
- The client-side commands specific to [`cockroach demo`](../v20.2/cockroach-demo.html), starting with `\demo`, are now advertised in the output of `\?`. Note that this feature is currently experimental. [#46962][#46962]
- The `cockroach` CLI commands that internally use SQL, including [`cockroach sql`](../v20.2/cockroach-sql.html), now can connect to a server using a unix datagram socket. The syntax for this is `--url 'postgres://user@?host=/path/to/directory?port=NNNN'`. [#46968][#46968]
- The [`cockroach demo`](../v20.2/cockroach-demo.html) command now displays a connection URL using a unix datagram socket before the TCP-based URL, as this may deliver better performance in clients running on the same system. [#46979][#46979]
- The SQL URL generated by [`cockroach demo`](../v20.2/cockroach-demo.html), when running in the secure mode, now embeds the password. This way, a command ran by copy-pasting the URL is able to run without asking for a password first. [#46979][#46979]
- The SQL URL generated by [`cockroach demo`](../v20.2/cockroach-demo.html) is simplified to no longer require TLS client certificates in particular directory locations. [#46979][#46979]
- The new client-side command `\demo ls` (experimental) can now (re-)display the connection parameters for every node in the simulated cluster. [#46979][#46979]
- Added a new [`cockroach start`](../v20.2/cockroach-start.html) option `--clock-device` that allows CockroachDB's hybrid logical clock (HLC) to use an IEEE 1588 PTP clock device for the HLC current time. [#46942][#46942]
- The time that [`cockroach quit`](../v20.2/cockroach-quit.html) waits client-side for the node to drain (i.e., remove existing clients and push range leases away) is now configurable via the command-line flag `--drain-wait`. Note that separate server-side timeouts also apply separately, check the `server.shutdown.*` [cluster settings](../v20.2/cluster-settings.html) for details. [#45149][#45149]
- It is now possible to drain a node without shutting down the process, using [`cockroach node drain`](../v20.2/cockroach-node.html). This makes it easier to integrate with service managers and orchestration: it now becomes safe to issue [`cockroach node drain`](../v20.2/cockroach-node.html) and then separately stop the service via a process manager or orchestrator. Previously, there was a risk to misconfigure the service manager to auto-restart the node after it had shut down via `quit`, in a way that was surprising or unwanted. The new command `node drain` also recognizes the new `--drain-wait` flag. [#45149][#45149]
- The commands [`cockroach quit`](../v20.2/cockroach-quit.html) and [`cockroach node drain`](../v20.2/cockroach-node.html) now report a "work remaining" metric on their standard error stream. The value reduces until it reaches 0 to indicate that a graceful shutdown has completed server-side. An operator can now rely on [`cockroach node drain`](../v20.2/cockroach-node.html) to obtain confidence of a graceful shutdown prior to terminating the server process. [#45149][#45149]
- The default value of the parameter `--drain-wait` for [`cockroach quit`](../v20.2/cockroach-quit.html) has been increased from 1 minute to 10 minutes, to give more time for nodes with thousands of ranges to migrate their leases away. [#46396][#46396]
- The error message displayed upon [`cockroach start`](../v20.2/cockroach-start.html) / [`cockroach start-single-node`](../v20.2/cockroach-start-single-node.html) when manual intervention is needed in the store directory is now clearer. [#47756][#47756]
- Client commands such as [`cockroach init`](../v20.2/cockroach-init.html) and [`cockroach quit`](../v20.2/cockroach-quit.html) now support the `--cluster-name` and `--disable-cluster-name-verification` flags in order to support running them on clusters that have been configured to use a cluster name. Previously, it was impossible to run such commands against nodes configured with the `--cluster-name` flag. [#48000][#48000]
- Added support to [`cockroach cert list`](../v20.2/cockroach-cert.html) for certificates which require `--cert-principal-map` to pass validation. [#48013][#48013]
- [`cockroach debug zip`](../v20.2/cockroach-debug-zip.html) now properly skips over fully decommissioned nodes. [#48073][#48073]
- [`cockroach debug zip`](../v20.2/cockroach-debug-zip.html) now tries multiple times to retrieve data using SQL if it encounters retry errors. [#48099][#48099]
- Enabled [`cockroach dump`](../v20.2/cockroach-dump.html) to dump all databases with a single command using the new `--all` flag. [#47387][#47387]
- [`cockroach debug zip`](../v20.2/cockroach-debug-zip.html) now supports two command-line parameters: `--nodes` and `--exclude-nodes`. When specified, they control which nodes are inspected when gathering the data. This makes it possible to focus on a group of nodes of interest in a large cluster, or to exclude nodes that `debug zip` would have trouble reaching otherwise. Both flags accept a list of individual node IDs or ranges of node IDs, e.g., `--nodes=1,10,13-15`. [#48150][#48150]
- Added support for the `--cert-principal-map` flag in the [`cockroach cert`](../v20.2/cockroach-cert.html) command, and various "client" commands such as [`cockroach sql`](../v20.2/cockroach-sql.html), [`cockroach init`](../v20.2/cockroach-init.html), and [`cockroach quit`](../v20.2/cockroach-quit.html). [#47449][#47449]
- CockroachDB's own SQL shell ([`cockroach sql`](../v20.2/cockroach-sql.html) and/or [`cockroach demo`](../v20.2/cockroach-demo.html)) no longer prompts for more lines of input after the user enters `BEGIN` before sending the input to the server. Instead, full lines of input are always sent to the server immediately.  The corresponding client-side option `smart_prompt` thus becomes ineffective and is deprecated. It will be removed in a later version. [#48433][#48433]
- Made the `--storage-engine` flag to [`cockroach start`](../v20.2/cockroach-start.html) sticky (i.e., resolve to the last used engine type when unspecified), even when specified stores are encrypted at rest. [#48721][#48721]
- The `--decommission` flag for [`cockroach quit`](../v20.2/cockroach-quit.html) is now removed. It was previously deprecated in CockroachDB v20.1. Users should be using [`cockroach node decommission`](../v20.2/cockroach-node.html) instead. [#49350][#49350]

<h3 id="v20-2-0-alpha-1-db-console-changes">DB Console changes</h3>

- Dismissing the Release note signup form is now permanent (per user). For insecure mode, it is now dismissed globally. [#46522][#46522]
- Added a vertical scroll bar on the Cluster Overview main panel to allow: scroll down to Node Map section, and scroll down Node list table. [#46741][#46741]
- Changed the default sorting column on the Statements page to Execution Count. [#46780][#46780]
- Tooltips showing statements and jobs are now limited in size for very long statements. [#46557][#46557]
- The default timescale on the metrics page is now always 10m. Previously, it defaulted to the age of the longest running node. [#46190][#46190]
- Added a tracking call to Analytics, sending tracking data for Table sorts. [#45920][#45920]
- Added Analytics tracking for searches on the Statements page. [#45920][#45920]
- Added Analytics tracking for pagination on the Statements page. [#45920][#45920]
- Added a tracking call for diagnostics activation on the Statements page. [#45920][#45920]
- Changed a statement parameter type back to string from AggregateStatics. [#45920][#45920]
- Moved the diagnostics activation tracking call to a more accurate place. [#45920][#45920]
- Fixed a bug where sort columns were only being applied per-page instead of for the entire multi-page list of statements. [#46416][#46416]
- Added analytics tracking for the statement details sub-navigation. [#46789][#46789]
- Changed the download link for statement diagnostics to point to the diagnostics bundle zip file. [#46790][#46790]
- Improved tooltips for existing capacity and storage metrics. [#46801][#46801]
- Removed the Statements tab from the Databases > Table Details page. [#47089][#47089]
- Fixed and cleaned up bar charts code on the Statements page. [#46574][#46574]
- Fixed a bug on the Statements page that would not reset pagination state to page 1 after the app selection was changed. [#46972][#46972]
- Updated layout sizes. [#46627][#46627]
- Updated colors according to new designs. [#45979][#45979]
- Use new `SourceSansPro` font across all of the DB Console. [#45979][#45979]
- Updated font styles for monospaced text (SQL statements, etc.). [#45979][#45979]
- Added links to statement details from the Statement Diagnostics history page. [#46923][#46923]
- Added tooltips with full length statements on the Statement Diagnostics history page. [#46923][#46923]
- Updated the Database loading state design. [#46857][#46857]
- Updated the design of empty state on the Jobs, Diagnostics, Statements, and Statements Details pages. [#45981][#45981]
- Fixed a bug where "Raft log too large" was reported incorrectly for replicas for which the raft log size is not to be trusted. [#48032][#48032]
- Fixed a bug where a multi-node cluster without localities defined wouldn't be able to render the Network Latency page. [#49138][#49138]
- Fixed a bug where the link to specific problem ranges had an incorrect path. Problem ranges are now linked correctly again. [#49122][#49122]
- Fixed a bug where the metrics timepicker was always defaulting to the "Custom" date pane. Access to time window presets has been restored and is always shown first. The "Custom" pane is accessed by selecting "Custom" in the dropdown as before. [#49133][#49133]
- Fixed the incorrect display of the table replica count on the Table Details page. [#49185][#49185]
- Fixed the Jobs page header overlapping with scrollbars. [#49552][#49552]
- Updated the tooltip design on the Statements page. [#46626][#46626]
- Removed Capacity and Logical Bytes per Store graph names from storage tooltips to avoid redundancy. [#47475][#47475]
- The Databases page now shows a default error message about restricted permissions for non-admin users. [#49592][#49592]

<h3 id="v20-2-0-alpha-1-bug-fixes">Bug fixes</h3>

- Index and table GCs happen closer to their GC deadline. [#46715][#46715]
- A rare bug causing an assertion failure was fixed. The assertion error message was "caller violated contract: discovered non-conflicting lock".  The bug could have theoretically allowed isolation violations between transactions without hitting the assertion, though this was never observed in practice. [#46625][#46625]
- Fixed an incorrect query result that could occur when a scalar aggregate was called with a _NULL_ input. [#46649][#46649]
- Benign "Outbox Next" errors from the vectorized runtime are now only logged when log verbosity is set to 1 or greater. [#46724][#46724]
- Statement diagnostics created through [`EXPLAIN ANALYZE (DEBUG)`](../v20.2/explain-analyze.html) now show up in the Statement Diagnostics page of the DB Console. [#46759][#46759]
- [`RESTORE`](../v20.2/restore.html) will now properly clean up partially imported data after having failed or being cancelled. [#46766][#46766]
- Fixed a bug where failed or cancelled IMPORTs may not have cleaned up partially imported data. [#46727][#46727]
- Fixed a rare bug causing errors to be returned for successfully committed transactions. The most common error message was `TransactionStatusError: already committed`. [#46596][#46596]
- Fixed a bug for statement diagnostics that led to tooltips always showing, instead of only on hover. [#46854][#46854]
- The "insecure cluster" indicator is now displayed again for insecure clusters in the DB Console, at the top right of the screen. [#46844][#46844]
- A rare assertion failure that contained the text "existing lock cannot be acquired by different transaction" was fixed. This assertion was only present in earlier v20.1 releases and not in any earlier releases.  This bug created a risk of servers crashing unexpectedly due to improper synchronization of KV requests. [#46830][#46830]
- Fixed incorrect result with `count(*)` when grouping on constant columns. [#46879][#46879]
- Fixed a bug where CockroachDB could hit an internal error when queries with projections only of `INT2` and/or `INT4` columns were executed via the [vectorized engine](../v20.2/vectorized-execution.html). [#46712][#46712]
- [`cockroach demo`](../v20.2/cockroach-demo.html) now properly cleans up its temporary files if the background license acquisition fails. [#46991][#46991]
- Fixed a bug where, when using the [`TIME`](../v20.2/time.html) data type as an index, comparisons using the `!=` operator would return incorrect results if `'24:00:00'` was located in the index. [#46993][#46993]
- Fixed a bug where CockroachDB was using an existing table name 100% of the time when creating a new table, which resulted in no tables being created. [#47056][#47056]
- Fixed a bug where CockroachDB could incorrectly consider a non-_NULL_ value from an interleaved parent table to be _NULL_ when the interleaved child had a _NULL_ value in the row with the corresponding index key. [#47035][#47035]
- Fixed an error that could incorrectly occur when planning queries with `NATURAL` and `USING` joins containing multiple aliases for the same column. [#47099][#47099]
- CockroachDB now returns a proper error for index creation statements using a column which does not exist. [#47090][#47090]
- CDC no longer combines with long running transactions to trigger an assertion with the text "lock timestamp regression".  This bug could crash a server if the right sequence of events occurred. This was typically rare, but was much more common when CDC was in use. [#47101][#47101]
- Fixed a bug where in some cases where system tables have changed, incremental, full-cluster [`BACKUP`](../v20.2/backup.html)s with revision history were sometimes incorrectly disallowed. [#47092][#47092]
- As part of migrating to the new schema change job implementation in 20.1, failed [`IMPORT`](../v20.2/backup.html) and [`RESTORE`](../v20.2/restore.html) jobs which left behind table data in 19.2 that had not been completely garbage collected by the time the cluster was upgraded to 20.1 will now have GC jobs automatically created for them. [#47136][#47136]
- Fixed a data race on AST nodes for [`SELECT` statements](../v20.2/selection-queries.html) that include a `WINDOW` clause. It is unclear whether this could have resulted in incorrect results being returned for these queries. [#47146][#47146]
- Fixed a bug preventing clusters from creating [`TIMETZ`](../v20.2/time.html) columns before they accept an upgrade to 20.1 without downgrading. [#47156][#47156]
- Fixed an infinite loop when adding a self-referencing [foreign key constraint](../v20.2/foreign-key.html) in the same transaction which creates a table. [#47113][#47113]
- Fixed a bug where it was possible to drop a column that was referenced in a computed column expression. [#47085][#47085]
- Fixed a bug where a mechanism to detect stalled disks was erroneously left disabled. It is now enabled: nodes will verify that they can write to their engines before each attempt to announce themselves as live to the cluster. [#46975][#46975]
- Fixed the behavior of `crdb_internal.zones` in mixed-version clusters. [#47173][#47173]
- Fixed reads from `system.namespace` and `crdb_internal.zones` in 19.2 nodes in mixed [cluster settings](../v20.2/cluster-settings.html). [#47173][#47173]
- Fixed a bug where restoring a backup from 2.1 to 20.1 with a [`TIMESTAMP`](../v20.2/timestamp.html) column would result in incomplete type data. This would crash commands such as `SHOW COLUMNS FROM <new_table>`. [#47234][#47234]
- Fixed an incompatibility with 19.2 nodes for tables with computed columns. [#47269][#47269]
- Fixed an internal "no output column equivalent to X" error that could occur in some very rare cases. [#47159][#47159]
- Fixed a bug that could cause CockroachDB processes to crash due to an assertion failure with the text "expected latches held, found none".  The bug became louder (and crashed servers) due to recent changes that added new assertions to the code. [#47247][#47247]
- Fixed an incorrect error that occurred when executing `UNION` statements with hidden and non-hidden columns. [#47094][#47094]
- Fixed a bug where in some cases limits were applied incorrectly when pushed down into scans (resulting in some queries returning more results than they should). [#47287][#47287]
- Fixed a bug in the new schema change GC job implementation causing unnecessary table descriptor lookups whenever any table was updated. [#47313][#47313]
- Fixed a critical bug that would otherwise cause "invalid truncation decision" panics. [#47143][#47143]
- Fixed a bug preventing _NULL_ index members from being added to [hash sharded indexes](../v20.2/hash-sharded-indexes.html). [#47311][#47311]
- Fixed a backwards incompatibility between RocksDB and Pebble that prevented RocksDB from opening a Pebble-created WAL file under certain conditions. [#47350][#47350]
- Fixed a mishandling of truncated WAL records in Pebble which could prevent Pebble from opening a DB after a crash. [#47350][#47350]
- Fixed a short (3s) period of unavailability that could occur on a range after removing a replica. [#41122][#41122]
- Fixed an error that occurred when statistics collection was explicitly requested on a column with type [`ARRAY`](../v20.2/array.html). [#47281][#47281]
- Avoid a condition during rapid version upgrades where a node would refuse to start, claiming "a store is too old for running version". Before this bug fix, the workaround was to decommission the node, delete the store directory, and re-add it to the cluster as a new node. [#47358][#47358]
- [`TRUNCATE`](../v20.2/truncate.html) can now run on [temporary tables](../v20.2/temporary-tables.html), fixing a bug in 20.1.0 where temporary tables could not be truncated, resulting in an error `unexpected value: nil`. [#47482][#47482]
- Fixed a bug where instead of returning a parsing error in queries with `count(*)`, CockroachDB could incorrectly return no output (when the query was executed via the row-by-row engine). [#47036][#47036]
- Fixed a bug that could cause a workload to stall under heavy load. This stall was due to a deadlock that was introduced in an earlier v20.1 release. [#47465][#47465]
- Fixed a bug where columns which were members of [hash sharded indexes](../v20.2/hash-sharded-indexes.html) could not be renamed. Indexes created in prior releases will need to be dropped and recreated to resolve this limitation. [#47431][#47431]
- Fixed a bug that could trigger an assertion with the text "received X results, limit was Y". The underlying bug was only performance related and could not cause user-visible correctness violations. The bug could result in an assertion failure and a node crashing. Even though this was an old bug (present in many releases before v20.1), it became a lot easier to hit in v20.1 because we started performing ranged intent resolution more often due to implicit [`SELECT FOR UPDATE`](../v20.2/select-for-update.html). [#47492][#47492]
- Fixed incorrect results that could occur when casting negative [`INTERVAL`](../v20.2/interval.html)s or [`TIMESTAMP`](../v20.2/timestamp.html)s to type [`DECIMAL`](../v20.2/decimal.html). [#47483][#47483]
- Fixed a bug introduced with the new schema change job implementation that caused errors when rolling back a schema change to be swallowed. [#47446][#47446]
- Fixed a panic that could occur when [`SHOW RANGES`](../v20.2/show-ranges.html) or [`SHOW RANGE FOR ROW`](../v20.2/show-range-for-row.html) was called with a virtual table. [#47500][#47500]
- Setting `kv.closed_timestamp.target_duration` to `0` now disables the closed timestamp as was previously documented. [#47480][#47480]
- Fixed a bug where CockroachDB could not dump tables that have no visible columns. [#46406][#46406]
- Fixed a bug causing some schema change rollbacks to fail permanently even on transient errors. [#47553][#47553]
- Fixed a bug introduced in 20.1 that could cause multiple index GC jobs to be created for the same schema change in rare cases. [#46929][#46929]
- Fixed an issue in RocksDB that could result in missing data in some very specific instances that are very unlikely to be encountered in practice. [#47448][#47448]
- Fixed an incompatibility between Pebble and RocksDB bloom filters that could result in keys disappearing or reappearing when switching storage engines. [#47612][#47612]
- Fixed a bug where concurrent schema change interactions could lead to schema changes being blocked for minutes. [#47462][#47462]
- Fixed a bug where [`PARTITION BY`](../v20.2/partition-by.html) and [`ORDER BY`](../v20.2/order-by.html) columns in window specifications were losing qualifications when used inside views. [#47709][#47709]
- Removed redundant metadata information for subqueries and postqueries in [`EXPLAIN (VERBOSE)`](../v20.2/explain.html) output. [#47951][#47951]
- Return a proper Postgres error code from [`DROP INDEX`](../v20.2/drop-index.html) statements when dropping [`UNIQUE`](../v20.2/unique.html) indices. [#47585][#47585]
- Fix a rare bug where stats were not automatically generated for a new table. [#47718][#47718]
- Fixed a planning error that could happen in rare cases when a histogram was used for a descending indexed column. [#48033][#48033]
- Fixed a bug where CockroachDB could return an internal error when performing a query with `CASE`, `AND`, `OR` operators in some cases when it was executed via the [vectorized engine](../v20.2/vectorized-execution.html). [#47938][#47938]
- [`cockroach debug zip`](../v20.2/cockroach-debug-zip.html) can now successfully avoid out-of-memory errors when extracting very large `system` or `crdb_internal` tables. [#48096][#48096]
- Return a proper `SQLSTATE` error for index creation statements using an existing index name. [#48035][#48035]
- [`cockroach debug zip`](../v20.2/cockroach-debug-zip.html) will now properly report an error if some error is encountered while writing the end of the output zip file. [#48109][#48109]
- Fix [`cockroach debug encryption-status`](../v20.2/cockroach-debug-encryption-active-key.html) and the DB Console display of encryption status when using Pebble. [#48151][#48151]
- Fixed "non-values node passed as fixed value to zigzag join" internal error. [#48128][#48128]
- Return a proper CockroachDB-specific Postgres error code for trying to modify a table without a primary key instead of the generic `XXUUU` error code. [#48125][#48125]
- Fixed a bug where a read operation in a transaction would error out for exceeding the maximum count of results returned. [#48160][#48160]
- Fixed a bug in which `(tuple).*` was only expanded to the first column in the tuple and the remaining elements were dropped. [#48225][#48225]
- CockroachDB will now avoid producing a severe "internal error" upon certain privilege check failures via `pg_catalog` built-in functions. [#48216][#48216]
- Fixed a bug where more than 1 job was created from a [`DROP COLUMN`](../v20.2/drop-column.html) statement, which was confusing clients.  Now, we better distinguish between the delete jobs for columns and dependent jobs for deleting indices, views and sequences. [#48163][#48163]
- Fixed a bug where vectorized queries on composite data types could sometimes return invalid data. [#48052][#48052]
- Fixed a rare bug causing a range to deadlock and all the writes to the respective range to timeout. [#48082][#48082]
- Fixed a bug that could lead to data corruption or data loss if a replica was both the source of a snapshot and was being concurrently removed from the range, and certain specific conditions existed inside RocksDB. This scenario is rare, but possible. [#48320][#48320]
- Made SRV resolution non-fatal for join list records, to align with the standard and improve reliability of node startup. [#47735][#47735]
- Fixed a long-standing bug where HTTP requests would start to fail with error 503 "`transport: authentication handshake failed: io: read/write on closed pipe`" and never become possible again until the node is restarted. This bug existed since v2.1 or some time prior. [#48369][#48369]
- When processing the `--join` flag to [`cockroach start`](../v20.2/cockroach-start.html), invalid SRV records with port number 0 are now properly ignored. [#48325][#48325]
- Fixed a bug where [`SHOW STATISTICS USING JSON`](../v20.2/show-statistics.html) contained incorrect single quotes for strings with spaces inside histograms. [#48514][#48514]
- Return a proper SQLSTATE error when trying to [`ADD`](../v20.2/add-column.html)or [`RENAME`](../v20.2/rename-column.html) a column with an existing name. [#48120][#48120]
- Prevent dropping of databases which contain tables which are currently offline due to [`IMPORT`](../v20.2/backup.html) or [`RESTORE`](../v20.2/restore.html). Previously, dropping a database in this state could lead to a corrupted schema which prevented running backups. [#48596][#48596]
- The two settings `kv.range_split.by_load_enabled` and `kv.range_split.load_qps_threshold` are documented but were incorrectly marked as non-public in the output of `SHOW CLUSTER SETTINGS`. This has been corrected. This bug was introduced in v20.1. [#48582][#48582]
- Fixed a bug preventing timestamps from being closed, which could result in failed follower reads or failure to observe resolved timestamps in changefeeds. [#48561][#48561]
- Fixed a bug which falsely indicated that `kv.closed_timestamp.max_behind_nanos` was almost always growing. [#48521][#48521]
- Previously, when an [`IMPORT`](../v20.2/backup.html) failed, it created a GC job which would behave as a no-op. Now the partially imported data after an [`IMPORT`](../v20.2/backup.html) fails or is cancelled should be deleted. [#48593][#48593]
- Fixed a bug where CockroachDB could encounter an internal error when a query with `LEFT SEMI` or `LEFT ANTI` join was performed via the [vectorized execution](../v20.2/vectorized-execution.html) engine in some cases. This was likely to occur only with the `vectorize=on` setting. [#48659][#48659]
- Fixed a bug where the [`SHOW CREATE`](../v20.2/show-create.html) statement would sometimes show a partitioning step for an index that had been dropped. [#48624][#48624]
- Fixed a bug where [`cockroach dump`](../v20.2/cockroach-dump.html) on tables with interleaved primary keys would erroneously include an extra `CREATE UNIQUE INDEX "primary" ... INTERLEAVE IN PARENT` statement in the dump output. This made it impossible to re-import the dumped data without manual editing. [#48688][#48688]
- Re-allow `diagnostics.forced_sql_stat_reset.interval`, `diagnostics.sql_stat_reset.interval` and `external.graphite.interval` to set to their maximum values (24hr, 24hr and 15min respectively). This previously only excluded these values to be allowed. [#48758][#48758]
- Fixed a bug where changing the primary key of a table that had partitioned indexes could cause indexes to lose their zone configurations. In particular, the indexes that got rebuilt as part of a [primary key change](../v20.2/alter-primary-key.html) would keep their partitions, but lose the zone configurations attached to those partitions. [#48510][#48510]
- Fixed a bug where [`cockroach dump`](../v20.2/cockroach-dump.html) on a table with collated strings would omit the collation clause for the data insertion statements. [#48687][#48687]
- Manually writing a _NULL_ value into the `system.users` table for the "hashedPassword" column will no longer cause a server crash during user authentication. [#48773][#48773]
- Fixed a bug introduced in v20.1.0 where the migration for ongoing schema change jobs would cause the node to panic with an index out of bounds error upon encountering a malformed table descriptor with no schema change mutation corresponding to the job to be migrated. [#48823][#48823]
- Properly support restoring tables that were backed up while they were in the middle of a schema change. [#47588][#47588]
- Fixed a bug where columns of a table could not be dropped after a [primary key change](../v20.2/alter-primary-key.html). [#49081][#49081]
- Fixed an error that could occur when using _NULL_ in some array indirections. [#48830][#48830]
- Fixed incorrect logic for `IS NULL` and `IS NOT NULL` operators with tuples, correctly differentiating them from `IS NOT DISTINCT FROM NULL` and `IS DISTINCT FROM NULL`, respectively. [#48299][#48299]
- Fixed costing of [lookup join](../v20.2/joins.html#lookup-joins) with a limit on top, resulting in better plans (that utilize lookup join) in some cases. [#48862][#48862]
- [`SHOW BACKUP SCHEMAS`](../v20.2/show-backup.html) no longer shows table comments, as they may be inaccurate. [#48167][#48167]
- Fixed a bug where when a database was dropped, it would not drop the entry for its public schema in the `system.namespace` table. [#49125][#49125]
- Fixed a possible deadlock during vectorized query execution. [#49106][#49106]
- Fixed a memory leak which could affect `CHANGEFEED`s performing scans of large tables. [#49101][#49101]
- Improved accuracy of column types returned from queries to improve PostgreSQL compatibility. [#48619][#48619]
- Fixed a bug where use of arrays combined with window functions was causing a query failure. [#49234][#49234]
- Fixed a small race in the [vectorized execution](../v20.2/vectorized-execution.html) engine. [#49202][#49202]
- Fixed a bug where contended [`DROP INDEX`](../v20.2/drop-index.html) queries returned an assertion failure error rather than a retryable error. [#49221][#49221]
- Some benign errors were previously reported as unexpected internal errors by the [vectorized execution](../v20.2/vectorized-execution.html) engine; this is now fixed. [#49260][#49260]
- Prevent namespace orphans (manifesting as `database "" not found` errors) when migrating from 19.2. [#49099][#49099]
- Removed duplicate SQL memory metrics. [#47750][#47750]
- When the value passed to `--drain-wait` is very small, but non-zero, [`cockroach quit`](../v20.2/cockroach-quit.html) in certain cases would not proceed to perform a hard shutdown. This has been corrected. This bug existed since v19.1.9, v19.2.7 and v20.1.1. [#49362][#49362]
- Fixed a bug where in some cases an internal error could occur when queries that have columns of [`BYTES`](../v20.2/bytes.html) type in the output were executed via the [vectorized engine](../v20.2/vectorized-execution.html). [#49223][#49223]
- CockroachDB now correctly reports engine type in bug reports when using [`cockroach demo`](../v20.2/cockroach-demo.html). [#49372][#49372]
- Fixed a bug where `\demo node restart` would not work due to an invalid certificate directory. [#49382][#49382]
- Abandoned intents due to failed transaction coordinators are now cleaned up much faster. This resolves a regression in v20.1.0 compared to prior releases. [#49218][#49218]
- Fixed a bug where if one attempted to perform a full cluster [`RESTORE`](../v20.2/restore.html) on a backup that did not contain any user data, it would fail. [#49591][#49591]
- CockroachDB no longer leaks file descriptors during GSS authentication. [#49572][#49572]
- Fixed a bug where CockroachDB could return an internal error or incorrect results on queries when they were run via the [vectorized execution](../v20.2/vectorized-execution.html) engine and had a hash router in the DistSQL plan. This could only occur with the `vectorize=on` setting. [#49333][#49333]
- Fixed a bug where executing a large number of statements in a transaction without committing could previously crash a CockroachDB server. [#48859][#48859]
- The schema change workload is meant for testing the behavior of schema changes on clusters with nodes with minimum version 19.2. It will deadlock on earlier versions. [#49662][#49662]
- Fixed a panic observed as "unexpected arg type tree.DOidWrapper". [#49601][#49601]
- Fixed a bug where if `ctx.err()` is `nil`, the CLI will panic when a workload returns an error. [#48338][#48338]

<h3 id="v20-2-0-alpha-1-performance-improvements">Performance improvements</h3>

- Some queries which contain a division by a constant have improved execution plans. [#46809][#46809]
- The query planner can now decorrelate correlated exists subqueries with `LIMIT` expressions, leading to better query plans. [#46540][#46540]
- Make virtual tables that access all table descriptors make fewer round trips. [#46872][#46872]
- Reduce time needed to run a [`BACKUP`](../v20.2/backup.html) command when it is built on a lot of previous incremental backups. [#47158][#47158]
- The [query optimizer](../v20.2/cost-based-optimizer.html) now produces faster query plans for some disjunctions (`OR` expressions) by utilizing multiple indexes. [#47094][#47094]
- The [query optimizer](../v20.2/cost-based-optimizer.html) is now more selective in splitting disjunctions into unions, avoiding the overhead of unnecessary memo expansion. [#47161][#47161]
- Improve performance of [`UPDATE`](../v20.2/update.html) on tables with GIN indexed columns. [#47354][#47354]
- Query optimization for disjunctions was extended to support queries which do not select strict keys. [#47342][#47342]
- The [query optimizer](../v20.2/cost-based-optimizer.html) is now smarter when splitting disjunctions into unions by grouping disjunctions based on the columns referenced. [#47361][#47361]
- The [query optimizer](../v20.2/cost-based-optimizer.html) now uses a more efficient plan when splitting disjunctions into multiple sub-queries. [#47454][#47454]
- Query optimization for disjunctions was extended to support scans over GIN indexes. [#47542][#47542]
- Histograms are now used by the optimizer to estimate the cost of index scans with multiple constrained columns or descending columns. This enables better query plan selection in some cases. [#47565][#47565]
- Improved execution plans by removing unnecessary remaining filters in some cases where the filters are reflected by an index constraint. [#47623][#47623]
- The cleanup job which runs after a [primary key change](../v20.2/alter-primary-key.html) to remove old indexes, which blocks other schema changes from running, now starts immediately after the primary key swap is complete. This reduces the amount of waiting time before subsequent schema changes can run. [#47624][#47624]
- The [query optimizer](../v20.2/cost-based-optimizer.html) now uses a more efficient plan when splitting disjunctions into multiple sub-queries. [#47617][#47617]
- The [query optimizer](../v20.2/cost-based-optimizer.html) is now more efficient when generating plans for queries with many OR expressions. [#48025][#48025]
- Filtered scans over virtual tables have improved performance in common cases. [#47316][#47316]
- [`SHOW CREATE`](../v20.2/show-create.html) is much more efficient. [#47316][#47316]
- The [query optimizer](../v20.2/cost-based-optimizer.html) can now split disjunctions in more complex expressions into a union over two index scans. [#48036][#48036]
- Disabled the Go runtime block profile by default, resulting in a small but measurable reduction in CPU usage. The block profile has diminished in utility with the advent of mutex contention profiles and is almost never used during performance investigations. [#48133][#48133]
- The optimizer can now detect when an `EXISTS` subquery can be eliminated because the input has zero rows. This leads to better plans in some cases. [#48162][#48162]
- Before this change, a simple schema change could take 30s+. The reason was that if the schema change is not first in line in the table mutation queue it would return a retryable error and the jobs framework would re-adopt and run it later. The problem is that the job adoption loop timer is 30s. Instead of returning on retryable errors, we retry with an exponential backoff in the schema change code. This pattern of dealing with retryable errors in client job code is encouraged vs. relying on the registry, because the latter leads to slowness and additionally to more complicated test fixtures that rely on hacking with the internals of the job registry. [#48608][#48608]
- Fixed a bug in the histogram filtering logic in the optimizer which was causing inaccurate cardinality estimates for queries with equality predicates on UUIDs and strings, as well as some other types. This bug has existed since histograms were first introduced into the optimizer in the 19.2.0 release. Fixing it improves the optimizer's cardinality estimates and results in better query plans in some cases. [#48580][#48580]
- Histograms used by the optimizer for query planning now have more accurate row counts per histogram bucket, particularly for columns that have many _NULL_ values. This results in better plans in some cases. [#48528][#48528]
- [`DROP TABLE`](../v20.2/drop-table.html) performance is improved due to doing fewer roundtrips for object comment maintenance. [#48265][#48265]
- The optimizer and execution engine can now plan [lookup joins](../v20.2/joins.html#lookup-joins) into virtual indexes, avoiding full scans against virtual tables. [#48226][#48226]
- [Lookup joins](../v20.2/joins.html#lookup-joins) with no required ordering are now more efficient. [#48439][#48439]
- A performance inefficiency has been fixed in the [vectorized execution](../v20.2/vectorized-execution.html) engine which results in speed ups on all queries when run via the vectorized engine, with most noticeable gains on the queries that output many rows. [#48669][#48669]
- The optimizer now normalizes a comparison operator (`=`, `>=`, `<=`, `<`, `>`) with a nested "timezone" function applied to a variable. This results in the generation of constrained index scans in more cases, and therefore, better query plans. [#48724][#48724]
- Reduce memory allocations and improve performance of low-level KV scan operations on Pebble. [#49121][#49121]
- `COUNT` is now converted to `COUNT(*)` (aka `COUNT_ROWS`) in more cases. [#49126][#49126]
- [Lookup join](../v20.2/joins.html#lookup-joins) performance has been improved. [#48058][#48058]
- The optimizer can now determine more accurate costs for query plans with a combination of disjunctions and contradictions. [#49462][#49462]
- Default [replication configurations](../v20.2/configure-replication-zones.html) have been tuned to support higher replication throughput in high-latency replication quorums. [#49619][#49619]
- Fixed a bug in the histogram logic in the optimizer which was causing an over-estimate for the cardinality of constrained index scans in some cases when multiple columns of the index were constrained. This problem was introduced early in the development for the 20.2 release, so should not have ever been part of a release. The fix improves the optimizer's cardinality estimates and may result in better query plan selection. [#49134][#49134]
- Fixed the optimizer's distinct count estimate for columns constrained by an index constraint, which was too low in some cases. The fix improves the optimizer's cardinality estimates, which can lead to better query plan selection. [#49134][#49134]
- Fixed the optimizer's estimated distinct count for a multi-column statistic when all of the columns in the statistic are constrained by a filter predicate. The fix can lead to improved cardinality estimates, leading to better query plan selection in some cases. [#49134][#49134]
- Added support for calculating the selectivity of filter predicates in the optimizer using multi-column statistics. This improves the cardinality estimates of the optimizer when a query has filter predicates constraining multiple columns. As a result, the optimizer may choose a better query plan in some cases. [#49134][#49134]
- Remove compaction-debt based SSTable ingestion backpressure which was artificially slowing down [`IMPORT`](../v20.2/backup.html)s and [`RESTORE`](../v20.2/restore.html)s on Pebble and not providing any utility on RocksDB. Removed the private `rocksdb.ingest_backpressure.pending_compaction_threshold` [cluster setting](../v20.2/cluster-settings.html). [#49726][#49726]

<h3 id="v20-2-0-alpha-1-build-changes">Build changes</h3>

- It's now possible to build CockroachDB with the Clang++ v10 compiler. [#46859][#46859]
- Release Docker images are now built on Debian 9.12. [#49593][#49593]

<div class="release-note-contributors">

<h3 id="v20-2-0-alpha-1-contributors">Contributors</h3>

This release includes 899 merged PRs by 68 authors. We would like to thank the following contributors from the CockroachDB community:

- Amit Sadaphule
- Andrii Vorobiov
- Anthony Huang (first-time contributor)
- Artem Barger
- BurtonQin (first-time contributor)
- Girish Ramnani (first-time contributor)
- Helen He (first-time contributor)
- Jaewan Park
- Jaime Soriano Pastor (first-time contributor)
- Petr JedinÃ½ (first-time contributor)
- Richard Tweed (first-time contributor)
- Yongyang Lai (first-time contributor)
- abhishek20123g
- lancerutkin (first-time contributor)

</div>

[#41122]: https://github.com/cockroachdb/cockroach/pull/41122
[#43744]: https://github.com/cockroachdb/cockroach/pull/43744
[#45149]: https://github.com/cockroachdb/cockroach/pull/45149
[#45638]: https://github.com/cockroachdb/cockroach/pull/45638
[#45644]: https://github.com/cockroachdb/cockroach/pull/45644
[#45662]: https://github.com/cockroachdb/cockroach/pull/45662
[#45665]: https://github.com/cockroachdb/cockroach/pull/45665
[#45802]: https://github.com/cockroachdb/cockroach/pull/45802
[#45860]: https://github.com/cockroachdb/cockroach/pull/45860
[#45862]: https://github.com/cockroachdb/cockroach/pull/45862
[#45894]: https://github.com/cockroachdb/cockroach/pull/45894
[#45920]: https://github.com/cockroachdb/cockroach/pull/45920
[#45978]: https://github.com/cockroachdb/cockroach/pull/45978
[#45979]: https://github.com/cockroachdb/cockroach/pull/45979
[#45981]: https://github.com/cockroachdb/cockroach/pull/45981
[#46190]: https://github.com/cockroachdb/cockroach/pull/46190
[#46275]: https://github.com/cockroachdb/cockroach/pull/46275
[#46396]: https://github.com/cockroachdb/cockroach/pull/46396
[#46406]: https://github.com/cockroachdb/cockroach/pull/46406
[#46416]: https://github.com/cockroachdb/cockroach/pull/46416
[#46504]: https://github.com/cockroachdb/cockroach/pull/46504
[#46522]: https://github.com/cockroachdb/cockroach/pull/46522
[#46540]: https://github.com/cockroachdb/cockroach/pull/46540
[#46557]: https://github.com/cockroachdb/cockroach/pull/46557
[#46574]: https://github.com/cockroachdb/cockroach/pull/46574
[#46596]: https://github.com/cockroachdb/cockroach/pull/46596
[#46625]: https://github.com/cockroachdb/cockroach/pull/46625
[#46626]: https://github.com/cockroachdb/cockroach/pull/46626
[#46627]: https://github.com/cockroachdb/cockroach/pull/46627
[#46649]: https://github.com/cockroachdb/cockroach/pull/46649
[#46650]: https://github.com/cockroachdb/cockroach/pull/46650
[#46695]: https://github.com/cockroachdb/cockroach/pull/46695
[#46708]: https://github.com/cockroachdb/cockroach/pull/46708
[#46710]: https://github.com/cockroachdb/cockroach/pull/46710
[#46712]: https://github.com/cockroachdb/cockroach/pull/46712
[#46715]: https://github.com/cockroachdb/cockroach/pull/46715
[#46716]: https://github.com/cockroachdb/cockroach/pull/46716
[#46724]: https://github.com/cockroachdb/cockroach/pull/46724
[#46727]: https://github.com/cockroachdb/cockroach/pull/46727
[#46731]: https://github.com/cockroachdb/cockroach/pull/46731
[#46741]: https://github.com/cockroachdb/cockroach/pull/46741
[#46748]: https://github.com/cockroachdb/cockroach/pull/46748
[#46756]: https://github.com/cockroachdb/cockroach/pull/46756
[#46759]: https://github.com/cockroachdb/cockroach/pull/46759
[#46766]: https://github.com/cockroachdb/cockroach/pull/46766
[#46780]: https://github.com/cockroachdb/cockroach/pull/46780
[#46785]: https://github.com/cockroachdb/cockroach/pull/46785
[#46787]: https://github.com/cockroachdb/cockroach/pull/46787
[#46789]: https://github.com/cockroachdb/cockroach/pull/46789
[#46790]: https://github.com/cockroachdb/cockroach/pull/46790
[#46795]: https://github.com/cockroachdb/cockroach/pull/46795
[#46798]: https://github.com/cockroachdb/cockroach/pull/46798
[#46801]: https://github.com/cockroachdb/cockroach/pull/46801
[#46809]: https://github.com/cockroachdb/cockroach/pull/46809
[#46830]: https://github.com/cockroachdb/cockroach/pull/46830
[#46844]: https://github.com/cockroachdb/cockroach/pull/46844
[#46845]: https://github.com/cockroachdb/cockroach/pull/46845
[#46850]: https://github.com/cockroachdb/cockroach/pull/46850
[#46854]: https://github.com/cockroachdb/cockroach/pull/46854
[#46857]: https://github.com/cockroachdb/cockroach/pull/46857
[#46859]: https://github.com/cockroachdb/cockroach/pull/46859
[#46864]: https://github.com/cockroachdb/cockroach/pull/46864
[#46872]: https://github.com/cockroachdb/cockroach/pull/46872
[#46875]: https://github.com/cockroachdb/cockroach/pull/46875
[#46879]: https://github.com/cockroachdb/cockroach/pull/46879
[#46887]: https://github.com/cockroachdb/cockroach/pull/46887
[#46911]: https://github.com/cockroachdb/cockroach/pull/46911
[#46913]: https://github.com/cockroachdb/cockroach/pull/46913
[#46922]: https://github.com/cockroachdb/cockroach/pull/46922
[#46923]: https://github.com/cockroachdb/cockroach/pull/46923
[#46929]: https://github.com/cockroachdb/cockroach/pull/46929
[#46932]: https://github.com/cockroachdb/cockroach/pull/46932
[#46933]: https://github.com/cockroachdb/cockroach/pull/46933
[#46936]: https://github.com/cockroachdb/cockroach/pull/46936
[#46942]: https://github.com/cockroachdb/cockroach/pull/46942
[#46952]: https://github.com/cockroachdb/cockroach/pull/46952
[#46954]: https://github.com/cockroachdb/cockroach/pull/46954
[#46962]: https://github.com/cockroachdb/cockroach/pull/46962
[#46968]: https://github.com/cockroachdb/cockroach/pull/46968
[#46972]: https://github.com/cockroachdb/cockroach/pull/46972
[#46975]: https://github.com/cockroachdb/cockroach/pull/46975
[#46979]: https://github.com/cockroachdb/cockroach/pull/46979
[#46991]: https://github.com/cockroachdb/cockroach/pull/46991
[#46993]: https://github.com/cockroachdb/cockroach/pull/46993
[#47017]: https://github.com/cockroachdb/cockroach/pull/47017
[#47023]: https://github.com/cockroachdb/cockroach/pull/47023
[#47035]: https://github.com/cockroachdb/cockroach/pull/47035
[#47036]: https://github.com/cockroachdb/cockroach/pull/47036
[#47051]: https://github.com/cockroachdb/cockroach/pull/47051
[#47056]: https://github.com/cockroachdb/cockroach/pull/47056
[#47077]: https://github.com/cockroachdb/cockroach/pull/47077
[#47082]: https://github.com/cockroachdb/cockroach/pull/47082
[#47085]: https://github.com/cockroachdb/cockroach/pull/47085
[#47089]: https://github.com/cockroachdb/cockroach/pull/47089
[#47090]: https://github.com/cockroachdb/cockroach/pull/47090
[#47092]: https://github.com/cockroachdb/cockroach/pull/47092
[#47093]: https://github.com/cockroachdb/cockroach/pull/47093
[#47094]: https://github.com/cockroachdb/cockroach/pull/47094
[#47099]: https://github.com/cockroachdb/cockroach/pull/47099
[#47101]: https://github.com/cockroachdb/cockroach/pull/47101
[#47113]: https://github.com/cockroachdb/cockroach/pull/47113
[#47136]: https://github.com/cockroachdb/cockroach/pull/47136
[#47143]: https://github.com/cockroachdb/cockroach/pull/47143
[#47145]: https://github.com/cockroachdb/cockroach/pull/47145
[#47146]: https://github.com/cockroachdb/cockroach/pull/47146
[#47155]: https://github.com/cockroachdb/cockroach/pull/47155
[#47156]: https://github.com/cockroachdb/cockroach/pull/47156
[#47158]: https://github.com/cockroachdb/cockroach/pull/47158
[#47159]: https://github.com/cockroachdb/cockroach/pull/47159
[#47161]: https://github.com/cockroachdb/cockroach/pull/47161
[#47171]: https://github.com/cockroachdb/cockroach/pull/47171
[#47173]: https://github.com/cockroachdb/cockroach/pull/47173
[#47200]: https://github.com/cockroachdb/cockroach/pull/47200
[#47234]: https://github.com/cockroachdb/cockroach/pull/47234
[#47247]: https://github.com/cockroachdb/cockroach/pull/47247
[#47269]: https://github.com/cockroachdb/cockroach/pull/47269
[#47281]: https://github.com/cockroachdb/cockroach/pull/47281
[#47284]: https://github.com/cockroachdb/cockroach/pull/47284
[#47287]: https://github.com/cockroachdb/cockroach/pull/47287
[#47303]: https://github.com/cockroachdb/cockroach/pull/47303
[#47311]: https://github.com/cockroachdb/cockroach/pull/47311
[#47313]: https://github.com/cockroachdb/cockroach/pull/47313
[#47316]: https://github.com/cockroachdb/cockroach/pull/47316
[#47341]: https://github.com/cockroachdb/cockroach/pull/47341
[#47342]: https://github.com/cockroachdb/cockroach/pull/47342
[#47350]: https://github.com/cockroachdb/cockroach/pull/47350
[#47354]: https://github.com/cockroachdb/cockroach/pull/47354
[#47357]: https://github.com/cockroachdb/cockroach/pull/47357
[#47358]: https://github.com/cockroachdb/cockroach/pull/47358
[#47361]: https://github.com/cockroachdb/cockroach/pull/47361
[#47387]: https://github.com/cockroachdb/cockroach/pull/47387
[#47389]: https://github.com/cockroachdb/cockroach/pull/47389
[#47425]: https://github.com/cockroachdb/cockroach/pull/47425
[#47431]: https://github.com/cockroachdb/cockroach/pull/47431
[#47446]: https://github.com/cockroachdb/cockroach/pull/47446
[#47448]: https://github.com/cockroachdb/cockroach/pull/47448
[#47449]: https://github.com/cockroachdb/cockroach/pull/47449
[#47454]: https://github.com/cockroachdb/cockroach/pull/47454
[#47462]: https://github.com/cockroachdb/cockroach/pull/47462
[#47465]: https://github.com/cockroachdb/cockroach/pull/47465
[#47475]: https://github.com/cockroachdb/cockroach/pull/47475
[#47480]: https://github.com/cockroachdb/cockroach/pull/47480
[#47482]: https://github.com/cockroachdb/cockroach/pull/47482
[#47483]: https://github.com/cockroachdb/cockroach/pull/47483
[#47492]: https://github.com/cockroachdb/cockroach/pull/47492
[#47496]: https://github.com/cockroachdb/cockroach/pull/47496
[#47500]: https://github.com/cockroachdb/cockroach/pull/47500
[#47542]: https://github.com/cockroachdb/cockroach/pull/47542
[#47553]: https://github.com/cockroachdb/cockroach/pull/47553
[#47565]: https://github.com/cockroachdb/cockroach/pull/47565
[#47584]: https://github.com/cockroachdb/cockroach/pull/47584
[#47585]: https://github.com/cockroachdb/cockroach/pull/47585
[#47588]: https://github.com/cockroachdb/cockroach/pull/47588
[#47610]: https://github.com/cockroachdb/cockroach/pull/47610
[#47612]: https://github.com/cockroachdb/cockroach/pull/47612
[#47616]: https://github.com/cockroachdb/cockroach/pull/47616
[#47617]: https://github.com/cockroachdb/cockroach/pull/47617
[#47623]: https://github.com/cockroachdb/cockroach/pull/47623
[#47624]: https://github.com/cockroachdb/cockroach/pull/47624
[#47625]: https://github.com/cockroachdb/cockroach/pull/47625
[#47629]: https://github.com/cockroachdb/cockroach/pull/47629
[#47635]: https://github.com/cockroachdb/cockroach/pull/47635
[#47641]: https://github.com/cockroachdb/cockroach/pull/47641
[#47668]: https://github.com/cockroachdb/cockroach/pull/47668
[#47680]: https://github.com/cockroachdb/cockroach/pull/47680
[#47685]: https://github.com/cockroachdb/cockroach/pull/47685
[#47709]: https://github.com/cockroachdb/cockroach/pull/47709
[#47718]: https://github.com/cockroachdb/cockroach/pull/47718
[#47724]: https://github.com/cockroachdb/cockroach/pull/47724
[#47727]: https://github.com/cockroachdb/cockroach/pull/47727
[#47729]: https://github.com/cockroachdb/cockroach/pull/47729
[#47735]: https://github.com/cockroachdb/cockroach/pull/47735
[#47750]: https://github.com/cockroachdb/cockroach/pull/47750
[#47756]: https://github.com/cockroachdb/cockroach/pull/47756
[#47766]: https://github.com/cockroachdb/cockroach/pull/47766
[#47783]: https://github.com/cockroachdb/cockroach/pull/47783
[#47936]: https://github.com/cockroachdb/cockroach/pull/47936
[#47937]: https://github.com/cockroachdb/cockroach/pull/47937
[#47938]: https://github.com/cockroachdb/cockroach/pull/47938
[#47951]: https://github.com/cockroachdb/cockroach/pull/47951
[#47996]: https://github.com/cockroachdb/cockroach/pull/47996
[#47999]: https://github.com/cockroachdb/cockroach/pull/47999
[#48000]: https://github.com/cockroachdb/cockroach/pull/48000
[#48013]: https://github.com/cockroachdb/cockroach/pull/48013
[#48015]: https://github.com/cockroachdb/cockroach/pull/48015
[#48025]: https://github.com/cockroachdb/cockroach/pull/48025
[#48032]: https://github.com/cockroachdb/cockroach/pull/48032
[#48033]: https://github.com/cockroachdb/cockroach/pull/48033
[#48035]: https://github.com/cockroachdb/cockroach/pull/48035
[#48036]: https://github.com/cockroachdb/cockroach/pull/48036
[#48045]: https://github.com/cockroachdb/cockroach/pull/48045
[#48052]: https://github.com/cockroachdb/cockroach/pull/48052
[#48058]: https://github.com/cockroachdb/cockroach/pull/48058
[#48059]: https://github.com/cockroachdb/cockroach/pull/48059
[#48066]: https://github.com/cockroachdb/cockroach/pull/48066
[#48073]: https://github.com/cockroachdb/cockroach/pull/48073
[#48074]: https://github.com/cockroachdb/cockroach/pull/48074
[#48077]: https://github.com/cockroachdb/cockroach/pull/48077
[#48082]: https://github.com/cockroachdb/cockroach/pull/48082
[#48096]: https://github.com/cockroachdb/cockroach/pull/48096
[#48099]: https://github.com/cockroachdb/cockroach/pull/48099
[#48105]: https://github.com/cockroachdb/cockroach/pull/48105
[#48109]: https://github.com/cockroachdb/cockroach/pull/48109
[#48120]: https://github.com/cockroachdb/cockroach/pull/48120
[#48125]: https://github.com/cockroachdb/cockroach/pull/48125
[#48126]: https://github.com/cockroachdb/cockroach/pull/48126
[#48128]: https://github.com/cockroachdb/cockroach/pull/48128
[#48133]: https://github.com/cockroachdb/cockroach/pull/48133
[#48138]: https://github.com/cockroachdb/cockroach/pull/48138
[#48145]: https://github.com/cockroachdb/cockroach/pull/48145
[#48150]: https://github.com/cockroachdb/cockroach/pull/48150
[#48151]: https://github.com/cockroachdb/cockroach/pull/48151
[#48160]: https://github.com/cockroachdb/cockroach/pull/48160
[#48162]: https://github.com/cockroachdb/cockroach/pull/48162
[#48163]: https://github.com/cockroachdb/cockroach/pull/48163
[#48167]: https://github.com/cockroachdb/cockroach/pull/48167
[#48190]: https://github.com/cockroachdb/cockroach/pull/48190
[#48216]: https://github.com/cockroachdb/cockroach/pull/48216
[#48225]: https://github.com/cockroachdb/cockroach/pull/48225
[#48226]: https://github.com/cockroachdb/cockroach/pull/48226
[#48229]: https://github.com/cockroachdb/cockroach/pull/48229
[#48236]: https://github.com/cockroachdb/cockroach/pull/48236
[#48245]: https://github.com/cockroachdb/cockroach/pull/48245
[#48265]: https://github.com/cockroachdb/cockroach/pull/48265
[#48295]: https://github.com/cockroachdb/cockroach/pull/48295
[#48299]: https://github.com/cockroachdb/cockroach/pull/48299
[#48320]: https://github.com/cockroachdb/cockroach/pull/48320
[#48325]: https://github.com/cockroachdb/cockroach/pull/48325
[#48338]: https://github.com/cockroachdb/cockroach/pull/48338
[#48354]: https://github.com/cockroachdb/cockroach/pull/48354
[#48364]: https://github.com/cockroachdb/cockroach/pull/48364
[#48369]: https://github.com/cockroachdb/cockroach/pull/48369
[#48376]: https://github.com/cockroachdb/cockroach/pull/48376
[#48417]: https://github.com/cockroachdb/cockroach/pull/48417
[#48422]: https://github.com/cockroachdb/cockroach/pull/48422
[#48433]: https://github.com/cockroachdb/cockroach/pull/48433
[#48439]: https://github.com/cockroachdb/cockroach/pull/48439
[#48440]: https://github.com/cockroachdb/cockroach/pull/48440
[#48441]: https://github.com/cockroachdb/cockroach/pull/48441
[#48449]: https://github.com/cockroachdb/cockroach/pull/48449
[#48450]: https://github.com/cockroachdb/cockroach/pull/48450
[#48451]: https://github.com/cockroachdb/cockroach/pull/48451
[#48452]: https://github.com/cockroachdb/cockroach/pull/48452
[#48471]: https://github.com/cockroachdb/cockroach/pull/48471
[#48491]: https://github.com/cockroachdb/cockroach/pull/48491
[#48493]: https://github.com/cockroachdb/cockroach/pull/48493
[#48504]: https://github.com/cockroachdb/cockroach/pull/48504
[#48510]: https://github.com/cockroachdb/cockroach/pull/48510
[#48514]: https://github.com/cockroachdb/cockroach/pull/48514
[#48521]: https://github.com/cockroachdb/cockroach/pull/48521
[#48528]: https://github.com/cockroachdb/cockroach/pull/48528
[#48529]: https://github.com/cockroachdb/cockroach/pull/48529
[#48552]: https://github.com/cockroachdb/cockroach/pull/48552
[#48556]: https://github.com/cockroachdb/cockroach/pull/48556
[#48561]: https://github.com/cockroachdb/cockroach/pull/48561
[#48580]: https://github.com/cockroachdb/cockroach/pull/48580
[#48582]: https://github.com/cockroachdb/cockroach/pull/48582
[#48593]: https://github.com/cockroachdb/cockroach/pull/48593
[#48596]: https://github.com/cockroachdb/cockroach/pull/48596
[#48602]: https://github.com/cockroachdb/cockroach/pull/48602
[#48608]: https://github.com/cockroachdb/cockroach/pull/48608
[#48614]: https://github.com/cockroachdb/cockroach/pull/48614
[#48619]: https://github.com/cockroachdb/cockroach/pull/48619
[#48624]: https://github.com/cockroachdb/cockroach/pull/48624
[#48629]: https://github.com/cockroachdb/cockroach/pull/48629
[#48658]: https://github.com/cockroachdb/cockroach/pull/48658
[#48659]: https://github.com/cockroachdb/cockroach/pull/48659
[#48666]: https://github.com/cockroachdb/cockroach/pull/48666
[#48667]: https://github.com/cockroachdb/cockroach/pull/48667
[#48669]: https://github.com/cockroachdb/cockroach/pull/48669
[#48687]: https://github.com/cockroachdb/cockroach/pull/48687
[#48688]: https://github.com/cockroachdb/cockroach/pull/48688
[#48693]: https://github.com/cockroachdb/cockroach/pull/48693
[#48721]: https://github.com/cockroachdb/cockroach/pull/48721
[#48724]: https://github.com/cockroachdb/cockroach/pull/48724
[#48744]: https://github.com/cockroachdb/cockroach/pull/48744
[#48754]: https://github.com/cockroachdb/cockroach/pull/48754
[#48758]: https://github.com/cockroachdb/cockroach/pull/48758
[#48759]: https://github.com/cockroachdb/cockroach/pull/48759
[#48762]: https://github.com/cockroachdb/cockroach/pull/48762
[#48773]: https://github.com/cockroachdb/cockroach/pull/48773
[#48778]: https://github.com/cockroachdb/cockroach/pull/48778
[#48796]: https://github.com/cockroachdb/cockroach/pull/48796
[#48823]: https://github.com/cockroachdb/cockroach/pull/48823
[#48830]: https://github.com/cockroachdb/cockroach/pull/48830
[#48859]: https://github.com/cockroachdb/cockroach/pull/48859
[#48862]: https://github.com/cockroachdb/cockroach/pull/48862
[#49077]: https://github.com/cockroachdb/cockroach/pull/49077
[#49081]: https://github.com/cockroachdb/cockroach/pull/49081
[#49082]: https://github.com/cockroachdb/cockroach/pull/49082
[#49085]: https://github.com/cockroachdb/cockroach/pull/49085
[#49086]: https://github.com/cockroachdb/cockroach/pull/49086
[#49089]: https://github.com/cockroachdb/cockroach/pull/49089
[#49094]: https://github.com/cockroachdb/cockroach/pull/49094
[#49099]: https://github.com/cockroachdb/cockroach/pull/49099
[#49101]: https://github.com/cockroachdb/cockroach/pull/49101
[#49106]: https://github.com/cockroachdb/cockroach/pull/49106
[#49121]: https://github.com/cockroachdb/cockroach/pull/49121
[#49122]: https://github.com/cockroachdb/cockroach/pull/49122
[#49125]: https://github.com/cockroachdb/cockroach/pull/49125
[#49126]: https://github.com/cockroachdb/cockroach/pull/49126
[#49133]: https://github.com/cockroachdb/cockroach/pull/49133
[#49134]: https://github.com/cockroachdb/cockroach/pull/49134
[#49138]: https://github.com/cockroachdb/cockroach/pull/49138
[#49159]: https://github.com/cockroachdb/cockroach/pull/49159
[#49169]: https://github.com/cockroachdb/cockroach/pull/49169
[#49185]: https://github.com/cockroachdb/cockroach/pull/49185
[#49194]: https://github.com/cockroachdb/cockroach/pull/49194
[#49199]: https://github.com/cockroachdb/cockroach/pull/49199
[#49202]: https://github.com/cockroachdb/cockroach/pull/49202
[#49211]: https://github.com/cockroachdb/cockroach/pull/49211
[#49213]: https://github.com/cockroachdb/cockroach/pull/49213
[#49218]: https://github.com/cockroachdb/cockroach/pull/49218
[#49221]: https://github.com/cockroachdb/cockroach/pull/49221
[#49222]: https://github.com/cockroachdb/cockroach/pull/49222
[#49223]: https://github.com/cockroachdb/cockroach/pull/49223
[#49224]: https://github.com/cockroachdb/cockroach/pull/49224
[#49227]: https://github.com/cockroachdb/cockroach/pull/49227
[#49234]: https://github.com/cockroachdb/cockroach/pull/49234
[#49237]: https://github.com/cockroachdb/cockroach/pull/49237
[#49260]: https://github.com/cockroachdb/cockroach/pull/49260
[#49307]: https://github.com/cockroachdb/cockroach/pull/49307
[#49330]: https://github.com/cockroachdb/cockroach/pull/49330
[#49333]: https://github.com/cockroachdb/cockroach/pull/49333
[#49341]: https://github.com/cockroachdb/cockroach/pull/49341
[#49350]: https://github.com/cockroachdb/cockroach/pull/49350
[#49362]: https://github.com/cockroachdb/cockroach/pull/49362
[#49372]: https://github.com/cockroachdb/cockroach/pull/49372
[#49382]: https://github.com/cockroachdb/cockroach/pull/49382
[#49389]: https://github.com/cockroachdb/cockroach/pull/49389
[#49398]: https://github.com/cockroachdb/cockroach/pull/49398
[#49422]: https://github.com/cockroachdb/cockroach/pull/49422
[#49424]: https://github.com/cockroachdb/cockroach/pull/49424
[#49456]: https://github.com/cockroachdb/cockroach/pull/49456
[#49457]: https://github.com/cockroachdb/cockroach/pull/49457
[#49462]: https://github.com/cockroachdb/cockroach/pull/49462
[#49474]: https://github.com/cockroachdb/cockroach/pull/49474
[#49481]: https://github.com/cockroachdb/cockroach/pull/49481
[#49525]: https://github.com/cockroachdb/cockroach/pull/49525
[#49530]: https://github.com/cockroachdb/cockroach/pull/49530
[#49552]: https://github.com/cockroachdb/cockroach/pull/49552
[#49558]: https://github.com/cockroachdb/cockroach/pull/49558
[#49572]: https://github.com/cockroachdb/cockroach/pull/49572
[#49591]: https://github.com/cockroachdb/cockroach/pull/49591
[#49592]: https://github.com/cockroachdb/cockroach/pull/49592
[#49593]: https://github.com/cockroachdb/cockroach/pull/49593
[#49601]: https://github.com/cockroachdb/cockroach/pull/49601
[#49611]: https://github.com/cockroachdb/cockroach/pull/49611
[#49613]: https://github.com/cockroachdb/cockroach/pull/49613
[#49619]: https://github.com/cockroachdb/cockroach/pull/49619
[#49627]: https://github.com/cockroachdb/cockroach/pull/49627
[#49644]: https://github.com/cockroachdb/cockroach/pull/49644
[#49649]: https://github.com/cockroachdb/cockroach/pull/49649
[#49662]: https://github.com/cockroachdb/cockroach/pull/49662
[#49667]: https://github.com/cockroachdb/cockroach/pull/49667
[#49683]: https://github.com/cockroachdb/cockroach/pull/49683
[#49685]: https://github.com/cockroachdb/cockroach/pull/49685
[#49699]: https://github.com/cockroachdb/cockroach/pull/49699
[#49722]: https://github.com/cockroachdb/cockroach/pull/49722
[#49723]: https://github.com/cockroachdb/cockroach/pull/49723
[#49726]: https://github.com/cockroachdb/cockroach/pull/49726
[#49738]: https://github.com/cockroachdb/cockroach/pull/49738
[#49742]: https://github.com/cockroachdb/cockroach/pull/49742
[#49743]: https://github.com/cockroachdb/cockroach/pull/49743
[#49758]: https://github.com/cockroachdb/cockroach/pull/49758
[#49771]: https://github.com/cockroachdb/cockroach/pull/49771
[#49793]: https://github.com/cockroachdb/cockroach/pull/49793
[#49800]: https://github.com/cockroachdb/cockroach/pull/49800
[#49807]: https://github.com/cockroachdb/cockroach/pull/49807
